(()=>{var e={12:(e,t,s)=>{"use strict";const r=s(8311);e.exports=(e,t)=>new r(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},71:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkOutputExecServer=async function(e,t,s,{env:r,cwd:i}={}){const n=await e.spawn(t,s,{env:r,cwd:i});let o="",a="";n.stdout.onDidReceiveMessage((e=>{o+=Buffer.from(e).toString("utf-8")})),n.stderr.onDidReceiveMessage((e=>{a+=Buffer.from(e).toString("utf-8")}));const{status:h,message:l}=await n.onExit;if(0!==h)throw new Error(`Command failed with exit code ${h}${l?": "+l:""}: stdout: ${o}, stderr: ${a}`);return{stdout:o,stderr:a}},t.checkOutput=async function(e,t,s){let r="",i="";s.stdout.on("data",(e=>{r+=Buffer.from(e).toString("utf-8")})),s.stderr.on("data",(s=>{const r=Buffer.from(s).toString("utf-8");i+=r;const n=i.split("\n");i=n.pop()||"";for(const s of n)s.trim()&&e.info(`[${t}][stderr]: ${s.trim()}`)})),s.stderr.on("end",(()=>{i.trim()&&e.info(`[${t}][stderr]: ${i.trim()}`),i=""}));const n=await new Promise(((e,t)=>{s.on("error",(e=>{t(e)})),s.on("close",((t,s)=>{e(t??0)}))}));if(i.trim()&&(e.info(`[${t}][stderr]: ${i.trim()}`),i=""),0!==n)throw new Error(`[${t}] Command failed with exit code ${n}: stdout: ${r}`);return{stdout:r}},t.checkCall=async function(e,t,s){let r="",i="";s.stdout.on("data",(s=>{const i=Buffer.from(s).toString("utf-8");r+=i;const n=r.split("\n");r=n.pop()||"";for(const s of n)s.trim()&&e.info(`[${t}][stdout]: ${s.trim()}`)})),s.stdout.on("end",(()=>{r.trim()&&e.info(`[${t}][stdout]: ${r.trim()}`),r=""})),s.stderr.on("data",(s=>{const r=Buffer.from(s).toString("utf-8");i+=r;const n=i.split("\n");i=n.pop()||"";for(const s of n)s.trim()&&e.info(`[${t}][stderr]: ${s.trim()}`)})),s.stderr.on("end",(()=>{i.trim()&&e.info(`[${t}][stderr]: ${i.trim()}`),i=""}));const n=await new Promise(((e,t)=>{s.on("error",(e=>{t(e)})),s.on("close",((t,s)=>{e(t??0)}))}));if(r.trim()&&(e.info(`[${t}][stdout]: ${r.trim()}`),r=""),i.trim()&&(e.info(`[${t}][stderr]: ${i.trim()}`),i=""),0!==n)throw new Error(`[${t}] Command failed with exit code ${n}`)}},144:(e,t,s)=>{"use strict";const r=s(3908);e.exports=(e,t,s=!1)=>{if(e instanceof r)return e;try{return new r(e,t)}catch(e){if(!s)return null;throw e}}},181:e=>{"use strict";e.exports=require("buffer")},270:(e,t,s)=>{"use strict";const r=s(3908),i=s(8311);e.exports=(e,t,s)=>{let n=null,o=null,a=null;try{a=new i(t,s)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(n&&1!==o.compare(e)||(n=e,o=new r(n,s)))})),n}},321:function(e,t,s){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&r(t,e,s);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.possibleElisions=t.simpleRegularExpression=t.ADDRESS_BOUNDARY=t.padGroup=t.groupPossibilities=void 0;const o=n(s(8914)),a=s(7604);function h(e){return(0,a.sprintf)("(%s)",e.join("|"))}function l(e){return e.length<4?(0,a.sprintf)("0{0,%d}%s",4-e.length,e):e}t.groupPossibilities=h,t.padGroup=l,t.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]",t.simpleRegularExpression=function(e){const t=[];e.forEach(((e,s)=>{0===parseInt(e,16)&&t.push(s)}));const s=t.map((t=>e.map(((e,s)=>{if(s===t){const t=0===s||s===o.GROUPS-1?":":"";return h([l(e),t])}return l(e)})).join(":")));return s.push(e.map(l).join(":")),h(s)},t.possibleElisions=function(e,t,s){const r=t?"":":",i=s?"":":",n=[];t||s||n.push("::"),t&&s&&n.push(""),(s&&!t||!s&&t)&&n.push(":"),n.push((0,a.sprintf)("%s(:0{1,4}){1,%d}",r,e-1)),n.push((0,a.sprintf)("(0{1,4}:){1,%d}%s",e-1,i)),n.push((0,a.sprintf)("(0{1,4}:){%d}0{1,4}",e-1));for(let t=1;t<e-1;t++)for(let s=1;s<e-t;s++)n.push((0,a.sprintf)("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",s,e-s-t-1));return h(n)}},560:(e,t,s)=>{"use strict";const r=s(3908);e.exports=(e,t,s)=>new r(e,s).compare(new r(t,s))},680:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.exists=async function(e){try{return await a.promises.access(e),!0}catch{return!1}},t.untildify=function(e){return e.replace(/^~(?=$|\/|\\)/,h)},t.normalizeToSlash=function(e){return e.replace(/\\/g,"/")};const a=o(s(9896)),h=o(s(857)).homedir()},837:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCorrect=t.isInSubnet=void 0,t.isInSubnet=function(e){return!(this.subnetMask<e.subnetMask)&&this.mask(e.subnetMask)===e.mask()},t.isCorrect=function(e){return function(){return this.addressMinusSuffix===this.correctForm()&&(this.subnetMask===e&&!this.parsedSubnet||this.parsedSubnet===String(this.subnetMask))}}},857:e=>{"use strict";e.exports=require("os")},909:(e,t,s)=>{"use strict";const r=s(3908);e.exports=(e,t,s)=>{const i=new r(e,s),n=new r(t,s);return i.compare(n)||i.compareBuild(n)}},1055:(e,t,s)=>{"use strict";const r="object"==typeof process&&process?process:{stdout:null,stderr:null},i=s(4434),n=s(2203),o=s(3193).StringDecoder,a=Symbol("EOF"),h=Symbol("maybeEmitEnd"),l=Symbol("emittedEnd"),c=Symbol("emittingEnd"),u=Symbol("emittedError"),d=Symbol("closed"),f=Symbol("read"),p=Symbol("flush"),m=Symbol("flushChunk"),g=Symbol("encoding"),S=Symbol("decoder"),E=Symbol("flowing"),w=Symbol("paused"),v=Symbol("resume"),_=Symbol("buffer"),y=Symbol("pipes"),R=Symbol("bufferLength"),b=Symbol("bufferPush"),O=Symbol("bufferShift"),I=Symbol("objectMode"),$=Symbol("destroyed"),T=Symbol("error"),C=Symbol("emitData"),k=Symbol("emitEnd"),P=Symbol("emitEnd2"),A=Symbol("async"),L=Symbol("abort"),x=Symbol("aborted"),N=Symbol("signal"),D=e=>Promise.resolve().then(e),M="1"!==global._MP_NO_ITERATOR_SYMBOLS_,B=M&&Symbol.asyncIterator||Symbol("asyncIterator not implemented"),F=M&&Symbol.iterator||Symbol("iterator not implemented");class U{constructor(e,t,s){this.src=e,this.dest=t,this.opts=s,this.ondrain=()=>e[v](),t.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(){}end(){this.unpipe(),this.opts.end&&this.dest.end()}}class j extends U{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,t,s){super(e,t,s),this.proxyErrors=e=>t.emit("error",e),e.on("error",this.proxyErrors)}}class V extends n{constructor(e){super(),this[E]=!1,this[w]=!1,this[y]=[],this[_]=[],this[I]=e&&e.objectMode||!1,this[I]?this[g]=null:this[g]=e&&e.encoding||null,"buffer"===this[g]&&(this[g]=null),this[A]=e&&!!e.async||!1,this[S]=this[g]?new o(this[g]):null,this[a]=!1,this[l]=!1,this[c]=!1,this[d]=!1,this[u]=null,this.writable=!0,this.readable=!0,this[R]=0,this[$]=!1,e&&!0===e.debugExposeBuffer&&Object.defineProperty(this,"buffer",{get:()=>this[_]}),e&&!0===e.debugExposePipes&&Object.defineProperty(this,"pipes",{get:()=>this[y]}),this[N]=e&&e.signal,this[x]=!1,this[N]&&(this[N].addEventListener("abort",(()=>this[L]())),this[N].aborted&&this[L]())}get bufferLength(){return this[R]}get encoding(){return this[g]}set encoding(e){if(this[I])throw new Error("cannot set encoding in objectMode");if(this[g]&&e!==this[g]&&(this[S]&&this[S].lastNeed||this[R]))throw new Error("cannot change encoding");this[g]!==e&&(this[S]=e?new o(e):null,this[_].length&&(this[_]=this[_].map((e=>this[S].write(e))))),this[g]=e}setEncoding(e){this.encoding=e}get objectMode(){return this[I]}set objectMode(e){this[I]=this[I]||!!e}get async(){return this[A]}set async(e){this[A]=this[A]||!!e}[L](){this[x]=!0,this.emit("abort",this[N].reason),this.destroy(this[N].reason)}get aborted(){return this[x]}set aborted(e){}write(e,t,s){if(this[x])return!1;if(this[a])throw new Error("write after end");if(this[$])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;"function"==typeof t&&(s=t,t="utf8"),t||(t="utf8");const r=this[A]?D:e=>e();var i;return this[I]||Buffer.isBuffer(e)||(i=e,!Buffer.isBuffer(i)&&ArrayBuffer.isView(i)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):(e=>e instanceof ArrayBuffer||"object"==typeof e&&e.constructor&&"ArrayBuffer"===e.constructor.name&&e.byteLength>=0)(e)?e=Buffer.from(e):"string"!=typeof e&&(this.objectMode=!0)),this[I]?(this.flowing&&0!==this[R]&&this[p](!0),this.flowing?this.emit("data",e):this[b](e),0!==this[R]&&this.emit("readable"),s&&r(s),this.flowing):e.length?("string"!=typeof e||t===this[g]&&!this[S].lastNeed||(e=Buffer.from(e,t)),Buffer.isBuffer(e)&&this[g]&&(e=this[S].write(e)),this.flowing&&0!==this[R]&&this[p](!0),this.flowing?this.emit("data",e):this[b](e),0!==this[R]&&this.emit("readable"),s&&r(s),this.flowing):(0!==this[R]&&this.emit("readable"),s&&r(s),this.flowing)}read(e){if(this[$])return null;if(0===this[R]||0===e||e>this[R])return this[h](),null;this[I]&&(e=null),this[_].length>1&&!this[I]&&(this.encoding?this[_]=[this[_].join("")]:this[_]=[Buffer.concat(this[_],this[R])]);const t=this[f](e||null,this[_][0]);return this[h](),t}[f](e,t){return e===t.length||null===e?this[O]():(this[_][0]=t.slice(e),t=t.slice(0,e),this[R]-=e),this.emit("data",t),this[_].length||this[a]||this.emit("drain"),t}end(e,t,s){return"function"==typeof e&&(s=e,e=null),"function"==typeof t&&(s=t,t="utf8"),e&&this.write(e,t),s&&this.once("end",s),this[a]=!0,this.writable=!1,!this.flowing&&this[w]||this[h](),this}[v](){this[$]||(this[w]=!1,this[E]=!0,this.emit("resume"),this[_].length?this[p]():this[a]?this[h]():this.emit("drain"))}resume(){return this[v]()}pause(){this[E]=!1,this[w]=!0}get destroyed(){return this[$]}get flowing(){return this[E]}get paused(){return this[w]}[b](e){this[I]?this[R]+=1:this[R]+=e.length,this[_].push(e)}[O](){return this[I]?this[R]-=1:this[R]-=this[_][0].length,this[_].shift()}[p](e){do{}while(this[m](this[O]())&&this[_].length);e||this[_].length||this[a]||this.emit("drain")}[m](e){return this.emit("data",e),this.flowing}pipe(e,t){if(this[$])return;const s=this[l];return t=t||{},e===r.stdout||e===r.stderr?t.end=!1:t.end=!1!==t.end,t.proxyErrors=!!t.proxyErrors,s?t.end&&e.end():(this[y].push(t.proxyErrors?new j(this,e,t):new U(this,e,t)),this[A]?D((()=>this[v]())):this[v]()),e}unpipe(e){const t=this[y].find((t=>t.dest===e));t&&(this[y].splice(this[y].indexOf(t),1),t.unpipe())}addListener(e,t){return this.on(e,t)}on(e,t){const s=super.on(e,t);return"data"!==e||this[y].length||this.flowing?"readable"===e&&0!==this[R]?super.emit("readable"):(e=>"end"===e||"finish"===e||"prefinish"===e)(e)&&this[l]?(super.emit(e),this.removeAllListeners(e)):"error"===e&&this[u]&&(this[A]?D((()=>t.call(this,this[u]))):t.call(this,this[u])):this[v](),s}get emittedEnd(){return this[l]}[h](){this[c]||this[l]||this[$]||0!==this[_].length||!this[a]||(this[c]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[d]&&this.emit("close"),this[c]=!1)}emit(e,t,...s){if("error"!==e&&"close"!==e&&e!==$&&this[$])return;if("data"===e)return!(!this[I]&&!t)&&(this[A]?D((()=>this[C](t))):this[C](t));if("end"===e)return this[k]();if("close"===e){if(this[d]=!0,!this[l]&&!this[$])return;const e=super.emit("close");return this.removeAllListeners("close"),e}if("error"===e){this[u]=t,super.emit(T,t);const e=!(this[N]&&!this.listeners("error").length)&&super.emit("error",t);return this[h](),e}if("resume"===e){const e=super.emit("resume");return this[h](),e}if("finish"===e||"prefinish"===e){const t=super.emit(e);return this.removeAllListeners(e),t}const r=super.emit(e,t,...s);return this[h](),r}[C](e){for(const t of this[y])!1===t.dest.write(e)&&this.pause();const t=super.emit("data",e);return this[h](),t}[k](){this[l]||(this[l]=!0,this.readable=!1,this[A]?D((()=>this[P]())):this[P]())}[P](){if(this[S]){const e=this[S].end();if(e){for(const t of this[y])t.dest.write(e);super.emit("data",e)}}for(const e of this[y])e.end();const e=super.emit("end");return this.removeAllListeners("end"),e}collect(){const e=[];this[I]||(e.dataLength=0);const t=this.promise();return this.on("data",(t=>{e.push(t),this[I]||(e.dataLength+=t.length)})),t.then((()=>e))}concat(){return this[I]?Promise.reject(new Error("cannot concat in objectMode")):this.collect().then((e=>this[I]?Promise.reject(new Error("cannot concat in objectMode")):this[g]?e.join(""):Buffer.concat(e,e.dataLength)))}promise(){return new Promise(((e,t)=>{this.on($,(()=>t(new Error("stream destroyed")))),this.on("error",(e=>t(e))),this.on("end",(()=>e()))}))}[B](){let e=!1;const t=()=>(this.pause(),e=!0,Promise.resolve({done:!0}));return{next:()=>{if(e)return t();const s=this.read();if(null!==s)return Promise.resolve({done:!1,value:s});if(this[a])return t();let r=null,i=null;const n=e=>{this.removeListener("data",o),this.removeListener("end",h),this.removeListener($,l),t(),i(e)},o=e=>{this.removeListener("error",n),this.removeListener("end",h),this.removeListener($,l),this.pause(),r({value:e,done:!!this[a]})},h=()=>{this.removeListener("error",n),this.removeListener("data",o),this.removeListener($,l),t(),r({done:!0})},l=()=>n(new Error("stream destroyed"));return new Promise(((e,t)=>{i=t,r=e,this.once($,l),this.once("error",n),this.once("end",h),this.once("data",o)}))},throw:t,return:t,[B](){return this}}}[F](){let e=!1;const t=()=>(this.pause(),this.removeListener(T,t),this.removeListener($,t),this.removeListener("end",t),e=!0,{done:!0});return this.once("end",t),this.once(T,t),this.once($,t),{next:()=>{if(e)return t();const s=this.read();return null===s?t():{value:s}},throw:t,return:t,[F](){return this}}}destroy(e){return this[$]?(e?this.emit("error",e):this.emit($),this):(this[$]=!0,this[_].length=0,this[R]=0,"function"!=typeof this.close||this[d]||this.close(),e?this.emit("error",e):this.emit($),this)}static isStream(e){return!!e&&(e instanceof V||e instanceof n||e instanceof i&&("function"==typeof e.pipe||"function"==typeof e.write&&"function"==typeof e.end))}}e.exports=V},1118:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unescape=void 0,t.unescape=(e,{windowsPathsNoEscape:t=!1}={})=>t?e.replace(/\[([^\/\\])\]/g,"$1"):e.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1")},1123:e=>{"use strict";const t=/^[0-9]+$/,s=(e,s)=>{const r=t.test(e),i=t.test(s);return r&&i&&(e=+e,s=+s),e===s?0:r&&!i?-1:i&&!r?1:e<s?-1:1};e.exports={compareIdentifiers:s,rcompareIdentifiers:(e,t)=>s(t,e)}},1182:function(e,t,s){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),i=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||r(t,e,s)},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(s(9912));i(s(9912),t),t.default=o.default},1261:(e,t,s)=>{"use strict";const r=s(3908),i=s(8311),n=s(5580);e.exports=(e,t)=>{e=new i(e,t);let s=new r("0.0.0");if(e.test(s))return s;if(s=new r("0.0.0-0"),e.test(s))return s;s=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let o=null;i.forEach((e=>{const t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":o&&!n(t,o)||(o=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!o||s&&!n(s,o)||(s=o)}return s&&e.test(s)?s:null}},1398:e=>{"use strict";e.exports=require("vscode")},1455:e=>{"use strict";e.exports=require("node:fs/promises")},1615:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.onTrafficSnapshot=void 0,t.getHistory=function(){return[...p]},t.addUp=function(e){l>d?(l=e,u.u=0):l+=e},t.addDown=function(e){c>d?(c=e,u.d=0):c+=e},t.startTrafficMonitor=function(e){m(),h=setInterval((()=>{const e=Date.now(),t=Math.max(1,(e-u.t)/1e3),s=l-u.u,r=c-u.d;u={t:e,u:l,d:c};const i={upBps:s/t,downBps:r/t,timestamp:e};p.push(i),p.length>f&&p.shift(),a.fire(i)}),e)},t.stopTrafficMonitor=m;const a=new(o(s(1398)).EventEmitter);t.onTrafficSnapshot=a.event;let h,l=0,c=0,u={t:Date.now(),u:0,d:0};const d=Number.MAX_SAFE_INTEGER-1e12,f=60,p=[];function m(){h&&(clearInterval(h),h=void 0)}},1725:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(181),i={INVALID_ENCODING:"Invalid encoding provided. Please specify a valid encoding the internal Node.js Buffer supports.",INVALID_SMARTBUFFER_SIZE:"Invalid size provided. Size must be a valid integer greater than zero.",INVALID_SMARTBUFFER_BUFFER:"Invalid Buffer provided in SmartBufferOptions.",INVALID_SMARTBUFFER_OBJECT:"Invalid SmartBufferOptions object supplied to SmartBuffer constructor or factory methods.",INVALID_OFFSET:"An invalid offset value was provided.",INVALID_OFFSET_NON_NUMBER:"An invalid offset value was provided. A numeric value is required.",INVALID_LENGTH:"An invalid length value was provided.",INVALID_LENGTH_NON_NUMBER:"An invalid length value was provived. A numeric value is required.",INVALID_TARGET_OFFSET:"Target offset is beyond the bounds of the internal SmartBuffer data.",INVALID_TARGET_LENGTH:"Specified length value moves cursor beyong the bounds of the internal SmartBuffer data.",INVALID_READ_BEYOND_BOUNDS:"Attempted to read beyond the bounds of the managed data.",INVALID_WRITE_BEYOND_BOUNDS:"Attempted to write beyond the bounds of the managed data."};function n(e){return"number"==typeof e&&isFinite(e)&&function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}(e)}function o(e,t){if("number"!=typeof e)throw new Error(t?i.INVALID_OFFSET_NON_NUMBER:i.INVALID_LENGTH_NON_NUMBER);if(!n(e)||e<0)throw new Error(t?i.INVALID_OFFSET:i.INVALID_LENGTH)}t.ERRORS=i,t.checkEncoding=function(e){if(!r.Buffer.isEncoding(e))throw new Error(i.INVALID_ENCODING)},t.isFiniteInteger=n,t.checkLengthValue=function(e){o(e,!1)},t.checkOffsetValue=function(e){o(e,!0)},t.checkTargetOffset=function(e,t){if(e<0||e>t.length)throw new Error(i.INVALID_TARGET_OFFSET)},t.bigIntAndBufferInt64Check=function(e){if("undefined"==typeof BigInt)throw new Error("Platform does not support JS BigInt type.");if(void 0===r.Buffer.prototype[e])throw new Error(`Platform does not support Buffer.prototype.${e}.`)}},1729:(e,t,s)=>{"use strict";const r=s(144);e.exports=(e,t)=>{const s=r(e,t);return s&&s.prerelease.length?s.prerelease:null}},1763:(e,t,s)=>{"use strict";const r=s(560);e.exports=(e,t)=>r(e,t,!0)},1832:(e,t,s)=>{"use strict";const r=s(144);e.exports=(e,t)=>{const s=r(e,null,!0),i=r(t,null,!0),n=s.compare(i);if(0===n)return null;const o=n>0,a=o?s:i,h=o?i:s,l=!!a.prerelease.length;if(h.prerelease.length&&!l){if(!h.patch&&!h.minor)return"major";if(0===h.compareMain(a))return h.minor&&!h.patch?"minor":"patch"}const c=l?"pre":"";return s.major!==i.major?c+"major":s.minor!==i.minor?c+"minor":s.patch!==i.patch?c+"patch":"prerelease"}},2032:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AST=void 0;const r=s(2585),i=s(1118),n=new Set(["!","?","+","*","@"]),o=e=>n.has(e),a="(?!\\.)",h=new Set(["[","."]),l=new Set(["..","."]),c=new Set("().*{}+?[]^$\\!"),u="[^/]",d=u+"*?",f=u+"+?";class p{type;#e;#t;#s=!1;#r=[];#i;#n;#o;#a=!1;#h;#l;#c=!1;constructor(e,t,s={}){this.type=e,e&&(this.#t=!0),this.#i=t,this.#e=this.#i?this.#i.#e:this,this.#h=this.#e===this?s:this.#e.#h,this.#o=this.#e===this?[]:this.#e.#o,"!"!==e||this.#e.#a||this.#o.push(this),this.#n=this.#i?this.#i.#r.length:0}get hasMagic(){if(void 0!==this.#t)return this.#t;for(const e of this.#r)if("string"!=typeof e&&(e.type||e.hasMagic))return this.#t=!0;return this.#t}toString(){return void 0!==this.#l?this.#l:this.type?this.#l=this.type+"("+this.#r.map((e=>String(e))).join("|")+")":this.#l=this.#r.map((e=>String(e))).join("")}#u(){if(this!==this.#e)throw new Error("should only call on root");if(this.#a)return this;let e;for(this.toString(),this.#a=!0;e=this.#o.pop();){if("!"!==e.type)continue;let t=e,s=t.#i;for(;s;){for(let r=t.#n+1;!s.type&&r<s.#r.length;r++)for(const t of e.#r){if("string"==typeof t)throw new Error("string part in extglob AST??");t.copyIn(s.#r[r])}t=s,s=t.#i}}return this}push(...e){for(const t of e)if(""!==t){if("string"!=typeof t&&!(t instanceof p&&t.#i===this))throw new Error("invalid part: "+t);this.#r.push(t)}}toJSON(){const e=null===this.type?this.#r.slice().map((e=>"string"==typeof e?e:e.toJSON())):[this.type,...this.#r.map((e=>e.toJSON()))];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#e||this.#e.#a&&"!"===this.#i?.type)&&e.push({}),e}isStart(){if(this.#e===this)return!0;if(!this.#i?.isStart())return!1;if(0===this.#n)return!0;const e=this.#i;for(let t=0;t<this.#n;t++){const s=e.#r[t];if(!(s instanceof p&&"!"===s.type))return!1}return!0}isEnd(){if(this.#e===this)return!0;if("!"===this.#i?.type)return!0;if(!this.#i?.isEnd())return!1;if(!this.type)return this.#i?.isEnd();const e=this.#i?this.#i.#r.length:0;return this.#n===e-1}copyIn(e){"string"==typeof e?this.push(e):this.push(e.clone(this))}clone(e){const t=new p(this.type,e);for(const e of this.#r)t.copyIn(e);return t}static#d(e,t,s,r){let i=!1,n=!1,a=-1,h=!1;if(null===t.type){let l=s,c="";for(;l<e.length;){const s=e.charAt(l++);if(i||"\\"===s)i=!i,c+=s;else if(n)l===a+1?"^"!==s&&"!"!==s||(h=!0):"]"!==s||l===a+2&&h||(n=!1),c+=s;else if("["!==s)if(r.noext||!o(s)||"("!==e.charAt(l))c+=s;else{t.push(c),c="";const i=new p(s,t);l=p.#d(e,i,l,r),t.push(i)}else n=!0,a=l,h=!1,c+=s}return t.push(c),l}let l=s+1,c=new p(null,t);const u=[];let d="";for(;l<e.length;){const s=e.charAt(l++);if(i||"\\"===s)i=!i,d+=s;else if(n)l===a+1?"^"!==s&&"!"!==s||(h=!0):"]"!==s||l===a+2&&h||(n=!1),d+=s;else if("["!==s)if(o(s)&&"("===e.charAt(l)){c.push(d),d="";const t=new p(s,c);c.push(t),l=p.#d(e,t,l,r)}else if("|"!==s){if(")"===s)return""===d&&0===t.#r.length&&(t.#c=!0),c.push(d),d="",t.push(...u,c),l;d+=s}else c.push(d),d="",u.push(c),c=new p(null,t);else n=!0,a=l,h=!1,d+=s}return t.type=null,t.#t=void 0,t.#r=[e.substring(s-1)],l}static fromGlob(e,t={}){const s=new p(null,void 0,t);return p.#d(e,s,0,t),s}toMMPattern(){if(this!==this.#e)return this.#e.toMMPattern();const e=this.toString(),[t,s,r,i]=this.toRegExpSource();if(!(r||this.#t||this.#h.nocase&&!this.#h.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return s;const n=(this.#h.nocase?"i":"")+(i?"u":"");return Object.assign(new RegExp(`^${t}$`,n),{_src:t,_glob:e})}toRegExpSource(){if(this.#e===this&&this.#u(),!this.type){const e=this.isStart()&&this.isEnd(),t=this.#r.map((t=>{const[s,r,i,n]="string"==typeof t?p.#f(t,this.#t,e):t.toRegExpSource();return this.#t=this.#t||i,this.#s=this.#s||n,s})).join("");let s="";if(this.isStart()&&"string"==typeof this.#r[0]&&(1!==this.#r.length||!l.has(this.#r[0]))){const e=h,r=this.#h.dot&&e.has(t.charAt(0))||t.startsWith("\\.")&&e.has(t.charAt(2))||t.startsWith("\\.\\.")&&e.has(t.charAt(4)),i=!this.#h.dot&&e.has(t.charAt(0));s=r?"(?!\\.\\.?(?:$|/))":i?a:""}let r="";return this.isEnd()&&this.#e.#a&&"!"===this.#i?.type&&(r="(?:$|\\/)"),[s+t+r,(0,i.unescape)(t),this.#t=!!this.#t,this.#s]}const e="!"===this.type?"(?:(?!(?:":"(?:",t=this.#r.map((e=>{if("string"==typeof e)throw new Error("string type in extglob ast??");const[t,s,r,i]=e.toRegExpSource();return this.#s=this.#s||i,t})).filter((e=>!(this.isStart()&&this.isEnd()&&!e))).join("|");if(this.isStart()&&this.isEnd()&&!t&&"!"!==this.type){const e=this.toString();return this.#r=[e],this.type=null,this.#t=void 0,[e,(0,i.unescape)(this.toString()),!1,!1]}let s="";return s="!"===this.type&&this.#c?(this.isStart()&&!this.#h.dot?a:"")+f:e+t+("!"===this.type?"))"+(this.isStart()&&!this.#h.dot?a:"")+d+")":"@"===this.type?")":`)${this.type}`),[s,(0,i.unescape)(t),this.#t=!!this.#t,this.#s]}static#f(e,t,s=!1){let n=!1,o="",a=!1;for(let i=0;i<e.length;i++){const h=e.charAt(i);if(n)n=!1,o+=(c.has(h)?"\\":"")+h;else if("\\"!==h){if("["===h){const[s,n,h,l]=(0,r.parseClass)(e,i);if(h){o+=s,a=a||n,i+=h-1,t=t||l;continue}}"*"!==h?"?"!==h?o+=h.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):(o+=u,t=!0):(o+=s&&"*"===e?f:d,t=!0)}else i===e.length-1?o+="\\\\":n=!0}return[o,(0,i.unescape)(e),!!t,a]}}t.AST=p},2092:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Glob=void 0;const r=s(5551),i=s(8576),n=s(7016),o=s(4758),a=s(9080),h="object"==typeof process&&process&&"string"==typeof process.platform?process.platform:"linux";class l{absolute;cwd;root;dot;dotRelative;follow;ignore;magicalBraces;mark;matchBase;maxDepth;nobrace;nocase;nodir;noext;noglobstar;pattern;platform;realpath;scurry;stat;signal;windowsPathsNoEscape;withFileTypes;opts;patterns;constructor(e,t){if(this.withFileTypes=!!t.withFileTypes,this.signal=t.signal,this.follow=!!t.follow,this.dot=!!t.dot,this.dotRelative=!!t.dotRelative,this.nodir=!!t.nodir,this.mark=!!t.mark,t.cwd?(t.cwd instanceof URL||t.cwd.startsWith("file://"))&&(t.cwd=(0,n.fileURLToPath)(t.cwd)):this.cwd="",this.cwd=t.cwd||"",this.root=t.root,this.magicalBraces=!!t.magicalBraces,this.nobrace=!!t.nobrace,this.noext=!!t.noext,this.realpath=!!t.realpath,this.absolute=t.absolute,this.noglobstar=!!t.noglobstar,this.matchBase=!!t.matchBase,this.maxDepth="number"==typeof t.maxDepth?t.maxDepth:1/0,this.stat=!!t.stat,this.ignore=t.ignore,this.withFileTypes&&void 0!==this.absolute)throw new Error("cannot set absolute and withFileTypes:true");if("string"==typeof e&&(e=[e]),this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||!1===t.allowWindowsEscape,this.windowsPathsNoEscape&&(e=e.map((e=>e.replace(/\\/g,"/")))),this.matchBase){if(t.noglobstar)throw new TypeError("base matching requires globstar");e=e.map((e=>e.includes("/")?e:`./**/${e}`))}if(this.pattern=e,this.platform=t.platform||h,this.opts={...t,platform:this.platform},t.scurry){if(this.scurry=t.scurry,void 0!==t.nocase&&t.nocase!==t.scurry.nocase)throw new Error("nocase option contradicts provided scurry option")}else{const e="win32"===t.platform?i.PathScurryWin32:"darwin"===t.platform?i.PathScurryDarwin:t.platform?i.PathScurryPosix:i.PathScurry;this.scurry=new e(this.cwd,{nocase:t.nocase,fs:t.fs})}this.nocase=this.scurry.nocase;const s={...t,dot:this.dot,matchBase:this.matchBase,nobrace:this.nobrace,nocase:this.nocase,nocaseMagicOnly:!0,nocomment:!0,noext:this.noext,nonegate:!0,optimizationLevel:2,platform:this.platform,windowsPathsNoEscape:this.windowsPathsNoEscape,debug:!!this.opts.debug},a=this.pattern.map((e=>new r.Minimatch(e,s))),[l,c]=a.reduce(((e,t)=>(e[0].push(...t.set),e[1].push(...t.globParts),e)),[[],[]]);this.patterns=l.map(((e,t)=>new o.Pattern(e,c[t],0,this.platform)))}async walk(){return[...await new a.GlobWalker(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase}).walk()]}walkSync(){return[...new a.GlobWalker(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase}).walkSync()]}stream(){return new a.GlobStream(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase}).stream()}streamSync(){return new a.GlobStream(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase}).streamSync()}iterateSync(){return this.streamSync()[Symbol.iterator]()}[Symbol.iterator](){return this.iterateSync()}iterate(){return this.stream()[Symbol.asyncIterator]()}[Symbol.asyncIterator](){return this.iterate()}}t.Glob=l},2111:(e,t,s)=>{"use strict";const r=s(4641),i=s(3999),n=s(5580),o=s(4089),a=s(7059),h=s(5200);e.exports=(e,t,s,l)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof s&&(s=s.version),e===s;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof s&&(s=s.version),e!==s;case"":case"=":case"==":return r(e,s,l);case"!=":return i(e,s,l);case">":return n(e,s,l);case">=":return o(e,s,l);case"<":return a(e,s,l);case"<=":return h(e,s,l);default:throw new TypeError(`Invalid operator: ${t}`)}}},2203:e=>{"use strict";e.exports=require("stream")},2357:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t}),a=this&&this.__addDisposableResource||function(e,t,s){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,i;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],s&&(i=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:s})}else s&&e.stack.push({async:!0});return t},h=this&&this.__disposeResources||function(e){return function(t){function s(s){t.error=t.hasError?new e(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var r,i=0;return function e(){for(;r=t.stack.pop();)try{if(!r.async&&1===i)return i=0,t.stack.push(r),Promise.resolve().then(e);if(r.dispose){var n=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(n).then(e,(function(t){return s(t),e()}))}else i|=1}catch(e){s(e)}if(1===i)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,s){var r=new Error(s);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});Object.defineProperty(t,"__esModule",{value:!0}),t.span=u,t.runInSpan=async function(e,t){const s={stack:[],error:void 0,hasError:!1};try{const r=a(s,u(e),!1);try{const e=t(r);return e instanceof Promise&&await e,r.setAttribute("success",!0),e}catch(e){throw r.setError(e instanceof Error?e.message:String(e)),r.setAttribute("success",!1),e}}catch(e){s.error=e,s.hasError=!0}finally{h(s)}},t.captureException=function(e){try{l.tracing.captureException(e)}catch(e){}},t.addBreadcrumb=function(e){try{l.tracing.addBreadcrumb(e)}catch(e){}};const l=o(s(1398)),c={end:()=>{},setAttribute:()=>{},setError:()=>{},spanContext:()=>{},[Symbol.dispose]:()=>{}};function u(e){try{return l.tracing.span(e)}catch(e){return c}}},2407:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.createTunnel=async function(e,t,s){const r=t.localAddressPort??t.remoteAddress.port??0,i=(r,i)=>{r.pause();const n=c.randomUUID(),o=s();if(void 0===o)return e.error("[tunnel-forwarding] socksAddress is undefined"),void r.destroy();const h={proxy:{host:o.address,port:o.port,type:5},command:"connect",destination:{host:t.remoteAddress.host,port:t.remoteAddress.port}};a.SocksClient.createConnection(h).then((s=>{s.socket.on("error",(s=>{e.error(`[tunnel-forwarding][${i} -> ${o.address}:${o.port} -> ${t.remoteAddress.host}:${t.remoteAddress.port}][${n}] socks connection threw an error`,s),r.destroy()})),r.on("error",(r=>{e.error(`[tunnel-forwarding][${i} -> ${o.address}:${o.port} -> ${t.remoteAddress.host}:${t.remoteAddress.port}][${n}] local connection threw an error`,r),s.socket.destroy()})),s.socket.on("close",(()=>{e.info(`[tunnel-forwarding][${i} -> ${o.address}:${o.port} -> ${t.remoteAddress.host}:${t.remoteAddress.port}][${n}] socks connection closed`)})),r.on("close",(()=>{e.info(`[tunnel-forwarding][${i} -> ${o.address}:${o.port} -> ${t.remoteAddress.host}:${t.remoteAddress.port}][${n}] local connection closed`)})),e.info(`[tunnel-forwarding][${i} -> ${o.address}:${o.port} -> ${t.remoteAddress.host}:${t.remoteAddress.port}][${n}] resuming socket`),r.on("data",(e=>{(0,u.addUp)(e.length)})),s.socket.on("data",(e=>{(0,u.addDown)(e.length)})),r.resume(),r.pipe(s.socket),s.socket.pipe(r),e.info(`[tunnel-forwarding][${i} -> ${o.address}:${o.port} -> ${t.remoteAddress.host}:${t.remoteAddress.port}][${n}] socks forwarding established`)})).catch((s=>{e.error(`[tunnel-forwarding][${i} -> ${o.address}:${o.port} -> ${t.remoteAddress.host}:${t.remoteAddress.port}][${n}] error while creating socks forwarding`,s),r.destroy()}))};let n=[];const o=(s,o)=>{const a=h.createServer();a.on("error",(t=>{e.error("[tunnel-forwarding] server threw an error",t)})),a.on("listening",(()=>{e.info(`[tunnel-forwarding][${s}:${o} -> ${t.remoteAddress.host}:${t.remoteAddress.port}] server listening`),a.on("connection",(e=>i(e,`${s}:${o}`)))})),a.listen(r,s),a.on("close",(()=>{e.info(`[tunnel-forwarding]${s}:${o} -> ${t.remoteAddress.host}:${t.remoteAddress.port}] server closed`)})),n.push(a)},f=await new Promise(((s,a)=>{const c="allInterfaces"===l.workspace.getConfiguration("remote").get("localPortHost","localhost")?"0.0.0.0":"localhost";let u=0===r;const d=h.createServer();n.push(d);let f=!1;d.on("error",(t=>{if(!f){if(!u)return e.error("[tunnel-forwarding] server threw an error; trying again on port 0",t),d.listen(0,c),void(u=!0);e.error("[tunnel-forwarding] server threw an error",t),a(t)}})),d.on("listening",(()=>{const r=d.address();if("string"==typeof r||null===r)return void a(new Error(`Invalid address: ${r}`));const n=r.port;e.info(`[tunnel-forwarding][${c}:${n} -> ${t.remoteAddress.host}:${t.remoteAddress.port}] server listening`),f=!0,d.on("close",(()=>{e.info(`[tunnel-forwarding]${c}:${n} -> ${t.remoteAddress.host}:${t.remoteAddress.port}] server closed`)})),d.on("connection",(e=>i(e,`${r.address}:${n}`))),"localhost"===c&&("127.0.0.1"===r.address?(e.info(`Cross binding to [::1]:${n}. Originally bound to ${r.address}:${n}`),o("::1",n)):(e.info(`Cross binding to 127.0.0.1:${n}. Originally bound to ${r.address}:${n}`),o("127.0.0.1",r.port))),s({address:c,port:r.port})})),d.listen(r,c)}));return new d(n,e,t.remoteAddress,{port:f.port,host:f.address},t.protocol,t.privacy)};const a=s(5861),h=o(s(9278)),l=o(s(1398)),c=o(s(6982)),u=s(1615);class d{constructor(e,t,s,r,i,n){this.servers=e,this.logger=t,this.remoteAddress=s,this.localAddress=r,this.protocol=i,this.privacy=n,this._disposed=!1,this._dispose_event_emitter=new l.EventEmitter,this.onDidDispose=this._dispose_event_emitter.event,this.servers[0]?.on("error",(e=>{this.logger.error("[tunnel] server threw an error",e),this.dispose()}))}dispose(){this._disposed||(this._disposed=!0,this.logger.info(`[tunnel] disposing of tunnel (remote) ${this.remoteAddress.host}:${this.remoteAddress.port} -> (local) ${this.localAddress.host}:${this.localAddress.port}`),this.servers.forEach((e=>{e.close((e=>{void 0!==e&&this.logger.error("[tunnel] server threw an error when closing",e)}))})),this._dispose_event_emitter.fire())}}},2437:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddressError=void 0;class s extends Error{constructor(e,t){super(e),this.name="AddressError",null!==t&&(this.parseMessage=t)}}t.AddressError=s},2525:(e,t,s)=>{"use strict";const r=s(7638),i=s(560);e.exports=(e,t,s)=>{const n=[];let o=null,a=null;const h=e.sort(((e,t)=>i(e,t,s)));for(const e of h)r(e,t,s)?(a=e,o||(o=e)):(a&&n.push([o,a]),a=null,o=null);o&&n.push([o,null]);const l=[];for(const[e,t]of n)e===t?l.push(e):t||e!==h[0]?t?e===h[0]?l.push(`<=${t}`):l.push(`${e} - ${t}`):l.push(`>=${e}`):l.push("*");const c=l.join(" || "),u="string"==typeof t.raw?t.raw:String(t);return c.length<u.length?c:t}},2585:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseClass=void 0;const s={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},r=e=>e.replace(/[[\]\\-]/g,"\\$&"),i=e=>e.join("");t.parseClass=(e,t)=>{const n=t;if("["!==e.charAt(n))throw new Error("not in a brace expression");const o=[],a=[];let h=n+1,l=!1,c=!1,u=!1,d=!1,f=n,p="";e:for(;h<e.length;){const t=e.charAt(h);if("!"!==t&&"^"!==t||h!==n+1){if("]"===t&&l&&!u){f=h+1;break}if(l=!0,"\\"!==t||u){if("["===t&&!u)for(const[t,[r,i,l]]of Object.entries(s))if(e.startsWith(t,h)){if(p)return["$.",!1,e.length-n,!0];h+=t.length,l?a.push(r):o.push(r),c=c||i;continue e}u=!1,p?(t>p?o.push(r(p)+"-"+r(t)):t===p&&o.push(r(t)),p="",h++):e.startsWith("-]",h+1)?(o.push(r(t+"-")),h+=2):e.startsWith("-",h+1)?(p=t,h+=2):(o.push(r(t)),h++)}else u=!0,h++}else d=!0,h++}if(f<h)return["",!1,0,!1];if(!o.length&&!a.length)return["$.",!1,e.length-n,!0];if(0===a.length&&1===o.length&&/^\\?.$/.test(o[0])&&!d){return[(m=2===o[0].length?o[0].slice(-1):o[0],m.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),!1,f-n,!1]}var m;const g="["+(d?"^":"")+i(o)+"]",S="["+(d?"":"^")+i(a)+"]";return[o.length&&a.length?"("+g+"|"+S+")":o.length?g:S,c,f-n,!0]}},2608:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.unescape=t.escape=t.AST=t.Minimatch=t.match=t.makeRe=t.braceExpand=t.defaults=t.filter=t.GLOBSTAR=t.sep=t.minimatch=void 0;const i=r(s(8422)),n=s(7184),o=s(2032),a=s(8641),h=s(1118);t.minimatch=(e,t,s={})=>((0,n.assertValidPattern)(t),!(!s.nocomment&&"#"===t.charAt(0))&&new A(t,s).match(e)),t.default=t.minimatch;const l=/^\*+([^+@!?\*\[\(]*)$/,c=e=>t=>!t.startsWith(".")&&t.endsWith(e),u=e=>t=>t.endsWith(e),d=e=>(e=e.toLowerCase(),t=>!t.startsWith(".")&&t.toLowerCase().endsWith(e)),f=e=>(e=e.toLowerCase(),t=>t.toLowerCase().endsWith(e)),p=/^\*+\.\*+$/,m=e=>!e.startsWith(".")&&e.includes("."),g=e=>"."!==e&&".."!==e&&e.includes("."),S=/^\.\*+$/,E=e=>"."!==e&&".."!==e&&e.startsWith("."),w=/^\*+$/,v=e=>0!==e.length&&!e.startsWith("."),_=e=>0!==e.length&&"."!==e&&".."!==e,y=/^\?+([^+@!?\*\[\(]*)?$/,R=([e,t=""])=>{const s=$([e]);return t?(t=t.toLowerCase(),e=>s(e)&&e.toLowerCase().endsWith(t)):s},b=([e,t=""])=>{const s=T([e]);return t?(t=t.toLowerCase(),e=>s(e)&&e.toLowerCase().endsWith(t)):s},O=([e,t=""])=>{const s=T([e]);return t?e=>s(e)&&e.endsWith(t):s},I=([e,t=""])=>{const s=$([e]);return t?e=>s(e)&&e.endsWith(t):s},$=([e])=>{const t=e.length;return e=>e.length===t&&!e.startsWith(".")},T=([e])=>{const t=e.length;return e=>e.length===t&&"."!==e&&".."!==e},C="object"==typeof process&&process?"object"==typeof process.env&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix";t.sep="win32"===C?"\\":"/",t.minimatch.sep=t.sep,t.GLOBSTAR=Symbol("globstar **"),t.minimatch.GLOBSTAR=t.GLOBSTAR,t.filter=(e,s={})=>r=>(0,t.minimatch)(r,e,s),t.minimatch.filter=t.filter;const k=(e,t={})=>Object.assign({},e,t);t.defaults=e=>{if(!e||"object"!=typeof e||!Object.keys(e).length)return t.minimatch;const s=t.minimatch;return Object.assign(((t,r,i={})=>s(t,r,k(e,i))),{Minimatch:class extends s.Minimatch{constructor(t,s={}){super(t,k(e,s))}static defaults(t){return s.defaults(k(e,t)).Minimatch}},AST:class extends s.AST{constructor(t,s,r={}){super(t,s,k(e,r))}static fromGlob(t,r={}){return s.AST.fromGlob(t,k(e,r))}},unescape:(t,r={})=>s.unescape(t,k(e,r)),escape:(t,r={})=>s.escape(t,k(e,r)),filter:(t,r={})=>s.filter(t,k(e,r)),defaults:t=>s.defaults(k(e,t)),makeRe:(t,r={})=>s.makeRe(t,k(e,r)),braceExpand:(t,r={})=>s.braceExpand(t,k(e,r)),match:(t,r,i={})=>s.match(t,r,k(e,i)),sep:s.sep,GLOBSTAR:t.GLOBSTAR})},t.minimatch.defaults=t.defaults,t.braceExpand=(e,t={})=>((0,n.assertValidPattern)(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:(0,i.default)(e)),t.minimatch.braceExpand=t.braceExpand,t.makeRe=(e,t={})=>new A(e,t).makeRe(),t.minimatch.makeRe=t.makeRe,t.match=(e,t,s={})=>{const r=new A(t,s);return e=e.filter((e=>r.match(e))),r.options.nonull&&!e.length&&e.push(t),e},t.minimatch.match=t.match;const P=/[?*]|[+@!]\(.*?\)|\[|\]/;class A{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,t={}){(0,n.assertValidPattern)(e),t=t||{},this.options=t,this.pattern=e,this.platform=t.platform||C,this.isWindows="win32"===this.platform,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||!1===t.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!t.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!t.nonegate,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=void 0!==t.windowsNoMagicRoot?t.windowsNoMagicRoot:!(!this.isWindows||!this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(const e of this.set)for(const t of e)if("string"!=typeof t)return!0;return!1}debug(...e){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,this.globSet);const s=this.globSet.map((e=>this.slashSplit(e)));this.globParts=this.preprocess(s),this.debug(this.pattern,this.globParts);let r=this.globParts.map(((e,t,s)=>{if(this.isWindows&&this.windowsNoMagicRoot){const t=!(""!==e[0]||""!==e[1]||"?"!==e[2]&&P.test(e[2])||P.test(e[3])),s=/^[a-z]:/i.test(e[0]);if(t)return[...e.slice(0,4),...e.slice(4).map((e=>this.parse(e)))];if(s)return[e[0],...e.slice(1).map((e=>this.parse(e)))]}return e.map((e=>this.parse(e)))}));if(this.debug(this.pattern,r),this.set=r.filter((e=>-1===e.indexOf(!1))),this.isWindows)for(let e=0;e<this.set.length;e++){const t=this.set[e];""===t[0]&&""===t[1]&&"?"===this.globParts[e][2]&&"string"==typeof t[3]&&/^[a-z]:$/i.test(t[3])&&(t[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let t=0;t<e.length;t++)for(let s=0;s<e[t].length;s++)"**"===e[t][s]&&(e[t][s]="*");const{optimizationLevel:t=1}=this.options;return t>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):e=t>=1?this.levelOneOptimize(e):this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map((e=>{let t=-1;for(;-1!==(t=e.indexOf("**",t+1));){let s=t;for(;"**"===e[s+1];)s++;s!==t&&e.splice(t,s-t)}return e}))}levelOneOptimize(e){return e.map((e=>0===(e=e.reduce(((e,t)=>{const s=e[e.length-1];return"**"===t&&"**"===s?e:".."===t&&s&&".."!==s&&"."!==s&&"**"!==s?(e.pop(),e):(e.push(t),e)}),[])).length?[""]:e))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(let s=1;s<e.length-1;s++){const r=e[s];1===s&&""===r&&""===e[0]||"."!==r&&""!==r||(t=!0,e.splice(s,1),s--)}"."!==e[0]||2!==e.length||"."!==e[1]&&""!==e[1]||(t=!0,e.pop())}let s=0;for(;-1!==(s=e.indexOf("..",s+1));){const r=e[s-1];r&&"."!==r&&".."!==r&&"**"!==r&&(t=!0,e.splice(s-1,2),s-=2)}}while(t);return 0===e.length?[""]:e}firstPhasePreProcess(e){let t=!1;do{t=!1;for(let s of e){let r=-1;for(;-1!==(r=s.indexOf("**",r+1));){let i=r;for(;"**"===s[i+1];)i++;i>r&&s.splice(r+1,i-r);let n=s[r+1];const o=s[r+2],a=s[r+3];if(".."!==n)continue;if(!o||"."===o||".."===o||!a||"."===a||".."===a)continue;t=!0,s.splice(r,1);const h=s.slice(0);h[r]="**",e.push(h),r--}if(!this.preserveMultipleSlashes){for(let e=1;e<s.length-1;e++){const r=s[e];1===e&&""===r&&""===s[0]||"."!==r&&""!==r||(t=!0,s.splice(e,1),e--)}"."!==s[0]||2!==s.length||"."!==s[1]&&""!==s[1]||(t=!0,s.pop())}let i=0;for(;-1!==(i=s.indexOf("..",i+1));){const e=s[i-1];if(e&&"."!==e&&".."!==e&&"**"!==e){t=!0;const e=1===i&&"**"===s[i+1]?["."]:[];s.splice(i-1,2,...e),0===s.length&&s.push(""),i-=2}}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++)for(let s=t+1;s<e.length;s++){const r=this.partsMatch(e[t],e[s],!this.preserveMultipleSlashes);r&&(e[t]=r,e[s]=[])}return e.filter((e=>e.length))}partsMatch(e,t,s=!1){let r=0,i=0,n=[],o="";for(;r<e.length&&i<t.length;)if(e[r]===t[i])n.push("b"===o?t[i]:e[r]),r++,i++;else if(s&&"**"===e[r]&&t[i]===e[r+1])n.push(e[r]),r++;else if(s&&"**"===t[i]&&e[r]===t[i+1])n.push(t[i]),i++;else if("*"!==e[r]||!t[i]||!this.options.dot&&t[i].startsWith(".")||"**"===t[i]){if("*"!==t[i]||!e[r]||!this.options.dot&&e[r].startsWith(".")||"**"===e[r])return!1;if("a"===o)return!1;o="b",n.push(t[i]),r++,i++}else{if("b"===o)return!1;o="a",n.push(e[r]),r++,i++}return e.length===t.length&&n}parseNegate(){if(this.nonegate)return;const e=this.pattern;let t=!1,s=0;for(let r=0;r<e.length&&"!"===e.charAt(r);r++)t=!t,s++;s&&(this.pattern=e.slice(s)),this.negate=t}matchOne(e,s,r=!1){const i=this.options;if(this.isWindows){const t=""===e[0]&&""===e[1]&&"?"===e[2]&&"string"==typeof e[3]&&/^[a-z]:$/i.test(e[3]),r=""===s[0]&&""===s[1]&&"?"===s[2]&&"string"==typeof s[3]&&/^[a-z]:$/i.test(s[3]);if(t&&r){const t=e[3],r=s[3];t.toLowerCase()===r.toLowerCase()&&(e[3]=r)}else if(r&&"string"==typeof e[0]){const t=s[3],r=e[0];t.toLowerCase()===r.toLowerCase()&&(s[3]=r,s=s.slice(3))}else if(t&&"string"==typeof s[0]){const t=e[3];t.toLowerCase()===s[0].toLowerCase()&&(s[0]=t,e=e.slice(3))}}const{optimizationLevel:n=1}=this.options;n>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:s}),this.debug("matchOne",e.length,s.length);for(var o=0,a=0,h=e.length,l=s.length;o<h&&a<l;o++,a++){this.debug("matchOne loop");var c=s[a],u=e[o];if(this.debug(s,c,u),!1===c)return!1;if(c===t.GLOBSTAR){this.debug("GLOBSTAR",[s,c,u]);var d=o,f=a+1;if(f===l){for(this.debug("** at the end");o<h;o++)if("."===e[o]||".."===e[o]||!i.dot&&"."===e[o].charAt(0))return!1;return!0}for(;d<h;){var p=e[d];if(this.debug("\nglobstar while",e,d,s,f,p),this.matchOne(e.slice(d),s.slice(f),r))return this.debug("globstar found match!",d,h,p),!0;if("."===p||".."===p||!i.dot&&"."===p.charAt(0)){this.debug("dot detected!",e,d,s,f);break}this.debug("globstar swallow a segment, and continue"),d++}return!(!r||(this.debug("\n>>> no match, partial?",e,d,s,f),d!==h))}let n;if("string"==typeof c?(n=u===c,this.debug("string match",c,u,n)):(n=c.test(u),this.debug("pattern match",c,u,n)),!n)return!1}if(o===h&&a===l)return!0;if(o===h)return r;if(a===l)return o===h-1&&""===e[o];throw new Error("wtf?")}braceExpand(){return(0,t.braceExpand)(this.pattern,this.options)}parse(e){(0,n.assertValidPattern)(e);const s=this.options;if("**"===e)return t.GLOBSTAR;if(""===e)return"";let r,i=null;(r=e.match(w))?i=s.dot?_:v:(r=e.match(l))?i=(s.nocase?s.dot?f:d:s.dot?u:c)(r[1]):(r=e.match(y))?i=(s.nocase?s.dot?b:R:s.dot?O:I)(r):(r=e.match(p))?i=s.dot?g:m:(r=e.match(S))&&(i=E);const a=o.AST.fromGlob(e,this.options).toMMPattern();return i?Object.assign(a,{test:i}):a}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const s=this.options,r=s.noglobstar?"[^/]*?":s.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",i=new Set(s.nocase?["i"]:[]);let n=e.map((e=>{const s=e.map((e=>{if(e instanceof RegExp)for(const t of e.flags.split(""))i.add(t);return"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e===t.GLOBSTAR?t.GLOBSTAR:e._src}));return s.forEach(((e,i)=>{const n=s[i+1],o=s[i-1];e===t.GLOBSTAR&&o!==t.GLOBSTAR&&(void 0===o?void 0!==n&&n!==t.GLOBSTAR?s[i+1]="(?:\\/|"+r+"\\/)?"+n:s[i]=r:void 0===n?s[i-1]=o+"(?:\\/|"+r+")?":n!==t.GLOBSTAR&&(s[i-1]=o+"(?:\\/|\\/"+r+"\\/)"+n,s[i+1]=t.GLOBSTAR))})),s.filter((e=>e!==t.GLOBSTAR)).join("/")})).join("|");const[o,a]=e.length>1?["(?:",")"]:["",""];n="^"+o+n+a+"$",this.negate&&(n="^(?!"+n+").+$");try{this.regexp=new RegExp(n,[...i].join(""))}catch(e){this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;const s=this.options;this.isWindows&&(e=e.split("\\").join("/"));const r=this.slashSplit(e);this.debug(this.pattern,"split",r);const i=this.set;this.debug(this.pattern,"set",i);let n=r[r.length-1];if(!n)for(let e=r.length-2;!n&&e>=0;e--)n=r[e];for(let e=0;e<i.length;e++){const o=i[e];let a=r;if(s.matchBase&&1===o.length&&(a=[n]),this.matchOne(a,o,t))return!!s.flipNegate||!this.negate}return!s.flipNegate&&this.negate}static defaults(e){return t.minimatch.defaults(e).Minimatch}}t.Minimatch=A;var L=s(2032);Object.defineProperty(t,"AST",{enumerable:!0,get:function(){return L.AST}});var x=s(8641);Object.defineProperty(t,"escape",{enumerable:!0,get:function(){return x.escape}});var N=s(1118);Object.defineProperty(t,"unescape",{enumerable:!0,get:function(){return N.unescape}}),t.minimatch.AST=o.AST,t.minimatch.Minimatch=A,t.minimatch.escape=a.escape,t.minimatch.unescape=h.unescape},2699:function(e,t,s){"use strict";const r=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(s(6564));e.exports=Object.assign(r.default,{default:r.default,glob:r.default})},2839:function(e,t,s){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&r(t,e,s);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Address4=void 0;const o=n(s(837)),a=n(s(9576)),h=s(2437),l=s(9534),c=s(7604);class u{constructor(e){this.groups=a.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=o.isCorrect(a.BITS),this.isInSubnet=o.isInSubnet,this.address=e;const t=a.RE_SUBNET_STRING.exec(e);if(t){if(this.parsedSubnet=t[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,this.subnetMask<0||this.subnetMask>a.BITS)throw new h.AddressError("Invalid subnet mask.");e=e.replace(a.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}static isValid(e){try{return new u(e),!0}catch(e){return!1}}parse(e){const t=e.split(".");if(!e.match(a.RE_ADDRESS))throw new h.AddressError("Invalid IPv4 address.");return t}correctForm(){return this.parsedAddress.map((e=>parseInt(e,10))).join(".")}static fromHex(e){const t=e.replace(/:/g,"").padStart(8,"0"),s=[];let r;for(r=0;r<8;r+=2){const e=t.slice(r,r+2);s.push(parseInt(e,16))}return new u(s.join("."))}static fromInteger(e){return u.fromHex(e.toString(16))}static fromArpa(e){const t=e.replace(/(\.in-addr\.arpa)?\.$/,"").split(".").reverse().join(".");return new u(t)}toHex(){return this.parsedAddress.map((e=>(0,c.sprintf)("%02x",parseInt(e,10)))).join(":")}toArray(){return this.parsedAddress.map((e=>parseInt(e,10)))}toGroup6(){const e=[];let t;for(t=0;t<a.GROUPS;t+=2){const s=(0,c.sprintf)("%02x%02x",parseInt(this.parsedAddress[t],10),parseInt(this.parsedAddress[t+1],10));e.push((0,c.sprintf)("%x",parseInt(s,16)))}return e.join(":")}bigInteger(){return new l.BigInteger(this.parsedAddress.map((e=>(0,c.sprintf)("%02x",parseInt(e,10)))).join(""),16)}_startAddress(){return new l.BigInteger(this.mask()+"0".repeat(a.BITS-this.subnetMask),2)}startAddress(){return u.fromBigInteger(this._startAddress())}startAddressExclusive(){const e=new l.BigInteger("1");return u.fromBigInteger(this._startAddress().add(e))}_endAddress(){return new l.BigInteger(this.mask()+"1".repeat(a.BITS-this.subnetMask),2)}endAddress(){return u.fromBigInteger(this._endAddress())}endAddressExclusive(){const e=new l.BigInteger("1");return u.fromBigInteger(this._endAddress().subtract(e))}static fromBigInteger(e){return u.fromInteger(parseInt(e.toString(),10))}mask(e){return void 0===e&&(e=this.subnetMask),this.getBitsBase2(0,e)}getBitsBase2(e,t){return this.binaryZeroPad().slice(e,t)}reverseForm(e){e||(e={});const t=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?t:(0,c.sprintf)("%s.in-addr.arpa.",t)}isMulticast(){return this.isInSubnet(new u("224.0.0.0/4"))}binaryZeroPad(){return this.bigInteger().toString(2).padStart(a.BITS,"0")}groupForV6(){const e=this.parsedAddress;return this.address.replace(a.RE_ADDRESS,(0,c.sprintf)('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))}}t.Address4=u},2846:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simpleGroup=t.spanLeadingZeroes=t.spanAll=t.spanAllZeroes=void 0;const r=s(7604);function i(e){return e.replace(/(0+)/g,'<span class="zero">$1</span>')}function n(e){return e.replace(/^(0+)/,'<span class="zero">$1</span>')}t.spanAllZeroes=i,t.spanAll=function(e,t=0){return e.split("").map(((e,s)=>(0,r.sprintf)('<span class="digit value-%s position-%d">%s</span>',e,s+t,i(e)))).join("")},t.spanLeadingZeroes=function(e){return e.split(":").map((e=>n(e))).join(":")},t.simpleGroup=function(e,t=0){return e.split(":").map(((e,s)=>/group-v4/.test(e)?e:(0,r.sprintf)('<span class="hover-group group-%d">%s</span>',s+t,n(e))))}},2938:(e,t,s)=>{"use strict";const r=s(3908);e.exports=(e,t)=>new r(e,t).major},3007:(e,t,s)=>{"use strict";const r=s(3908);e.exports=(e,t,s,i,n)=>{"string"==typeof s&&(n=i,i=s,s=void 0);try{return new r(e instanceof r?e.version:e,s).inc(t,i,n).version}catch(e){return null}}},3024:e=>{"use strict";e.exports=require("node:fs")},3136:e=>{"use strict";e.exports=require("node:url")},3193:e=>{"use strict";e.exports=require("string_decoder")},3256:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getSSHConfigPath=E,t.getSSHConfigPathOrDefault=function(){const e=E();return e?(0,f.untildify)(e):S};const h=o(s(857)),l=o(s(9896)),c=o(s(6928)),u=a(s(1182)),d=o(s(1398)),f=s(680),p=s(3540),m=s(2699),g=p.isWindows?c.resolve(process.env.ALLUSERSPROFILE||"C:\\ProgramData","ssh\\ssh_config"):"/etc/ssh/ssh_config",S=c.resolve(h.homedir(),".ssh/config");function E(){const e=d.workspace.getConfiguration("remote.SSH").get("configFile");return e?(0,f.untildify)(e):void 0}function w(e){return e.type===u.default.DIRECTIVE}function v(e){return w(e)&&"Host"===e.param&&!!e.value&&!!e.config}function _(e){return w(e)&&"Include"===e.param&&!!e.value}const y={host:"Host",hostname:"HostName",user:"User",port:"Port",identityagent:"IdentityAgent",identitiesonly:"IdentitiesOnly",identityfile:"IdentityFile",forwardagent:"ForwardAgent",preferredauthentications:"PreferredAuthentications",proxyjump:"ProxyJump",proxycommand:"ProxyCommand",include:"Include"};function R(e){for(const s of e)w(s)&&((t=s).param=y[t.param.toLowerCase()]||t.param),v(s)&&R(s.config);var t;return e}async function b(e,t,s){let r="";if(await(0,f.exists)(e))try{r=(await l.promises.readFile(e,"utf8")).trim()}catch(t){s.error(`Error reading SSH config from ${e}: ${t}`)}const i=R(u.default.parse(r)),n=[];for(let e=0;e<i.length;e++){const r=i[e];if(_(r)){const i=r.value.split(",").map((e=>e.trim())),o=[];for(const e of i){const r=await(0,m.glob)((0,f.normalizeToSlash)((0,f.untildify)(e)),{absolute:!0,cwd:(0,f.normalizeToSlash)(c.dirname(t))});for(const e of r)o.push(await b(e,t,s))}n.push([e,o])}}for(const[e,t]of n.reverse())i.splice(e,1,...t.flat());return i}class O{static async loadFromFS(e,t){t||(t=S);const s=await b(t,t,e);return s.push(...await b(g,g,e)),new O(s)}constructor(e){this.sshConfig=e}getAllConfiguredHosts(){const e=new Set;for(const t of this.sshConfig)if(v(t)){const s=Array.isArray(t.value)?t.value:[t.value];for(const t of s)/^!/.test(t)||/[?*]/.test(t)||e.add(t)}return[...e.keys()]}getHostConfiguration(e){return this.sshConfig.compute(e)}}t.default=O},3540:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLinux=t.isMacintosh=t.isWindows=void 0,t.isWindows="win32"===process.platform,t.isMacintosh="darwin"===process.platform,t.isLinux="linux"===process.platform},3670:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.SSHConnectionFactory=void 0;const a=o(s(5317)),h=s(7175),l=o(s(1398)),c=s(3540),u=s(71),d=o(s(6982)),f=o(s(9896)),p=o(s(6928)),m=o(s(857));t.SSHConnectionFactory=class{constructor(e,t){this.logger=e,this.config=t}async copyToRemote({localPath:e,remotePath:t,hasRemoteCommand:s,env:r,isWindowsRemote:i,verbose:n}){const o=[];n&&o.push("-v"),o.push("-T"),this.config.sshConfigPath&&o.push("-F",this.config.sshConfigPath),s&&o.push("-o","RemoteCommand=none");let h,g=this.config.destination;for(const e of["ssh ","ssh.exe ",this.config.sshPath+" "])if(g.startsWith(e)){g=g.slice(e.length);break}try{let s;if(i||c.isWindows){const t=await f.promises.readFile(e,"base64");h=p.join(m.tmpdir(),`cursor_remote_copy_${d.randomUUID()}.b64`),this.logger.info(`Base64-encoding local file ${e} to temp file ${h}`),await f.promises.writeFile(h,t),e=h}if(i)if(t=(t=t.replace(/^~(?=$|\/|\\)/,"%USERPROFILE%")).replaceAll("/","\\"),c.isWindows){const r=`"powershell -NoProfile -Command \`"^\`$input ^| Set-Content '${t}.temp'; Remove-Item -Force '${t}' -ErrorAction Ignore; certutil -decode '${t}.temp' '${t}'; echo 'wrote decoded'; Remove-Item -Force '${t}.temp' -ErrorAction Ignore\`""`;s=`Get-Content -Raw "${e}" | ${this.config.sshPath} ${o.join(" ")} ${g} ${r}`}else s=`\nCMD=$(cat <<'POWERSHELL_CMD_EOF'\npowershell -NoProfile -Command "$input | Set-Content '${t}.temp'; echo 'finished copy'; Remove-Item -Force '${t}' -ErrorAction Ignore; certutil -decode '${t}.temp' '${t}'; echo 'wrote decoded'; Remove-Item -Force '${t}.temp' -ErrorAction Ignore"\nPOWERSHELL_CMD_EOF\n)\ncat "${e}" | ${this.config.sshPath} ${o.join(" ")} ${g} "$CMD"`;else t=t.replace(/^~(?=$|\/|\\)/,"$HOME"),c.isWindows?(t=t.replaceAll("$","`$"),s=`Get-Content -Raw "${e}" | ${this.config.sshPath} ${o.join(" ")} ${g} "bash -c \`'cat | (tr -d \`"[:space:]\`" || true) | (base64 -d 2>/dev/null || base64 -D || true) > \`"${t}\`"\`'"`):s=`cat "${e}" | ${this.config.sshPath} ${o.join(" ")} ${g} 'cat > "${t}"'`;if(this.config.showLoginTerminal){delete(r={...r}).SSH_ASKPASS,delete r.SSH_ASKPASS_REQUIRE,delete r.ARGV0;const e=l.window.createTerminal({name:"Cursor Remote SSH",env:r,shellPath:c.isWindows?"powershell":"/bin/sh",hideFromUser:!1,cwd:l.Uri.from({scheme:"file",path:m.homedir()})});let t;try{return c.isWindows?(e.sendText(s,!0),e.sendText('echo "Exit code: $LASTEXITCODE. Finished copying file to remote."',!0)):e.sendText(`${s}; echo "Exit code: $?. Finished copying file to remote."`,!0),e.show(),void await new Promise(((s,r)=>{let i="";t=l.window.onDidWriteTerminalData((t=>{if(t.terminal===e){i+=t.data;const e=i.match(/Exit code: (\d+)\. Finished copying file to remote/);if(e&&void 0!==e[1])return void(0===parseInt(e[1],10)?s():r(new Error("Failed to copy the server to the remote host. Please check the logs for more details.")));i.length>100&&(i=i.slice(-100))}}))}))}finally{t?.dispose()}}const n={...process.env,...r};delete n.ARGV0,this.logger.info(`Copying file to remote via SSH: ${s}`);const S=a.spawn(s,{env:n,shell:!c.isWindows||"powershell",detached:!c.isWindows,windowsHide:!0});await(0,u.checkCall)(this.logger,"copyToRemote",S)}finally{if(h)try{await f.promises.unlink(h)}catch(e){this.logger.error(`Error deleting temp file ${h}: ${e}`)}}}async execHandler({remoteCommand:e,enableRemoteCommand:t,env:s,command:r,shellCmdPrefix:i,verbose:n}){const o=["-T"];n&&o.push("-v"),this.config.sshConfigPath&&o.push("-F",`"${this.config.sshConfigPath}"`),void 0!==e&&(t?r="":o.push("-o","RemoteCommand=none"));const u=await(0,h.findRandomPort)();o.push("-D",`${u}`);let d=this.config.destination;for(const e of["ssh ","ssh.exe ",this.config.sshPath+" "])if(d.startsWith(e)){d=d.slice(e.length);break}o.push(d),o.push(r),this.logger.info(`Launching SSH server via shell with command: ${i}${this.config.sshPath} ${o.join(" ")}`);let f=`${i}${[this.config.sshPath,...o].join(" ")}`;if(this.config.showLoginTerminal){delete(s={...s}).SSH_ASKPASS,delete s.SSH_ASKPASS_REQUIRE,delete s.ARGV0;const e=l.window.createTerminal({name:"Cursor Remote SSH",shellPath:c.isWindows?"cmd":"/bin/sh",hideFromUser:!1,env:s,cwd:l.Uri.from({scheme:"file",path:this.config.extensionPath}),isTransient:!0});c.isWindows?e.sendText(`${f} & echo "Exit code: %ERRORLEVEL%. Finished running command."`,!0):e.sendText(`${f}; echo "Exit code: $?. Finished running command."`,!0),e.show();const t=new l.EventEmitter,r=new Promise(((s,r)=>{let i="";const n=l.window.onDidWriteTerminalData((o=>{if(o.terminal===e){this.logger.info(`(ssh_tunnel) stdout: ${o.data}`),t.fire(o.data),i+=o.data;const e=i.match(/Exit code: (\d+)\. Finished running command/);if(e&&void 0!==e[1]){const i=parseInt(e[1],10);return void 0!==i?s(i):r(new Error("Failed to connect to and start the remote server.")),n.dispose(),void t.dispose()}i.length>100&&(i=i.slice(-100))}}))})),i=new l.EventEmitter;return{stdout:t.event,stderr:i.event,done:r,socksPort:u,kill:()=>{e.dispose(),t.dispose(),i.dispose()}}}const p={...process.env,...s};delete p.ARGV0,this.logger.info(`Establishing SSH connection: ${f}`);const m=a.spawn(f,{env:p,shell:!c.isWindows||"cmd",detached:!c.isWindows,windowsHide:!0}),g=new l.EventEmitter;m.stdout.on("data",(e=>{const t=Buffer.from(e).toString("utf8");this.logger.info(`(ssh_tunnel) stdout: ${t}`),g.fire(t)}));const S=new l.EventEmitter;m.stderr.on("data",(e=>{const t=Buffer.from(e).toString("utf8");this.logger.info(`(ssh_tunnel) stderr: ${t}`),S.fire(t)}));const E=new Promise(((e,t)=>{m.on("close",((s,r)=>{null===s?t(new Error("Process exited with signal "+r)):e(s),g.dispose(),S.dispose()})),m.on("error",(e=>{t(new Error("Process failed to start: "+e))}))}));return{stdout:g.event,stderr:S.event,done:E,socksPort:u,kill:()=>this.terminateProcessSync(m)}}terminateProcessSync(e){try{if(c.isWindows)a.execFileSync("taskkill",["/T","/F","/PID",e.pid.toString()],{stdio:["pipe","pipe","ignore"]});else if(c.isLinux||c.isMacintosh){const t=p.join(this.config.extensionPath,"dist","scripts","terminateProcess.sh");try{f.chmodSync(t,493)}catch(e){this.logger.error(`Error setting permissions on terminate script: ${e}`)}const s=a.spawnSync(t,[e.pid.toString()]);if(s.error)throw s.error}else e.kill("SIGKILL")}catch(e){this.logger.error(`Error terminating process: ${e}`)}}}},3724:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.getVSCodeServerConfig=async function(){const e=await async function(){if(!c){let e;const t=l.join(a.env.appRoot,"product.json");try{e=await h.promises.readFile(t,"utf8")}catch(e){throw new Error(`Failed to read product.json from ${t}: ${e}`)}c=JSON.parse(e)}return c}();let t="production";return"cursor-lab"===e.applicationName&&(t="lab"),"cursor-nightly"===e.applicationName&&(t="nightly"),{version:e.version,commit:e.commit??e.nightlyCommit,realCommit:e.realCommit,line:t,serverApplicationName:e.serverApplicationName,serverDataFolderName:e.serverDataFolderName}};const a=o(s(1398)),h=o(s(9896)),l=o(s(6928));let c},3763:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shuffleArray=t.SocksClientError=void 0;class s extends Error{constructor(e,t){super(e),this.options=t}}t.SocksClientError=s,t.shuffleArray=function(e){for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}}},3874:(e,t,s)=>{"use strict";const r=s(8311);e.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch(e){return null}}},3904:(e,t,s)=>{"use strict";const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(e,t){if(t=n(t),e instanceof i){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===r?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?o[a.COMPARATORLOOSE]:o[a.COMPARATOR],s=e.match(t);if(!s)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==s[1]?s[1]:"","="===this.operator&&(this.operator=""),s[2]?this.semver=new c(s[2],this.options.loose):this.semver=r}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return h(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new u(e.value,t).test(this.value):""===e.operator?""===e.value||new u(this.value,t).test(e.semver):!((t=n(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(h(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(h(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=i;const n=s(8587),{safeRe:o,t:a}=s(9718),h=s(2111),l=s(7272),c=s(3908),u=s(8311)},3908:(e,t,s)=>{"use strict";const r=s(7272),{MAX_LENGTH:i,MAX_SAFE_INTEGER:n}=s(6874),{safeRe:o,t:a}=s(9718),h=s(8587),{compareIdentifiers:l}=s(1123);class c{constructor(e,t){if(t=h(t),e instanceof c){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const s=e.trim().match(t.loose?o[a.LOOSE]:o[a.FULL]);if(!s)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if("string"==typeof e&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const s=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,s,i),void 0===s&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===s)return-1;if(s!==i)return l(s,i)}while(++t)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let t=0;do{const s=this.build[t],i=e.build[t];if(r("build compare",t,s,i),void 0===s&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===s)return-1;if(s!==i)return l(s,i)}while(++t)}inc(e,t,s){if(e.startsWith("pre")){if(!t&&!1===s)throw new Error("invalid increment argument: identifier is empty");if(t){const e=`-${t}`.match(this.options.loose?o[a.PRERELEASELOOSE]:o[a.PRERELEASE]);if(!e||e[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,s);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,s);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,s),this.inc("pre",t,s);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,s),this.inc("pre",t,s);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(s)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===s)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===s&&(r=[t]),0===l(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=c},3927:(e,t,s)=>{"use strict";const r=s(909);e.exports=(e,t)=>e.sort(((e,s)=>r(e,s,t)))},3999:(e,t,s)=>{"use strict";const r=s(560);e.exports=(e,t,s)=>0!==r(e,t,s)},4001:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t}),a=this&&this.__addDisposableResource||function(e,t,s){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,i;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],s&&(i=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:s})}else s&&e.stack.push({async:!0});return t},h=this&&this.__disposeResources||function(e){return function(t){function s(s){t.error=t.hasError?new e(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var r,i=0;return function e(){for(;r=t.stack.pop();)try{if(!r.async&&1===i)return i=0,t.stack.push(r),Promise.resolve().then(e);if(r.dispose){var n=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(n).then(e,(function(t){return s(t),e()}))}else i|=1}catch(e){s(e)}if(1===i)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,s){var r=new Error(s);return r.name="SuppressedError",r.error=e,r.suppressed=t,r}),l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteSSHResolver=t.REMOTE_SSH_AUTHORITY=void 0,t.getReinstallKey=C,t.getKillRunningServersKey=k,t.getRemoteAuthority=function(e){return`${t.REMOTE_SSH_AUTHORITY}+${e}`};const c=o(s(9278)),u=s(5861),d=o(s(1398)),f=l(s(4576)),p=o(s(3256)),m=s(9449),g=s(3670),S=s(3540),E=o(s(857)),w=o(s(8611)),v=o(s(6928)),_=o(s(9896)),y=s(2357),R=s(7480),b=s(4946),O=o(s(6982)),I=s(71),$=s(2407),T=s(1615);function C(e){return"cursor-remote-ssh.reinstall."+e}function k(e){return"cursor-remote-ssh.kill-running-servers."+e}t.REMOTE_SSH_AUTHORITY="ssh-remote",t.RemoteSSHResolver=class{constructor(e,t){this.context=e,this.logger=t,this.askpassStartedEventEmitter=new d.EventEmitter,this.askpassFinishedEventEmitter=new d.EventEmitter,this.defaultTunnels=[],this.tunnelFactory=e=>(0,$.createTunnel)(this.logger,e,(()=>void 0===this.remoteServer?void 0:{port:this.remoteServer.socksPort,address:this.remoteServer.socksAddress}))}async setupAskpassServer(){if(void 0!==this.askpassServer){const e=this.askpassServer.address();if(null===e)throw new Error("Askpass server already setup but address is null");return"string"==typeof e?e:e.port.toString()}const e=w.createServer((async(e,t)=>{if(this.logger.info(`Askpass server received request: ${e.method} ${e.url}`),"POST"===e.method){let s="";for await(const t of e)s+=t.toString();this.logger.info(`Askpass server received request body: ${s}`),this.askpassStartedEventEmitter.fire();try{const e=JSON.parse(s);if(this.logger.info(`Received SSH askpass request: ${e.request}`),e.request.includes("The authenticity of host")&&e.request.includes("can't be established"))"Yes"===await d.window.showQuickPick(["Yes","No"],{title:e.request+" Do you want to trust this host?",placeHolder:"Yes"})?(t.writeHead(200,{"Content-Type":"text/plain"}),t.end("yes")):(t.writeHead(200,{"Content-Type":"text/plain"}),t.end("no"));else{const s=await d.window.showInputBox({title:e.request,password:!0,ignoreFocusOut:!0});void 0===s?(this.logger.error("Password authentication cancelled"),t.writeHead(500,{"Content-Type":"text/plain"}),t.end("Password authentication cancelled")):(t.writeHead(200,{"Content-Type":"text/plain"}),t.end(s||""))}}catch(e){this.logger.error(`Error parsing request: ${e}`),t.writeHead(400,{"Content-Type":"text/plain"}),t.end("Invalid request format")}finally{this.askpassFinishedEventEmitter.fire()}}else t.writeHead(405,{"Content-Type":"text/plain"}),t.end("Method Not Allowed")}));this.askpassServer=e;const t=new Promise(((t,s)=>{e.on("error",(e=>{this.logger.error("SSH askpass server threw an error",e),s(e)})),e.on("listening",(()=>{const r=e.address();if(null!==r){if("string"==typeof r)return this.logger.info(`SSH askpass server listening on ${r}`),void t(r);this.logger.info(`SSH askpass server listening on port ${r.port}`),t(r.port.toString())}else s(new Error(`Invalid address: ${r}`))}))}));if(S.isWindows)e.listen(0,"127.0.0.1");else{const t=await _.promises.mkdtemp(v.join(E.tmpdir(),"cursor-ssh-")),s=v.join(t,"socket.sock");e.listen(s)}return await t}async setupForwardingServer(e,t,s,r,i){const n=t();if(void 0!==n){const t=n.address();if(null===t)throw new Error(`[forwarding][${e}] Server address should not be null`);if("string"==typeof t)throw new Error(`[forwarding][${e}] Server address should not be a string, since we always listen on a port`);return this.logger.info(`[forwarding][${e}] returning existing forwarding server listening on local port ${t.port}`),t}this.logger.info(`[forwarding][${e}] creating new forwarding server`);const o=c.createServer(),a=new Promise(((r,i)=>{o.on("listening",(()=>{const t=o.address();if("string"==typeof t||null===t)return void i(new Error(`Invalid address: ${t}`));const s=t.port;this.logger.info(`[forwarding][${e}] server listening on ${t.address}:${s}`),r(t)})),o.on("error",(r=>{this.logger.error(`[forwarding][${e}] server threw an error`,r),t()===o&&s(void 0),i(r),o.close()}))}));o.on("connection",(t=>{const s=O.randomUUID();t.pause();const i=r(),n=`${h.address}:${h.port}`;if(void 0===i)return this.logger.error(`[forwarding][${e}][${n} -> unknown}][${s}] remote server not configured`),void t.destroy();const o=`${i.address}:${i.port}`;if(this.logger.info(`[forwarding][${e}][${n} -> ${o}][${s}] received connection request`),void 0===this.remoteServer)return this.logger.error(`[forwarding][${e}][${n} ->${o}][${s}] remote server not configured`),void t.destroy();const a=`${this.remoteServer.socksAddress}:${this.remoteServer.socksPort}`;u.SocksClient.createConnection({proxy:{host:this.remoteServer.socksAddress,port:this.remoteServer.socksPort,type:5},command:"connect",destination:{host:i.address,port:i.port}}).then((r=>{r.socket.on("error",(i=>{this.logger.error(`[forwarding][${e}][${n} -> ${a} -> ${o}][${s}] socks connection threw an error`,i),t.destroy(),r.socket.destroy()})),r.socket.on("close",(()=>{this.logger.info(`[forwarding][${e}][${n} -> ${a} -> ${o}][${s}] socks connection closed`)})),t.on("error",(t=>{this.logger.info(`[forwarding][${e}][${n} -> ${a} -> ${o}][${s}] local connection threw an error`,t),r.socket.destroy()})),t.on("data",(e=>{(0,T.addUp)(e.length)})),r.socket.on("data",(e=>{(0,T.addDown)(e.length)})),t.resume(),t.pipe(r.socket),r.socket.pipe(t),this.logger.info(`[forwarding][${e}][${n} -> ${a} -> ${o}][${s}] socks forwarding established`)})).catch((r=>{this.logger.error(`[forwarding][${e}][${n} -> ${a} -> ${o}][${s}] error while creating socks forwarding`,r),t.destroy()}))})),o.listen(0,"127.0.0.1");const h=await(i?Promise.race([a,new Promise(((e,t)=>{i.addEventListener("abort",(()=>{t(new Error("Timeout while waiting for forwarding server to listen"))}),{once:!0})}))]):a);return s(o),this.logger.info(`[forwarding][${e}] Set up server`),h}oldParseAuthority(e){const t=f.default.parseEncoded(e).toString(),s=t.match(/^ssh-remote\+(?:([^@]+)@)?([^:]+)(?::(\d+))?$/);if(!s)throw new Error(`Invalid authority format: ${t}`);let[,r,i,n]=s;return i?.startsWith("ssh ")?i=i.substring(4):i?.startsWith("ssh.exe ")&&(i=i.substring(8)),r?.startsWith("ssh ")?r=r.substring(4):r?.startsWith("ssh.exe ")&&(r=r.substring(8)),n?.startsWith("ssh ")?n=n.substring(4):n?.startsWith("ssh.exe ")&&(n=n.substring(8)),new f.default(i,r,n?parseInt(n,10):void 0)}async ensureServerIsConnected(e){const t=this.execServer,s=this.localCodePort;if(void 0===s)throw new Error("Local code port is not set");for(let t=0;t<3;t++){let r;const i=s.address.includes(":")?`[${s.address}]:${s.port}`:`${s.address}:${s.port}`;try{if(200===(await fetch(`http://${i}/version`,{signal:e})).status){this.logger.info(`Successfully connected to Cursor server at http://${i}/version`);break}}catch(e){r=e}if(this.logger.error(`Failed to connect to Cursor server at http://${i}, attempt ${t+1} of 3`,r),2===t)throw new Error("Failed to connect to Cursor code server. Ensure that your remote host ssh config has 'AllowTcpForwarding yes' in '/etc/ssh/sshd_config'. Please check the logs and try reinstalling the server.");await new Promise(((t,s)=>{const r=setTimeout(t,1e3);e.addEventListener("abort",(()=>{s(new Error("Timeout while waiting for exec server to respond")),clearTimeout(r)}),{once:!0})}))}if(t){const{stdout:s}=await Promise.race([(0,I.checkOutputExecServer)(t,"echo",["1"]),new Promise(((t,s)=>{e.addEventListener("abort",(()=>{s(new Error("Timeout while waiting for exec server to respond"))}),{once:!0})}))]);if("1"!==s.trim())throw new Error(`Failed to connect to Cursor multiplex server (got '${s.trim()}'; expected '1'). Ensure that your remote host ssh config has 'AllowTcpForwarding yes' in '/etc/ssh/sshd_config'. Please check the logs and try reinstalling the server.`);this.logger.info("Successfully ran 'echo 1' against the multiplex server")}}async setupForwardingServers(e){const t=this.remoteServer;if(void 0===t)throw new Error("Remote server is not set");this.localCodePort=await this.setupForwardingServer("code",(()=>this.codeServerForwarding),(e=>this.codeServerForwarding=e),(()=>this.remoteServer?.listeningOn),e),this.logger.info(`[remote-ssh] codeListeningOn (remote=${t.listeningOn?.address}:${t.listeningOn?.port}; local=${this.localCodePort.address}:${this.localCodePort.port}) codeConnectionToken: ${t.codeConnectionToken}`);const s=void 0===t.multiplexListeningOn?void 0:await this.setupForwardingServer("multiplex",(()=>this.multiplexForwarding),(e=>this.multiplexForwarding=e),(()=>this.remoteServer?.multiplexListeningOn),e);let r;if(void 0!==s&&void 0!==t.multiplexConnectionToken){this.logger.info(`[remote-ssh] multiplexListeningOn (remote=${t.multiplexListeningOn}; local=${s}) multiplexConnectionToken: ${t.multiplexConnectionToken}`);const e=Math.min(1e3*Math.floor(d.workspace.getConfiguration("remote.SSH").get("serverShutdownTimeout",60)/4),6e4),i=new b.SSHCommandServer(s,t.multiplexConnectionToken,this.logger,t.envVars,t.remoteNodeExecutable,e);this.commandServer?.dispose(),this.commandServer=i,r=new R.ExecServer(i,t.platform,this.logger,(()=>void 0===this.remoteServer?void 0:{port:this.remoteServer.socksPort,address:this.remoteServer.socksAddress}))}this.execServer=r}makeResolvedAuthority(){if(void 0===this.remoteServer)throw new Error("Remote server must be set if connection is valid!");if(void 0===this.localCodePort)throw new Error("Local code port must be set if connection is valid!");{const e=new d.ResolvedAuthority(this.localCodePort.address,this.localCodePort.port,this.remoteServer.codeConnectionToken);return e.extensionHostEnv=this.remoteServer.envVars,this.logger.info(`[remote-ssh] Resolved authority: ${JSON.stringify(e)}. Socks port: ${this.remoteServer.socksPort}`),e}}async resolve(e,t){const s={stack:[],error:void 0,hasError:!1};try{if(!e.startsWith("ssh-remote+"))throw new Error(`Invalid authority format: ${e}`);let r;try{r=f.default.parseAuthorityNew(e.substring(11))}catch{r=this.oldParseAuthority(e)}this.logger.info(`Resolving ssh remote authority '${r}' (Unparsed '${e}') (attempt #${t.resolveAttempt})`);const i=d.workspace.getConfiguration("remote.SSH"),n=i.get("path","ssh"),o=(0,p.getSSHConfigPath)();let h=i.get("localServerDownload","auto");["off","auto","always"].includes(h)||(this.logger.error(`Invalid value for remote.SSH.localServerDownload. Must be one of: off, auto, always: ${h}`),h="auto");const l=1e3*i.get("connectTimeout",180),c=i.get("showLoginTerminal",!1),u=i.get("defaultExtensions",[]),S="trace"===i.get("logLevel"),E=a(s,(0,y.span)("cursor-remote-ssh.resolveAuthority"),!1);if(t.resolveAttempt>1){let e=!1;const t=new AbortController,s=setTimeout((()=>{t.abort()}),1e4);try{await Promise.race([(async()=>{try{this.logger.info("Received re-connection request; checking to see if existing connection is still valid"),await this.ensureServerIsConnected(t.signal),e=!0}catch(s){try{this.logger.error("Could not re-use existing SOCKS connection; attempting to re-establish SOCKS forwarding",s),await this.setupForwardingServers(t.signal),await this.ensureServerIsConnected(t.signal),e=!0}catch(e){this.logger.error("Could not re-establish SOCKS forwarding; re-establishing entire SSH connection",e)}}})(),new Promise(((e,s)=>{t.signal.addEventListener("abort",(()=>{s(new Error("Timeout while checking if existing connection is still valid"))}),{once:!0})}))])}catch(e){this.logger.error("Unexpected error while checking if existing connection is still valid",e)}finally{clearTimeout(s)}if(e)return this.logger.info("Reusing existing connection"),this.makeResolvedAuthority()}try{return await d.window.withProgress({location:d.ProgressLocation.Notification,title:"Setting up SSH Host ([details](command:opensshremotes.showLog))",cancellable:!0},((s,i)=>Promise.race([(async()=>{s.report({message:"Starting Remote SSH..."});const a=(await p.default.loadFromFS(this.logger,o)).getHostConfiguration(r.hostname),f=await this.setupAskpassServer(),w=new g.SSHConnectionFactory(this.logger,{sshPath:n,destination:r.toConnectionString(),host:r.hostname,sshConfigPath:o,showLoginTerminal:c,extensionPath:this.context.extensionPath});void 0!==this.remoteServer&&(this.logger.info("Terminating existing SSH process"),this.remoteServer.kill(),this.remoteServer=void 0);const v=this.context.globalState.get(C(e),!1),_=this.context.globalState.get(k(e),!1),{codeConnectionToken:y,kill:R,codeListeningOn:b,multiplexConnectionToken:O,multiplexListeningOn:I,envVars:$,socksPort:T,platform:P,remoteNodeExecutable:A}=await(0,m.installCodeServer)({conn:w,logger:this.logger,remoteCommand:a.RemoteCommand,extensionFolder:this.context.extensionPath,timeoutMs:l,verbose:S,forceReinstall:v,localServerDownload:h,resolveAttempt:t.resolveAttempt,defaultExtensions:u,context:this.context,askpassHandle:f,progress:s,cancellationToken:i,killRunningServers:_,askpassStartedEvent:this.askpassStartedEventEmitter.event,askpassFinishedEvent:this.askpassFinishedEventEmitter.event});this.remoteServer={kill:R,listeningOn:{port:b,address:"127.0.0.1"},multiplexListeningOn:void 0!==I?{port:I,address:"127.0.0.1"}:void 0,codeConnectionToken:y,socksAddress:"127.0.0.1",socksPort:T,multiplexConnectionToken:O,envVars:$,remoteNodeExecutable:A,platform:P},await this.setupForwardingServers(void 0),this.logger.info(`[remote-ssh] Resolved exec server. Socks port: ${T}`),void 0!==this.labelFormatterDisposable&&this.labelFormatterDisposable.dispose(),this.labelFormatterDisposable=d.workspace.registerResourceLabelFormatter({scheme:"vscode-remote",authority:`${e}*`,formatting:{label:"${path}",separator:"/",tildify:!0,workspaceSuffix:`SSH: ${r.hostname}`}}),this.context.environmentVariableCollection.persistent=!1;for(const[e,t]of Object.entries($))this.logger.info(`[remote-ssh] Setting environment variable ${e}=${t}`),d.env.remoteAuthority?.startsWith("ssh-remote+")||"SSH_AUTH_SOCK"!==e?this.context.environmentVariableCollection.replace(e,t):this.logger.info("[remote-ssh] Skipping SSH_AUTH_SOCK for non-ssh-remote authority");await this.setupDefaultForwardedPorts();const L=this.makeResolvedAuthority();return await this.context.globalState.update(C(e),void 0),await this.context.globalState.update(k(e),void 0),E.setAttribute("success",!0),L})(),new Promise(((e,t)=>{i.isCancellationRequested?t(new Error("Cancelled")):i.onCancellationRequested((()=>{t(new Error("Cancelled"))}))}))])))}catch(t){E.setAttribute("success",!1);const s=t instanceof Error?t.message:String(t);E.setError(s),this.logger.error("Error resolving SSH authority",t),this.logger.show();const r=async()=>{const i="Reload Window",n="More Options",o="Copy Logs",a=await d.window.showErrorMessage(`Connection to Cursor server failed: ${s}`,i,o,n);if(a===i)this.logger.info("Reloading window"),await d.commands.executeCommand("workbench.action.reloadWindow");else if(a===o)await d.env.clipboard.writeText(this.logger.getBufferedText()),d.window.showInformationMessage("Logs copied to clipboard"),await r();else if(a===n){const t=[i],s="Reinstall Server";t.push(s);const n="Open SSH Config";t.push(n),t.push(o);const a=await d.window.showQuickPick(t);a===i?(this.logger.info("Reloading window"),await d.commands.executeCommand("workbench.action.reloadWindow")):a===s?(await this.context.globalState.update(C(e),!0),await d.commands.executeCommand("workbench.action.reloadWindow")):a===n?(await d.commands.executeCommand("opensshremotes.openConfigFile"),await r()):a===o&&(await d.env.clipboard.writeText(this.logger.getBufferedText()),d.window.showInformationMessage("Logs copied to clipboard"),await r())}throw d.RemoteAuthorityResolverError.NotAvailable(t.message,!0)};return await r()}}catch(e){s.error=e,s.hasError=!0}finally{h(s)}}async resolveExecServer(e,t){if(t.execServer)throw new Error("Nested exec servers over SSH are not supported. Instead, please use jump hosts via the SSH config.");if(void 0!==this.remoteServer&&void 0===this.execServer)throw new Error("Windows SSH hosts are not supported for intermediate resolvers (1)");if(0===t.resolveAttempt&&void 0!==this.execServer)return this.logger.info("[remote-ssh][resolveExecServer] Returning exec server from initial connection"),this.execServer;if(this.logger.info("[remote-ssh][resolveExecServer] Resolving connection"),await this.resolve(e,t),void 0===this.execServer)throw new Error("Windows SSH hosts are not supported for intermediate resolvers (2)");return this.logger.info("[remote-ssh][resolveExecServer] Returning exec server from newly resolved connection"),this.execServer}async setupDefaultForwardedPorts(){const e=d.workspace.getConfiguration("remote.SSH").get("defaultForwardedPorts",[]);this.logger.info(`Setting up ${e.length} default forwarded ports`);for(const t of e)try{this.logger.info(`Creating tunnel for localhost:${t.remotePort}${t.localPort?` (local: ${t.localPort})`:""}${t.name?` - ${t.name}`:""}`);const e={remoteAddress:{port:t.remotePort,host:"localhost"},label:t.name,localAddressPort:t.localPort??t.remotePort};d.workspace.openTunnel(e).then((e=>{if("string"==typeof e.localAddress)throw new Error(`Unexpected socket for local address: ${e.localAddress}`);this.logger.info(`Successfully created tunnel: ${e.localAddress.host}:${e.localAddress.port} -> ${e.remoteAddress.host}:${e.remoteAddress.port}`),this.defaultTunnels.push(e)}),(e=>{this.logger.error(`Failed to create tunnel for ${JSON.stringify(t)}: ${e}`)}))}catch(e){this.logger.error(`Failed to create tunnel for ${JSON.stringify(t)}: ${e}`)}}async killForwardingServers(){this.remoteServer?.kill(),await Promise.all([new Promise(((e,t)=>{void 0!==this.codeServerForwarding?this.codeServerForwarding.close((s=>{this.logger.info("[forwarding] code server forwarding closed"),this.codeServerForwarding=void 0,s?t(s):e()})):e()})),new Promise(((e,t)=>{void 0!==this.multiplexForwarding?this.multiplexForwarding.close((s=>{this.logger.info("[forwarding] multiplex forwarding closed"),this.multiplexForwarding=void 0,s?t(s):e()})):e()}))]),this.defaultTunnels.forEach((e=>{try{e.dispose()}catch(e){this.logger.error(`Error disposing tunnel: ${e}`)}})),this.defaultTunnels=[]}dispose(){this.labelFormatterDisposable?.dispose(),this.remoteServer?.kill(),void 0!==this.askpassServer&&this.askpassServer.close((()=>{this.logger.info("Askpass server closed")})),this.codeServerForwarding?.close((()=>{this.logger.info("[forwarding] code server forwarding closed")})),this.multiplexForwarding?.close((()=>{this.logger.info("[forwarding] multiplex forwarding closed")})),this.askpassStartedEventEmitter.dispose(),this.askpassFinishedEventEmitter.dispose(),this.commandServer?.dispose(),this.defaultTunnels.forEach((e=>{try{e.dispose()}catch(e){this.logger.error(`Error disposing tunnel: ${e}`)}})),this.defaultTunnels=[]}}},4089:(e,t,s)=>{"use strict";const r=s(560);e.exports=(e,t,s)=>r(e,t,s)>=0},4277:(e,t,s)=>{"use strict";const r=s(909);e.exports=(e,t)=>e.sort(((e,s)=>r(s,e,t)))},4394:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteLocationHistory=void 0,t.getRemoteWorkspaceLocationData=function(){let e=h.workspace.workspaceFile;if(e&&"vscode-remote"===e.scheme&&e.authority.startsWith(l.REMOTE_SSH_AUTHORITY)&&e.path.endsWith(".code-workspace")){const[,t]=e.authority.split("+");return[c.default.parseEncoded(t).hostname,e.path]}if(e=h.workspace.workspaceFolders?.[0].uri,e&&"vscode-remote"===e.scheme&&e.authority.startsWith(l.REMOTE_SSH_AUTHORITY)){const[,t]=e.authority.split("+");return[c.default.parseEncoded(t).hostname,e.path]}};const h=o(s(1398)),l=s(4001),c=a(s(4576));class u{static{this.STORAGE_KEY="remoteLocationHistory_v0"}constructor(e){this.context=e,this.remoteLocationHistory={},this.remoteLocationHistory=e.globalState.get(u.STORAGE_KEY)||{}}getHistory(e){return this.remoteLocationHistory[e]||[]}async addLocation(e,t){let s=this.remoteLocationHistory[e]||[];s.includes(t)||(s.unshift(t),this.remoteLocationHistory[e]=s,await this.context.globalState.update(u.STORAGE_KEY,this.remoteLocationHistory))}async removeLocation(e,t){let s=this.remoteLocationHistory[e]||[];s=s.filter((e=>e!==t)),this.remoteLocationHistory[e]=s,await this.context.globalState.update(u.STORAGE_KEY,this.remoteLocationHistory)}}t.RemoteLocationHistory=u},4434:e=>{"use strict";e.exports=require("events")},4493:(e,t,s)=>{"use strict";const r=s(3908);e.exports=(e,t)=>new r(e,t).patch},4576:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e,t,s){this.hostname=e,this.user=t,this.port=s}static parse(e){let t;const r=e.lastIndexOf("@");let i;-1!==r&&(t=e.substring(0,r));const n=e.lastIndexOf(":");-1!==n&&(i=parseInt(e.substring(n+1),10));const o=-1!==r?r+1:0,a=-1!==n?n:e.length,h=e.substring(o,a);return new s(h,t,i)}toConnectionString(){let e=this.hostname;return this.user&&(e=`${this.user}@${e}`),this.port&&(e=`-p ${this.port} ${e}`),e}toString(){let e=this.hostname;return this.user&&(e=`${this.user}@`+e),this.port&&(e+=`:${this.port}`),e}static parseAuthorityNew(e){const t=JSON.parse(Buffer.from(e,"hex").toString());return new s(t.hostName,t.user,t.port)}static parseEncoded(e){try{return s.parseAuthorityNew(e)}catch{}return s.parse(e.replace(/\\x([0-9a-f]{2})/g,((e,t)=>String.fromCharCode(parseInt(t,16)))))}toEncodedString(){return Buffer.from(JSON.stringify({hostName:this.hostname,user:this.user,port:this.port})).toString("hex")}}t.default=s},4600:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.activate=async function(e){const t=(0,p.createBufferedLogOutputChannel)("Remote - SSH");e.subscriptions.push(t);const s="ms-vscode-remote.remote-ssh",r="Anysphere Remote SSH";return await(0,d.runInSpan)("cursor-remote-ssh.activate",(async()=>{if(void 0!==a.extensions.getExtension(s)){const e="Uninstall & Restart Cursor",t="Ignore";if(await a.window.showWarningMessage(`In order to use ${r}, \`${s}\` must be uninstalled.`,e,t)!==e)throw a.window.showInformationMessage(`${r} has been disabled for this session.`),new Error(`${r} has been disabled for this session`);a.commands.executeCommand("workbench.extensions.uninstallExtension",s).then((()=>a.commands.executeCommand("workbench.action.reloadWindow")),(()=>a.commands.executeCommand("workbench.action.reloadWindow")))}if(a.env.remoteAuthority?.startsWith("ssh-remote")){let t,s,r=!1;const i=()=>{const i=a.workspace.getConfiguration("remote.SSH").get("showTrafficMonitor",!0);i&&!t?(t=a.window.createStatusBarItem(a.StatusBarAlignment.Right,Number.MAX_VALUE-1),t.backgroundColor=new a.ThemeColor("statusBar.debuggingForeground"),t.text="SSH: 0↑/0↓",t.tooltip="Click to view SSH traffic graphs\n\nThis status bar item can be hidden via Settings > Remote SSH > Show Traffic Monitor",t.command="opensshremotes.showTrafficGraph",t.show(),s=(0,m.onTrafficSnapshot)((({upBps:e,downBps:s})=>{const r=e=>e>1e6?`${(e/1e6).toFixed(1)} MB/s`:e>1e3?`${(e/1e3).toFixed(0)} kB/s`:`${e.toFixed(0)} B/s`;t&&(t.text=`SSH: ${r(e)}↑ ${r(s)}↓`)})),r||((0,m.startTrafficMonitor)(1500),r=!0),e.subscriptions.push(t),e.subscriptions.push(s)):!i&&t&&(t.dispose(),t=void 0,s&&(s.dispose(),s=void 0))};i(),e.subscriptions.push(a.workspace.onDidChangeConfiguration((e=>{e.affectsConfiguration("remote.SSH.showTrafficMonitor")&&i()})))}e.subscriptions.push(a.commands.registerCommand("opensshremotes.showTrafficGraph",(()=>{g.TrafficGraphPanel.show(e)})));const i=new h.RemoteSSHResolver(e,t);e.subscriptions.push(a.workspace.registerRemoteAuthorityResolver(h.REMOTE_SSH_AUTHORITY,i)),e.subscriptions.push(i);const n=new u.RemoteLocationHistory(e),o=(0,u.getRemoteWorkspaceLocationData)();o&&await n.addLocation(o[0],o[1]);const d=new c.HostTreeDataProvider(n,t);e.subscriptions.push(a.window.createTreeView("sshHosts",{treeDataProvider:d})),e.subscriptions.push(d),e.subscriptions.push(a.commands.registerCommand("opensshremotes.openEmptyWindow",(()=>(0,l.promptOpenRemoteSSHWindow)(!1,e,t)))),e.subscriptions.push(a.commands.registerCommand("opensshremotes.openEmptyWindowInCurrentWindow",(()=>(0,l.promptOpenRemoteSSHWindow)(!0,e,t)))),e.subscriptions.push(a.commands.registerCommand("opensshremotes.openConfigFile",(()=>(0,l.openSSHConfigFile)()))),e.subscriptions.push(a.commands.registerCommand("opensshremotes.showLog",(()=>t.show()))),e.subscriptions.push(a.commands.registerCommand("opensshremotes.killServerAndReload",(async()=>{void 0!==a.env.remoteAuthority?(await e.globalState.update((0,h.getKillRunningServersKey)(a.env.remoteAuthority),!0),await a.commands.executeCommand("workbench.action.reloadWindow")):await a.window.showErrorMessage("No remote authority found")}))),e.subscriptions.push(a.commands.registerCommand("opensshremotes.reinstallServerAndReload",(async()=>{void 0!==a.env.remoteAuthority?(await e.globalState.update((0,h.getReinstallKey)(a.env.remoteAuthority),!0),await a.commands.executeCommand("workbench.action.reloadWindow")):await a.window.showErrorMessage("No remote authority found")}))),e.subscriptions.push(a.commands.registerCommand("opensshremotes.triggerReconnect",(async()=>{void 0!==a.env.remoteAuthority?await i.killForwardingServers():await a.window.showErrorMessage("No remote authority found")}))),e.subscriptions.push(a.commands.registerCommand("opensshremotes.generateConnectionReport",(()=>(0,f.generateConnectionReport)(e,t))))}))},t.deactivate=function(){(0,m.stopTrafficMonitor)()};const a=o(s(1398)),h=s(4001),l=s(5187),c=s(6906),u=s(4394),d=s(2357),f=s(8431),p=s(6571),m=s(1615),g=s(6891)},4615:(e,t,s)=>{"use strict";const{Transform:r}=s(2203),{StringDecoder:i}=s(3193),n=Symbol("last"),o=Symbol("decoder");function a(e,t,s){let r;if(this.overflow){if(r=this[o].write(e).split(this.matcher),1===r.length)return s();r.shift(),this.overflow=!1}else this[n]+=this[o].write(e),r=this[n].split(this.matcher);this[n]=r.pop();for(let e=0;e<r.length;e++)try{l(this,this.mapper(r[e]))}catch(e){return s(e)}this.overflow=this[n].length>this.maxLength,!this.overflow||this.skipOverflow?s():s(new Error("maximum buffer reached"))}function h(e){if(this[n]+=this[o].end(),this[n])try{l(this,this.mapper(this[n]))}catch(t){return e(t)}e()}function l(e,t){void 0!==t&&e.push(t)}function c(e){return e}e.exports=function(e,t,s){switch(e=e||/\r?\n/,t=t||c,s=s||{},arguments.length){case 1:"function"==typeof e?(t=e,e=/\r?\n/):"object"!=typeof e||e instanceof RegExp||e[Symbol.split]||(s=e,e=/\r?\n/);break;case 2:"function"==typeof e?(s=t,t=e,e=/\r?\n/):"object"==typeof t&&(s=t,t=c)}(s=Object.assign({},s)).autoDestroy=!0,s.transform=a,s.flush=h,s.readableObjectMode=!0;const l=new r(s);return l[n]="",l[o]=new i("utf8"),l.matcher=e,l.mapper=t,l.maxLength=s.maxLength,l.skipOverflow=s.skipOverflow||!1,l.overflow=!1,l._destroy=function(e,t){this._writableState.errorEmitted=!1,t(e)},l}},4641:(e,t,s)=>{"use strict";const r=s(560);e.exports=(e,t,s)=>0===r(e,t,s)},4758:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pattern=void 0;const r=s(5551);class i{#p;#m;#g;length;#S;#E;#w;#v;#_;#y;#R=!0;constructor(e,t,s,r){if(!(e.length>=1))throw new TypeError("empty pattern list");if(!(t.length>=1))throw new TypeError("empty glob list");if(t.length!==e.length)throw new TypeError("mismatched pattern list and glob list lengths");if(this.length=e.length,s<0||s>=this.length)throw new TypeError("index out of range");if(this.#p=e,this.#m=t,this.#g=s,this.#S=r,0===this.#g)if(this.isUNC()){const[e,t,s,r,...i]=this.#p,[n,o,a,h,...l]=this.#m;""===i[0]&&(i.shift(),l.shift());const c=[e,t,s,r,""].join("/"),u=[n,o,a,h,""].join("/");this.#p=[c,...i],this.#m=[u,...l],this.length=this.#p.length}else if(this.isDrive()||this.isAbsolute()){const[e,...t]=this.#p,[s,...r]=this.#m;""===t[0]&&(t.shift(),r.shift());const i=e+"/",n=s+"/";this.#p=[i,...t],this.#m=[n,...r],this.length=this.#p.length}}pattern(){return this.#p[this.#g]}isString(){return"string"==typeof this.#p[this.#g]}isGlobstar(){return this.#p[this.#g]===r.GLOBSTAR}isRegExp(){return this.#p[this.#g]instanceof RegExp}globString(){return this.#w=this.#w||(0===this.#g?this.isAbsolute()?this.#m[0]+this.#m.slice(1).join("/"):this.#m.join("/"):this.#m.slice(this.#g).join("/"))}hasMore(){return this.length>this.#g+1}rest(){return void 0!==this.#E?this.#E:this.hasMore()?(this.#E=new i(this.#p,this.#m,this.#g+1,this.#S),this.#E.#y=this.#y,this.#E.#_=this.#_,this.#E.#v=this.#v,this.#E):this.#E=null}isUNC(){const e=this.#p;return void 0!==this.#_?this.#_:this.#_="win32"===this.#S&&0===this.#g&&""===e[0]&&""===e[1]&&"string"==typeof e[2]&&!!e[2]&&"string"==typeof e[3]&&!!e[3]}isDrive(){const e=this.#p;return void 0!==this.#v?this.#v:this.#v="win32"===this.#S&&0===this.#g&&this.length>1&&"string"==typeof e[0]&&/^[a-z]:$/i.test(e[0])}isAbsolute(){const e=this.#p;return void 0!==this.#y?this.#y:this.#y=""===e[0]&&e.length>1||this.isDrive()||this.isUNC()}root(){const e=this.#p[0];return"string"==typeof e&&this.isAbsolute()&&0===this.#g?e:""}checkFollowGlobstar(){return!(0===this.#g||!this.isGlobstar()||!this.#R)}markFollowGlobstar(){return!(0===this.#g||!this.isGlobstar()||!this.#R||(this.#R=!1,0))}}t.Pattern=i},4892:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ignore=void 0;const r=s(5551),i=s(4758),n="object"==typeof process&&process&&"string"==typeof process.platform?process.platform:"linux";t.Ignore=class{relative;relativeChildren;absolute;absoluteChildren;constructor(e,{nobrace:t,nocase:s,noext:o,noglobstar:a,platform:h=n}){this.relative=[],this.absolute=[],this.relativeChildren=[],this.absoluteChildren=[];const l={dot:!0,nobrace:t,nocase:s,noext:o,noglobstar:a,optimizationLevel:2,platform:h,nocomment:!0,nonegate:!0};for(const t of e){const e=new r.Minimatch(t,l);for(let t=0;t<e.set.length;t++){const s=e.set[t],n=e.globParts[t],o=new i.Pattern(s,n,0,h),a=new r.Minimatch(o.globString(),l),c="**"===n[n.length-1],u=o.isAbsolute();u?this.absolute.push(a):this.relative.push(a),c&&(u?this.absoluteChildren.push(a):this.relativeChildren.push(a))}}}ignored(e){const t=e.fullpath(),s=`${t}/`,r=e.relative()||".",i=`${r}/`;for(const e of this.relative)if(e.match(r)||e.match(i))return!0;for(const e of this.absolute)if(e.match(t)||e.match(s))return!0;return!1}childrenIgnored(e){const t=e.fullpath()+"/",s=(e.relative()||".")+"/";for(const e of this.relativeChildren)if(e.match(s))return!0;for(const e of this.absoluteChildren)e.match(t);return!1}}},4946:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.SSHCommandServer=void 0;const a=o(s(1398)),h=o(s(9278)),l=o(s(4615)),c=o(s(6982));t.SSHCommandServer=class{constructor(e,t,s,r,i,n){this.remoteServer=e,this.token=t,this.logger=s,this.envVars=r,this.remoteNodePath=i,this.pingIntervalMs=n,this.disposed=!1,this.pingUntilShutdown()}async pingUntilShutdown(){for(;!this.disposed;){this.logger.info(`[remote-ssh] Pinging remote server via ${this.remoteServer.address}:${this.remoteServer.port}...`);try{await this.checkOutput("echo",["1"])}catch(e){this.logger.warn(`[remote-ssh] Failed to ping remote server via ${this.remoteServer.address}:${this.remoteServer.port}: ${e}`)}await new Promise((e=>setTimeout(e,this.pingIntervalMs)))}}spawn(e,t,s){return new Promise(((r,i)=>{const n=c.randomUUID(),o=h.createConnection(this.remoteServer.port,this.remoteServer.address,(()=>{const i={...this.envVars,...s?.env};delete i.ARGV0,"node"===e&&(e=this.remoteNodePath);const h={command:e,args:t,env:i,cwd:s?.cwd,token:this.token,id:n};this.logger.info(`[command][${n}] Sending command request: ${JSON.stringify(h)}`),o.write(JSON.stringify(h)+"\n");const c=new a.EventEmitter,u=new a.EventEmitter;let d,f;const p=new Promise(((e,t)=>{d=e,f=t}));let m;const g=new Promise((e=>{m=e}));let S;const E=new Promise((e=>{S=e})),w=l.default();o.pipe(w),w.on("data",(e=>{try{const t=JSON.parse(e);if("stdout"===t.type&&void 0!==t.data){const e=Buffer.from(t.data,"base64");c.fire(new Uint8Array(e))}else if("stderr"===t.type&&void 0!==t.data){const e=Buffer.from(t.data,"base64");u.fire(new Uint8Array(e))}else if("exit"===t.type)this.logger.info(`[command][${n}] Process exited with code ${t.code||0}`),d({status:t.code||0}),m(),S(),o.end(),o.destroy();else if("stdout-end"===t.type)m();else{if("stderr-end"!==t.type)throw new Error(`[command][${n}] Unexpected response: ${e}`);S()}}catch(t){this.logger.error(`[command][${n}] Error parsing ${e}: ${t}`),f(t),o.destroy()}})),o.on("close",(()=>{this.logger.info(`[command][${n}] Socket close event received`),m(),S(),f(new Error(`[command][${n}] Socket closed without exit code`))})),o.on("end",(()=>{this.logger.info(`[command][${n}] Socket end event received`)})),r({stdout:{onDidReceiveMessage:c.event,onEnd:g},stderr:{onDidReceiveMessage:u.event,onEnd:E},onExit:p,stdin:{write:e=>!o.destroyed&&(o.write(Buffer.from(e).toString("base64")),!0),end:()=>{this.logger.info(`[command][${n}] Stdin end`),o.write(Buffer.from([0]))}}})}));o.on("error",(e=>{this.logger.error(`[command][${n}] Socket error: ${e}`),i(e)}))}))}async checkOutput(e,t,s){const r=await this.spawn(e,t,s);let i="",n="";r.stdout.onDidReceiveMessage((e=>{const t=(new TextDecoder).decode(e);i+=t})),r.stderr.onDidReceiveMessage((e=>{const t=(new TextDecoder).decode(e);n+=t}));const o=await r.onExit;if(0!==o.status)throw new Error(`Command '${e} ${t?.join(" ")||""}' failed with exit code ${o.status}: stdout: ${i}, stderr: ${n}`);return i}dispose(){this.disposed=!0}}},5032:(e,t,s)=>{"use strict";const r=s(8311),i=s(3904),{ANY:n}=i,o=s(7638),a=s(560),h=[new i(">=0.0.0-0")],l=[new i(">=0.0.0")],c=(e,t,s)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===n){if(1===t.length&&t[0].semver===n)return!0;e=s.includePrerelease?h:l}if(1===t.length&&t[0].semver===n){if(s.includePrerelease)return!0;t=l}const r=new Set;let i,c,f,p,m,g,S;for(const t of e)">"===t.operator||">="===t.operator?i=u(i,t,s):"<"===t.operator||"<="===t.operator?c=d(c,t,s):r.add(t.semver);if(r.size>1)return null;if(i&&c){if(f=a(i.semver,c.semver,s),f>0)return null;if(0===f&&(">="!==i.operator||"<="!==c.operator))return null}for(const e of r){if(i&&!o(e,String(i),s))return null;if(c&&!o(e,String(c),s))return null;for(const r of t)if(!o(e,String(r),s))return!1;return!0}let E=!(!c||s.includePrerelease||!c.semver.prerelease.length)&&c.semver,w=!(!i||s.includePrerelease||!i.semver.prerelease.length)&&i.semver;E&&1===E.prerelease.length&&"<"===c.operator&&0===E.prerelease[0]&&(E=!1);for(const e of t){if(S=S||">"===e.operator||">="===e.operator,g=g||"<"===e.operator||"<="===e.operator,i)if(w&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===w.major&&e.semver.minor===w.minor&&e.semver.patch===w.patch&&(w=!1),">"===e.operator||">="===e.operator){if(p=u(i,e,s),p===e&&p!==i)return!1}else if(">="===i.operator&&!o(i.semver,String(e),s))return!1;if(c)if(E&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===E.major&&e.semver.minor===E.minor&&e.semver.patch===E.patch&&(E=!1),"<"===e.operator||"<="===e.operator){if(m=d(c,e,s),m===e&&m!==c)return!1}else if("<="===c.operator&&!o(c.semver,String(e),s))return!1;if(!e.operator&&(c||i)&&0!==f)return!1}return!(i&&g&&!c&&0!==f||c&&S&&!i&&0!==f||w||E)},u=(e,t,s)=>{if(!e)return t;const r=a(e.semver,t.semver,s);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},d=(e,t,s)=>{if(!e)return t;const r=a(e.semver,t.semver,s);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,s={})=>{if(e===t)return!0;e=new r(e,s),t=new r(t,s);let i=!1;e:for(const r of e.set){for(const e of t.set){const t=c(r,e,s);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},5187:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.showHostPicker=m,t.promptOpenRemoteSSHWindow=async function(e,t,s){const r=(0,u.getSSHConfigPath)(),i=await m(s,r);if(i)return await g(i.toEncodedString(),e)},t.openRemoteSSHWindow=g,t.openRemoteSSHLocationWindow=function(e,t,s){return h.commands.executeCommand("vscode.openFolder",h.Uri.from({scheme:"vscode-remote",authority:(0,c.getRemoteAuthority)(e),path:t}),{forceNewWindow:!s})},t.addNewHost=S,t.openSSHConfigFile=E;const h=o(s(1398)),l=o(s(9896)),c=s(4001),u=o(s(3256)),d=s(680),f=a(s(4576)),p=s(6928);async function m(e,t){const s=h.window.createQuickPick(),r={current:[]},i={current:void 0},n=[{label:"$(add) Add New SSH Host...",alwaysShow:!0},{label:"Configure SSH Hosts...",alwaysShow:!0}],o=()=>{s.items=[...r.current,...n,...i.current?[i.current]:[]]};u.default.loadFromFS(e,t).then((e=>{const t=e.getAllConfiguredHosts();r.current=t.map((e=>({label:e}))),o()})),s.placeholder="e.g. ubuntu@ec2-3-106-99.amazonaws.com, or named host below",s.title="Select configured SSH host or enter user@host",o();const a=[];try{return await new Promise(((e,t)=>{a.push(s.onDidChangeValue((e=>{e.length>0?i.current={label:`➤ ${e}`,alwaysShow:!0}:i.current=void 0,o()})),s.onDidAccept((async()=>{const t=s.selectedItems[0];if(!t)return void e(void 0);if(t.label===n[0].label)return await S(),s.hide(),void e(void 0);if(t.label===n[1].label)return await E(),s.hide(),void e(void 0);let r;r=i.current?.label===t.label?i.current.label.substr(2).trim():t.label,r=r.replaceAll("\\\\","\\").replaceAll("\\","\\\\");const o=new f.default(r);e(o),s.hide()})),s.onDidHide((()=>{e(void 0),s.dispose()}))),s.show()}))}finally{a.forEach((e=>e.dispose()))}}function g(e,t){return h.commands.executeCommand("vscode.newWindow",{remoteAuthority:(0,c.getRemoteAuthority)(e),reuseWindow:t})}async function S(){const e=(0,u.getSSHConfigPathOrDefault)();await(0,d.exists)(e)||(await l.promises.mkdir((0,p.dirname)(e),{recursive:!0}),await l.promises.writeFile(e,"")),await h.commands.executeCommand("vscode.open",h.Uri.file(e),{preview:!1});const t=h.window.activeTextEditor;if(t?.document.uri.fsPath!==e)return;const s=t.document,r=s.lineAt(s.lineCount-1);r.isEmptyOrWhitespace||await t.edit((e=>{e.insert(r.range.end,"\n")})),await t.insertSnippet(new h.SnippetString("\nHost ${1:dev}\n\tHostName ${2:dev.example.com}\n\tUser ${3:john}"),new h.Position(s.lineCount,0))}async function E(){const e=(0,u.getSSHConfigPathOrDefault)();await(0,d.exists)(e)||(await l.promises.mkdir((0,p.dirname)(e),{recursive:!0}),await l.promises.writeFile(e,"")),h.commands.executeCommand("vscode.open",h.Uri.file(e))}},5200:(e,t,s)=>{"use strict";const r=s(560);e.exports=(e,t,s)=>r(e,t,s)<=0},5303:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteFileSystem=void 0;const a=o(s(1398)),h=s(9449),l="Switch to Anysphere Remote Containers",c="Reload Window";t.RemoteFileSystem=class{constructor(e,t,s){this.commandServer=e,this.logger=t,this.platform=s}async stat(e){if(this.logger.info(`[remoteFileSystem][stat] path: ${e}`),e.includes("/cli/servers/Stable-")&&e.endsWith("/server/node"))throw a.window.showErrorMessage("The VSCode Remote Containers extension is not supported with the Anysphere Remote SSH extension. Please uninstall the VSCode Remote Containers extension and install the Anysphere Remote Containers extension instead.",l).then((async e=>{e===l&&(await a.commands.executeCommand("workbench.extensions.installExtension","anysphere.remote-containers"),await a.commands.executeCommand("workbench.extensions.uninstallExtension","ms-vscode-remote.remote-containers"),await a.window.showInformationMessage("Please reload Cursor to complete the installation of the Anysphere Remote Containers extension.",c)===c&&await a.commands.executeCommand("workbench.action.reloadWindow"))})).then(void 0,(e=>{this.logger.error(`Error switching to Anysphere Remote Containers: ${e}`)})),a.FileSystemError.FileNotFound(e);let t,s;if(this.platform===h.Platform.Linux)t="--format=%F,%s,%Y,%X,%W";else{if(this.platform!=h.Platform.MacOS)throw new Error(`Unsupported platform: ${this.platform}`);t="-f=%HT,%z,%m,%a,%B"}try{s=await this.commandServer.checkOutput("stat",[t,e])}catch(t){throw this.logger.error(`[remoteFileSystem][stat] Failed to stat file: ${t}`),a.FileSystemError.FileNotFound(e)}const[r,i,n,o,u]=s.trim().split(",");let d,f=r.toLowerCase();return d=f.includes("directory")?a.FileType.Directory:f.includes("symbolic link")?a.FileType.SymbolicLink:a.FileType.File,{type:d,size:parseInt(i),mtime:1e3*parseInt(n),ctime:1e3*parseInt(u)}}async mkdirp(e){this.logger.info(`[remoteFileSystem][mkdirp] path: ${e}`),await this.commandServer.checkOutput("mkdir",["-p",e])}async rm(e){this.logger.info(`[remoteFileSystem][rm] path: ${e}`),await this.commandServer.checkOutput("rm",["-rf",e])}async read(e){this.logger.info(`[remoteFileSystem][read] path: ${e}`);const t=await this.commandServer.spawn("cat",[e]),s=new a.EventEmitter;return t.stdout.onDidReceiveMessage((e=>{s.fire(e)})),{onDidReceiveMessage:s.event,onEnd:t.stdout.onEnd}}async write(e){this.logger.info(`[remoteFileSystem][write] path: ${e}`);const t=await this.commandServer.spawn("bash",["-c",`cat - > '${e}'`]);t.stderr.onDidReceiveMessage((e=>{this.logger.error(`[remoteFileSystem][write][stderr] ${Buffer.from(e).toString("utf-8")}`)})),t.stdout.onDidReceiveMessage((e=>{this.logger.error(`[remoteFileSystem][write][stdout] ${Buffer.from(e).toString("utf-8")}`)}));const s=new Promise(((e,s)=>{t.onExit.then((({status:t})=>{0===t?(this.logger.error("[remoteFileSystem][write] Finished writing file"),e()):(this.logger.error(`[remoteFileSystem][write] Failed to write to file. Exit code: ${t}`),s(new Error(`Failed to write to file. Exit code: ${t}`)))}),(e=>{this.logger.error("[remoteFileSystem][write] Failed to write to file",e),s(e)}))}));return{stream:t.stdin,done:s}}async connect(e){this.logger.info(`[remoteFileSystem][connect][${e}] connecting`);const t=`\nconst net = require('net');\nconst fs = require('fs');\nprocess.stdin.pause();\nconst client = net.createConnection({ path: '${e}'}, () => {\n\tconsole.error('Connection established');\n\tclient.pipe(process.stdout);\n\tprocess.stdin.pipe(client);\n});\nclient.on('close', function (hadError) {\n\tconsole.error(hadError ? 'Remote close with error' : 'Remote close');\n\tprocess.exit(hadError ? 1 : 0);\n});\nclient.on('error', function (err) {\n\tprocess.stderr.write(err && (err.stack || err.message) || String(err));\n});\nprocess.stdin.on('close', function (hadError) {\n\tconsole.error(hadError ? 'Remote stdin close with error' : 'Remote stdin close');\n\tprocess.exit(hadError ? 1 : 0);\n});\nprocess.on('uncaughtException', function (err) {\n\tfs.writeSync(process.stderr.fd, 'error: ' + (err.stack || err.message) + '\\n');\n\tprocess.exit(1);\n});`,{stdin:s,stdout:r,stderr:i,onExit:n}=await this.commandServer.spawn("node",["-e",t]);return i.onDidReceiveMessage((t=>{this.logger.error(`[remoteFileSystem][connect][${e}] stderr: ${Buffer.from(t).toString("utf-8")}`)})),{stream:{write:e=>s.write(e),end:()=>s.end(),onDidReceiveMessage:r.onDidReceiveMessage,onEnd:r.onEnd},done:new Promise(((t,s)=>{n.then((r=>{if(0!==r.status)return this.logger.error(`[remoteFileSystem][connect][${e}] Socket exited with status: ${r.status}: ${r.message}`),void s(new Error(`[remoteFileSystem][connect][${e}] Socket exited with status: ${r.status}: ${r.message}`));t()}),(e=>{s(e)}))}))}}async rename(e,t){this.logger.info(`[remoteFileSystem][rename] fromPath: ${e}, toPath: ${t}`),await this.commandServer.checkOutput("mv",[e,t])}async readdir(e){this.logger.info(`[remoteFileSystem][readdir] path: ${e}`);const t=(await this.commandServer.checkOutput("ls",["-la",e])).split("\n").slice(1),s=[];for(const e of t){if(""===e.trim())continue;const t=e.trim().split(/\s+/),r=t[t.length-1];if("."===r||".."===r)continue;let i=a.FileType.File;t[0].startsWith("d")?i=a.FileType.Directory:t[0].startsWith("l")&&(i=a.FileType.SymbolicLink),s.push({name:r,type:i})}return s}}},5317:e=>{"use strict";e.exports=require("child_process")},5342:(e,t,s)=>{"use strict";const r=s(9456);e.exports=(e,t,s)=>r(e,t,"<",s)},5438:(e,t)=>{"use strict";var s,r,i,n,o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.SOCKS5_NO_ACCEPTABLE_AUTH=t.SOCKS5_CUSTOM_AUTH_END=t.SOCKS5_CUSTOM_AUTH_START=t.SOCKS_INCOMING_PACKET_SIZES=t.SocksClientState=t.Socks5Response=t.Socks5HostType=t.Socks5Auth=t.Socks4Response=t.SocksCommand=t.ERRORS=t.DEFAULT_TIMEOUT=void 0,t.DEFAULT_TIMEOUT=3e4,t.ERRORS={InvalidSocksCommand:"An invalid SOCKS command was provided. Valid options are connect, bind, and associate.",InvalidSocksCommandForOperation:"An invalid SOCKS command was provided. Only a subset of commands are supported for this operation.",InvalidSocksCommandChain:"An invalid SOCKS command was provided. Chaining currently only supports the connect command.",InvalidSocksClientOptionsDestination:"An invalid destination host was provided.",InvalidSocksClientOptionsExistingSocket:"An invalid existing socket was provided. This should be an instance of stream.Duplex.",InvalidSocksClientOptionsProxy:"Invalid SOCKS proxy details were provided.",InvalidSocksClientOptionsTimeout:"An invalid timeout value was provided. Please enter a value above 0 (in ms).",InvalidSocksClientOptionsProxiesLength:"At least two socks proxies must be provided for chaining.",InvalidSocksClientOptionsCustomAuthRange:"Custom auth must be a value between 0x80 and 0xFE.",InvalidSocksClientOptionsCustomAuthOptions:"When a custom_auth_method is provided, custom_auth_request_handler, custom_auth_response_size, and custom_auth_response_handler must also be provided and valid.",NegotiationError:"Negotiation error",SocketClosed:"Socket closed",ProxyConnectionTimedOut:"Proxy connection timed out",InternalError:"SocksClient internal error (this should not happen)",InvalidSocks4HandshakeResponse:"Received invalid Socks4 handshake response",Socks4ProxyRejectedConnection:"Socks4 Proxy rejected connection",InvalidSocks4IncomingConnectionResponse:"Socks4 invalid incoming connection response",Socks4ProxyRejectedIncomingBoundConnection:"Socks4 Proxy rejected incoming bound connection",InvalidSocks5InitialHandshakeResponse:"Received invalid Socks5 initial handshake response",InvalidSocks5IntiailHandshakeSocksVersion:"Received invalid Socks5 initial handshake (invalid socks version)",InvalidSocks5InitialHandshakeNoAcceptedAuthType:"Received invalid Socks5 initial handshake (no accepted authentication type)",InvalidSocks5InitialHandshakeUnknownAuthType:"Received invalid Socks5 initial handshake (unknown authentication type)",Socks5AuthenticationFailed:"Socks5 Authentication failed",InvalidSocks5FinalHandshake:"Received invalid Socks5 final handshake response",InvalidSocks5FinalHandshakeRejected:"Socks5 proxy rejected connection",InvalidSocks5IncomingConnectionResponse:"Received invalid Socks5 incoming connection response",Socks5ProxyRejectedIncomingBoundConnection:"Socks5 Proxy rejected incoming bound connection"},t.SOCKS_INCOMING_PACKET_SIZES={Socks5InitialHandshakeResponse:2,Socks5UserPassAuthenticationResponse:2,Socks5ResponseHeader:5,Socks5ResponseIPv4:10,Socks5ResponseIPv6:22,Socks5ResponseHostname:e=>e+7,Socks4Response:8},function(e){e[e.connect=1]="connect",e[e.bind=2]="bind",e[e.associate=3]="associate"}(s||(t.SocksCommand=s={})),function(e){e[e.Granted=90]="Granted",e[e.Failed=91]="Failed",e[e.Rejected=92]="Rejected",e[e.RejectedIdent=93]="RejectedIdent"}(r||(t.Socks4Response=r={})),function(e){e[e.NoAuth=0]="NoAuth",e[e.GSSApi=1]="GSSApi",e[e.UserPass=2]="UserPass"}(i||(t.Socks5Auth=i={})),t.SOCKS5_CUSTOM_AUTH_START=128,t.SOCKS5_CUSTOM_AUTH_END=254,t.SOCKS5_NO_ACCEPTABLE_AUTH=255,function(e){e[e.Granted=0]="Granted",e[e.Failure=1]="Failure",e[e.NotAllowed=2]="NotAllowed",e[e.NetworkUnreachable=3]="NetworkUnreachable",e[e.HostUnreachable=4]="HostUnreachable",e[e.ConnectionRefused=5]="ConnectionRefused",e[e.TTLExpired=6]="TTLExpired",e[e.CommandNotSupported=7]="CommandNotSupported",e[e.AddressNotSupported=8]="AddressNotSupported"}(n||(t.Socks5Response=n={})),function(e){e[e.IPv4=1]="IPv4",e[e.Hostname=3]="Hostname",e[e.IPv6=4]="IPv6"}(o||(t.Socks5HostType=o={})),function(e){e[e.Created=0]="Created",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected",e[e.SentInitialHandshake=3]="SentInitialHandshake",e[e.ReceivedInitialHandshakeResponse=4]="ReceivedInitialHandshakeResponse",e[e.SentAuthentication=5]="SentAuthentication",e[e.ReceivedAuthenticationResponse=6]="ReceivedAuthenticationResponse",e[e.SentFinalHandshake=7]="SentFinalHandshake",e[e.ReceivedFinalResponse=8]="ReceivedFinalResponse",e[e.BoundWaitingForConnection=9]="BoundWaitingForConnection",e[e.Established=10]="Established",e[e.Disconnected=11]="Disconnected",e[e.Error=99]="Error"}(a||(t.SocksClientState=a={}))},5551:function(e,t,s){"use strict";const r=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(s(2608));e.exports=Object.assign(r.default,{default:r.default,minimatch:r.default})},5571:(e,t,s)=>{"use strict";const r=s(9456);e.exports=(e,t,s)=>r(e,t,">",s)},5580:(e,t,s)=>{"use strict";const r=s(560);e.exports=(e,t,s)=>r(e,t,s)>0},5861:function(e,t,s){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),i=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||r(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),i(s(7631),t)},6170:(e,t,s)=>{"use strict";const r=s(3908),i=s(144),{safeRe:n,t:o}=s(9718);e.exports=(e,t)=>{if(e instanceof r)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let s=null;if((t=t||{}).rtl){const r=t.includePrerelease?n[o.COERCERTLFULL]:n[o.COERCERTL];let i;for(;(i=r.exec(e))&&(!s||s.index+s[0].length!==e.length);)s&&i.index+i[0].length===s.index+s[0].length||(s=i),r.lastIndex=i.index+i[1].length+i[2].length;r.lastIndex=-1}else s=e.match(t.includePrerelease?n[o.COERCEFULL]:n[o.COERCE]);if(null===s)return null;const a=s[2],h=s[3]||"0",l=s[4]||"0",c=t.includePrerelease&&s[5]?`-${s[5]}`:"",u=t.includePrerelease&&s[6]?`+${s[6]}`:"";return i(`${a}.${h}.${l}${c}${u}`,t)}},6193:e=>{"use strict";e.exports=require("node:string_decoder")},6254:(e,t,s)=>{"use strict";const r=s(3908);e.exports=(e,t)=>new r(e,t).minor},6329:function(e,t,s){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&r(t,e,s);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Address6=void 0;const o=n(s(837)),a=n(s(9576)),h=n(s(8914)),l=n(s(2846)),c=s(2839),u=s(321),d=s(2437),f=s(9534),p=s(7604);function m(e){if(!e)throw new Error("Assertion failed.")}function g(e){return(e=e.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2')).replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2')}function S(e){return(0,p.sprintf)("%04x",parseInt(e,16))}function E(e){return 255&e}class w{constructor(e,t){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=o.isInSubnet,this.isCorrect=o.isCorrect(h.BITS),this.groups=void 0===t?h.GROUPS:t,this.address=e;const s=h.RE_SUBNET_STRING.exec(e);if(s){if(this.parsedSubnet=s[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>h.BITS)throw new d.AddressError("Invalid subnet mask.");e=e.replace(h.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new d.AddressError("Invalid subnet mask.");const r=h.RE_ZONE_STRING.exec(e);r&&(this.zone=r[0],e=e.replace(h.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}static isValid(e){try{return new w(e),!0}catch(e){return!1}}static fromBigInteger(e){const t=e.toString(16).padStart(32,"0"),s=[];let r;for(r=0;r<h.GROUPS;r++)s.push(t.slice(4*r,4*(r+1)));return new w(s.join(":"))}static fromURL(e){let t,s,r=null;if(-1!==e.indexOf("[")&&-1!==e.indexOf("]:")){if(s=h.RE_URL_WITH_PORT.exec(e),null===s)return{error:"failed to parse address with port",address:null,port:null};t=s[1],r=s[2]}else if(-1!==e.indexOf("/")){if(e=e.replace(/^[a-z0-9]+:\/\//,""),s=h.RE_URL.exec(e),null===s)return{error:"failed to parse address from URL",address:null,port:null};t=s[1]}else t=e;return r?(r=parseInt(r,10),(r<0||r>65536)&&(r=null)):r=null,{address:new w(t),port:r}}static fromAddress4(e){const t=new c.Address4(e),s=h.BITS-(a.BITS-t.subnetMask);return new w(`::ffff:${t.correctForm()}/${s}`)}static fromArpa(e){let t=e.replace(/(\.ip6\.arpa)?\.$/,"");if(63!==t.length)throw new d.AddressError("Invalid 'ip6.arpa' form.");const s=t.split(".").reverse();for(let e=7;e>0;e--){const t=4*e;s.splice(t,0,":")}return t=s.join(""),new w(t)}microsoftTranscription(){return(0,p.sprintf)("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))}mask(e=this.subnetMask){return this.getBitsBase2(0,e)}possibleSubnets(e=128){const t=h.BITS-this.subnetMask-Math.abs(e-h.BITS);return t<0?"0":function(e){const t=/(\d+)(\d{3})/;for(;t.test(e);)e=e.replace(t,"$1,$2");return e}(new f.BigInteger("2",10).pow(t).toString(10))}_startAddress(){return new f.BigInteger(this.mask()+"0".repeat(h.BITS-this.subnetMask),2)}startAddress(){return w.fromBigInteger(this._startAddress())}startAddressExclusive(){const e=new f.BigInteger("1");return w.fromBigInteger(this._startAddress().add(e))}_endAddress(){return new f.BigInteger(this.mask()+"1".repeat(h.BITS-this.subnetMask),2)}endAddress(){return w.fromBigInteger(this._endAddress())}endAddressExclusive(){const e=new f.BigInteger("1");return w.fromBigInteger(this._endAddress().subtract(e))}getScope(){let e=h.SCOPES[this.getBits(12,16).intValue()];return"Global unicast"===this.getType()&&"Link local"!==e&&(e="Global"),e||"Unknown"}getType(){for(const e of Object.keys(h.TYPES))if(this.isInSubnet(new w(e)))return h.TYPES[e];return"Global unicast"}getBits(e,t){return new f.BigInteger(this.getBitsBase2(e,t),2)}getBitsBase2(e,t){return this.binaryZeroPad().slice(e,t)}getBitsBase16(e,t){const s=t-e;if(s%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,t).toString(16).padStart(s/4,"0")}getBitsPastSubnet(){return this.getBitsBase2(this.subnetMask,h.BITS)}reverseForm(e){e||(e={});const t=Math.floor(this.subnetMask/4),s=this.canonicalForm().replace(/:/g,"").split("").slice(0,t).reverse().join(".");return t>0?e.omitSuffix?s:(0,p.sprintf)("%s.ip6.arpa.",s):e.omitSuffix?"":"ip6.arpa."}correctForm(){let e,t=[],s=0;const r=[];for(e=0;e<this.parsedAddress.length;e++){const t=parseInt(this.parsedAddress[e],16);0===t&&s++,0!==t&&s>0&&(s>1&&r.push([e-s,e-1]),s=0)}s>1&&r.push([this.parsedAddress.length-s,this.parsedAddress.length-1]);const i=r.map((e=>e[1]-e[0]+1));if(r.length>0){const e=i.indexOf(Math.max(...i));t=function(e,t){const s=[],r=[];let i;for(i=0;i<e.length;i++)i<t[0]?s.push(e[i]):i>t[1]&&r.push(e[i]);return s.concat(["compact"]).concat(r)}(this.parsedAddress,r[e])}else t=this.parsedAddress;for(e=0;e<t.length;e++)"compact"!==t[e]&&(t[e]=parseInt(t[e],16).toString(16));let n=t.join(":");return n=n.replace(/^compact$/,"::"),n=n.replace(/^compact|compact$/,":"),n=n.replace(/compact/,""),n}binaryZeroPad(){return this.bigInteger().toString(2).padStart(h.BITS,"0")}parse4in6(e){const t=e.split(":"),s=t.slice(-1)[0].match(a.RE_ADDRESS);if(s){this.parsedAddress4=s[0],this.address4=new c.Address4(this.parsedAddress4);for(let t=0;t<this.address4.groups;t++)if(/^0[0-9]+/.test(this.address4.parsedAddress[t]))throw new d.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(a.RE_ADDRESS,this.address4.parsedAddress.map(g).join(".")));this.v4=!0,t[t.length-1]=this.address4.toGroup6(),e=t.join(":")}return e}parse(e){const t=(e=this.parse4in6(e)).match(h.RE_BAD_CHARACTERS);if(t)throw new d.AddressError((0,p.sprintf)("Bad character%s detected in address: %s",t.length>1?"s":"",t.join("")),e.replace(h.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));const s=e.match(h.RE_BAD_ADDRESS);if(s)throw new d.AddressError((0,p.sprintf)("Address failed regex: %s",s.join("")),e.replace(h.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));let r=[];const i=e.split("::");if(2===i.length){let e=i[0].split(":"),t=i[1].split(":");1===e.length&&""===e[0]&&(e=[]),1===t.length&&""===t[0]&&(t=[]);const s=this.groups-(e.length+t.length);if(!s)throw new d.AddressError("Error parsing groups");this.elidedGroups=s,this.elisionBegin=e.length,this.elisionEnd=e.length+this.elidedGroups,r=r.concat(e);for(let e=0;e<s;e++)r.push("0");r=r.concat(t)}else{if(1!==i.length)throw new d.AddressError("Too many :: groups found");r=e.split(":"),this.elidedGroups=0}if(r=r.map((e=>(0,p.sprintf)("%x",parseInt(e,16)))),r.length!==this.groups)throw new d.AddressError("Incorrect number of groups found");return r}canonicalForm(){return this.parsedAddress.map(S).join(":")}decimal(){return this.parsedAddress.map((e=>(0,p.sprintf)("%05d",parseInt(e,16)))).join(":")}bigInteger(){return new f.BigInteger(this.parsedAddress.map(S).join(""),16)}to4(){const e=this.binaryZeroPad().split("");return c.Address4.fromHex(new f.BigInteger(e.slice(96,128).join(""),2).toString(16))}to4in6(){const e=this.to4(),t=new w(this.parsedAddress.slice(0,6).join(":"),6).correctForm();let s="";return/:$/.test(t)||(s=":"),t+s+e.address}inspectTeredo(){const e=this.getBitsBase16(0,32),t=this.getBits(80,96).xor(new f.BigInteger("ffff",16)).toString(),s=c.Address4.fromHex(this.getBitsBase16(32,64)),r=c.Address4.fromHex(this.getBits(96,128).xor(new f.BigInteger("ffffffff",16)).toString(16)),i=this.getBits(64,80),n=this.getBitsBase2(64,80),o=i.testBit(15),a=i.testBit(14),h=i.testBit(8),l=i.testBit(9),u=new f.BigInteger(n.slice(2,6)+n.slice(8,16),2).toString(10);return{prefix:(0,p.sprintf)("%s:%s",e.slice(0,4),e.slice(4,8)),server4:s.address,client4:r.address,flags:n,coneNat:o,microsoft:{reserved:a,universalLocal:l,groupIndividual:h,nonce:u},udpPort:t}}inspect6to4(){const e=this.getBitsBase16(0,16),t=c.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:(0,p.sprintf)("%s",e.slice(0,4)),gateway:t.address}}to6to4(){if(!this.is4())return null;const e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new w(e)}toByteArray(){const e=this.bigInteger().toByteArray();return 17===e.length&&0===e[0]?e.slice(1):e}toUnsignedByteArray(){return this.toByteArray().map(E)}static fromByteArray(e){return this.fromUnsignedByteArray(e.map(E))}static fromUnsignedByteArray(e){const t=new f.BigInteger("256",10);let s=new f.BigInteger("0",10),r=new f.BigInteger("1",10);for(let i=e.length-1;i>=0;i--)s=s.add(r.multiply(new f.BigInteger(e[i].toString(10),10))),r=r.multiply(t);return w.fromBigInteger(s)}isCanonical(){return this.addressMinusSuffix===this.canonicalForm()}isLinkLocal(){return"1111111010000000000000000000000000000000000000000000000000000000"===this.getBitsBase2(0,64)}isMulticast(){return"Multicast"===this.getType()}is4(){return this.v4}isTeredo(){return this.isInSubnet(new w("2001::/32"))}is6to4(){return this.isInSubnet(new w("2002::/16"))}isLoopback(){return"Loopback"===this.getType()}href(e){return e=void 0===e?"":(0,p.sprintf)(":%s",e),(0,p.sprintf)("http://[%s]%s/",this.correctForm(),e)}link(e){e||(e={}),void 0===e.className&&(e.className=""),void 0===e.prefix&&(e.prefix="/#address="),void 0===e.v4&&(e.v4=!1);let t=this.correctForm;return e.v4&&(t=this.to4in6),e.className?(0,p.sprintf)('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,t.call(this),e.className):(0,p.sprintf)('<a href="%1$s%2$s">%2$s</a>',e.prefix,t.call(this))}group(){if(0===this.elidedGroups)return l.simpleGroup(this.address).join(":");m("number"==typeof this.elidedGroups),m("number"==typeof this.elisionBegin);const e=[],[t,s]=this.address.split("::");t.length?e.push(...l.simpleGroup(t)):e.push("");const r=["hover-group"];for(let e=this.elisionBegin;e<this.elisionBegin+this.elidedGroups;e++)r.push((0,p.sprintf)("group-%d",e));return e.push((0,p.sprintf)('<span class="%s"></span>',r.join(" "))),s.length?e.push(...l.simpleGroup(s,this.elisionEnd)):e.push(""),this.is4()&&(m(this.address4 instanceof c.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")}regularExpressionString(e=!1){let t=[];const s=new w(this.correctForm());if(0===s.elidedGroups)t.push((0,u.simpleRegularExpression)(s.parsedAddress));else if(s.elidedGroups===h.GROUPS)t.push((0,u.possibleElisions)(h.GROUPS));else{const e=s.address.split("::");e[0].length&&t.push((0,u.simpleRegularExpression)(e[0].split(":"))),m("number"==typeof s.elidedGroups),t.push((0,u.possibleElisions)(s.elidedGroups,0!==e[0].length,0!==e[1].length)),e[1].length&&t.push((0,u.simpleRegularExpression)(e[1].split(":"))),t=[t.join(":")]}return e||(t=["(?=^|",u.ADDRESS_BOUNDARY,"|[^\\w\\:])(",...t,")(?=[^\\w\\:]|",u.ADDRESS_BOUNDARY,"|$)"]),t.join("")}regularExpression(e=!1){return new RegExp(this.regularExpressionString(e),"i")}}t.Address6=w},6564:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasMagic=t.Glob=t.unescape=t.escape=t.sync=t.iterate=t.iterateSync=t.stream=t.streamSync=t.globIterate=t.globIterateSync=t.glob=t.globSync=t.globStream=t.globStreamSync=void 0;const r=s(5551),i=s(2092),n=s(8878);function o(e,t={}){return new i.Glob(e,t).streamSync()}function a(e,t={}){return new i.Glob(e,t).stream()}function h(e,t={}){return new i.Glob(e,t).walkSync()}async function l(e,t={}){return new i.Glob(e,t).walk()}function c(e,t={}){return new i.Glob(e,t).iterateSync()}function u(e,t={}){return new i.Glob(e,t).iterate()}t.globStreamSync=o,t.globStream=a,t.globSync=h,t.glob=l,t.globIterateSync=c,t.globIterate=u,t.streamSync=o,t.stream=Object.assign(a,{sync:o}),t.iterateSync=c,t.iterate=Object.assign(u,{sync:c}),t.sync=Object.assign(h,{stream:o,iterate:c});var d=s(5551);Object.defineProperty(t,"escape",{enumerable:!0,get:function(){return d.escape}}),Object.defineProperty(t,"unescape",{enumerable:!0,get:function(){return d.unescape}});var f=s(2092);Object.defineProperty(t,"Glob",{enumerable:!0,get:function(){return f.Glob}});var p=s(8878);Object.defineProperty(t,"hasMagic",{enumerable:!0,get:function(){return p.hasMagic}}),t.default=Object.assign(l,{glob:l,globSync:h,sync:t.sync,globStream:a,stream:t.stream,globStreamSync:o,streamSync:t.streamSync,globIterate:u,iterate:t.iterate,globIterateSync:c,iterateSync:t.iterateSync,Glob:i.Glob,hasMagic:n.hasMagic,escape:r.escape,unescape:r.unescape})},6571:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.BufferedLogOutputChannel=void 0,t.createBufferedLogOutputChannel=function(e){const t=a.window.createOutputChannel(e,{log:!0});return new l(t)};const a=o(s(1398)),h=o(s(9023));class l{constructor(e){this.underlying=e,this.bufferedText=""}get name(){return this.underlying.name}get logLevel(){return this.underlying.logLevel}get onDidChangeLogLevel(){return this.underlying.onDidChangeLogLevel}append(e){this.bufferedText+=e,this.underlying.append(e)}appendLine(e){this.bufferedText+=`${e}\n`,this.underlying.appendLine(e)}replace(e){this.bufferedText=e,this.underlying.replace(e)}clear(){this.bufferedText="",this.underlying.clear()}show(e,t){this.underlying.show(e,t)}hide(){this.underlying.hide()}dispose(){this.underlying.dispose()}trace(e,...t){const s=h.format(e,...t);this.bufferedText+=`[trace] ${s}\n`,this.underlying.trace(e,...t)}debug(e,...t){const s=h.format(e,...t);this.bufferedText+=`[debug] ${s}\n`,this.underlying.debug(e,...t)}info(e,...t){const s=h.format(e,...t);this.bufferedText+=`[info] ${s}\n`,this.underlying.info(e,...t)}warn(e,...t){const s=h.format(e,...t);this.bufferedText+=`[warn] ${s}\n`,this.underlying.warn(e,...t)}error(e,...t){const s=h.format(e,...t);this.bufferedText+=`[error] ${s}\n`,this.underlying.error(e,...t)}getBufferedText(){return this.bufferedText}clearBufferedText(){this.bufferedText=""}}t.BufferedLogOutputChannel=l},6584:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Processor=t.SubWalks=t.MatchRecord=t.HasWalkedCache=void 0;const r=s(5551);class i{store;constructor(e=new Map){this.store=e}copy(){return new i(new Map(this.store))}hasWalked(e,t){return this.store.get(e.fullpath())?.has(t.globString())}storeWalked(e,t){const s=e.fullpath(),r=this.store.get(s);r?r.add(t.globString()):this.store.set(s,new Set([t.globString()]))}}t.HasWalkedCache=i;class n{store=new Map;add(e,t,s){const r=(t?2:0)|(s?1:0),i=this.store.get(e);this.store.set(e,void 0===i?r:r&i)}entries(){return[...this.store.entries()].map((([e,t])=>[e,!!(2&t),!!(1&t)]))}}t.MatchRecord=n;class o{store=new Map;add(e,t){if(!e.canReaddir())return;const s=this.store.get(e);s?s.find((e=>e.globString()===t.globString()))||s.push(t):this.store.set(e,[t])}get(e){const t=this.store.get(e);if(!t)throw new Error("attempting to walk unknown path");return t}entries(){return this.keys().map((e=>[e,this.store.get(e)]))}keys(){return[...this.store.keys()].filter((e=>e.canReaddir()))}}t.SubWalks=o;class a{hasWalkedCache;matches=new n;subwalks=new o;patterns;follow;dot;opts;constructor(e,t){this.opts=e,this.follow=!!e.follow,this.dot=!!e.dot,this.hasWalkedCache=t?t.copy():new i}processPatterns(e,t){this.patterns=t;const s=t.map((t=>[e,t]));for(let[e,t]of s){this.hasWalkedCache.storeWalked(e,t);const s=t.root(),i=t.isAbsolute()&&!1!==this.opts.absolute;if(s){e=e.resolve("/"===s&&void 0!==this.opts.root?this.opts.root:s);const r=t.rest();if(!r){this.matches.add(e,!0,!1);continue}t=r}if(e.isENOENT())continue;let n,o,a=!1;for(;"string"==typeof(n=t.pattern())&&(o=t.rest());){const s=e.resolve(n);if(s.isUnknown()&&".."!==n)break;e=s,t=o,a=!0}if(n=t.pattern(),o=t.rest(),a){if(this.hasWalkedCache.hasWalked(e,t))continue;this.hasWalkedCache.storeWalked(e,t)}if("string"!=typeof n)if(n===r.GLOBSTAR){(!e.isSymbolicLink()||this.follow||t.checkFollowGlobstar())&&this.subwalks.add(e,t);const s=o?.pattern(),r=o?.rest();if(o&&(""!==s&&"."!==s||r)){if(".."===s){const t=e.parent||e;r?this.hasWalkedCache.hasWalked(t,r)||this.subwalks.add(t,r):this.matches.add(t,i,!0)}}else this.matches.add(e,i,""===s||"."===s)}else n instanceof RegExp&&this.subwalks.add(e,t);else if(o)this.subwalks.add(e,t);else{const t=".."===n||""===n||"."===n;this.matches.add(e.resolve(n),i,t)}}return this}subwalkTargets(){return this.subwalks.keys()}child(){return new a(this.opts,this.hasWalkedCache)}filterEntries(e,t){const s=this.subwalks.get(e),i=this.child();for(const e of t)for(const t of s){const s=t.isAbsolute(),n=t.pattern(),o=t.rest();n===r.GLOBSTAR?i.testGlobstar(e,t,o,s):n instanceof RegExp?i.testRegExp(e,n,o,s):i.testString(e,n,o,s)}return i}testGlobstar(e,t,s,r){if(!this.dot&&e.name.startsWith(".")||(t.hasMore()||this.matches.add(e,r,!1),e.canReaddir()&&(this.follow||!e.isSymbolicLink()?this.subwalks.add(e,t):e.isSymbolicLink()&&(s&&t.checkFollowGlobstar()?this.subwalks.add(e,s):t.markFollowGlobstar()&&this.subwalks.add(e,t)))),s){const t=s.pattern();if("string"==typeof t&&".."!==t&&""!==t&&"."!==t)this.testString(e,t,s.rest(),r);else if(".."===t){const t=e.parent||e;this.subwalks.add(t,s)}else t instanceof RegExp&&this.testRegExp(e,t,s.rest(),r)}}testRegExp(e,t,s,r){t.test(e.name)&&(s?this.subwalks.add(e,s):this.matches.add(e,r,!1))}testString(e,t,s,r){e.isNamed(t)&&(s?this.subwalks.add(e,s):this.matches.add(e,r,!1))}}t.Processor=a},6760:e=>{"use strict";e.exports=require("node:path")},6780:(e,t,s)=>{"use strict";const r=s(8311);e.exports=(e,t,s)=>(e=new r(e,s),t=new r(t,s),e.intersects(t,s))},6874:e=>{"use strict";const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},6891:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.TrafficGraphPanel=void 0;const a=o(s(1398)),h=o(s(6928)),l=o(s(9896)),c=s(1615);class u{static show(e){const t=a.ViewColumn.Beside;if(u.currentPanel)return void u.currentPanel.panel.reveal(t);const s=a.window.createWebviewPanel("sshTrafficGraph","SSH Traffic Monitor",t,{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:[a.Uri.file(h.join(e.extensionPath,"media"))]});u.currentPanel=new u(s,e)}constructor(e,t){this.disposables=[],this.panel=e,this.updateWebview(t),this.panel.onDidDispose((()=>this.dispose()),null,this.disposables),this.disposables.push((0,c.onTrafficSnapshot)((e=>{this.panel.visible&&this.panel.webview.postMessage({type:"update",data:e})}))),setTimeout((()=>{this.panel.webview.postMessage({type:"history",data:(0,c.getHistory)()})}),100)}updateWebview(e){const t=this.panel.webview,s=h.join(e.extensionPath,"media"),r=h.join(s,"trafficGraph.html");let i=l.readFileSync(r,"utf8");const n=t.asWebviewUri(a.Uri.file(h.join(s,"trafficGraph.js"))),o=t.asWebviewUri(a.Uri.file(h.join(s,"trafficGraph.css")));i=i.replace("trafficGraph.js",n.toString()),i=i.replace("trafficGraph.css",o.toString());const c=t.cspSource;i=i.replace("content=\"default-src 'none'; script-src 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'unsafe-inline';\"",`content="default-src 'none'; script-src ${c} https://cdn.jsdelivr.net; style-src ${c} 'unsafe-inline';"`),this.panel.webview.html=i}dispose(){for(u.currentPanel=void 0,this.panel.dispose();this.disposables.length;){const e=this.disposables.pop();e&&e.dispose()}}}t.TrafficGraphPanel=u},6906:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HostTreeDataProvider=void 0;const h=o(s(1398)),l=o(s(6928)),c=o(s(3256)),u=s(5187),d=a(s(4576));class f{constructor(e,t){this.hostname=e,this.locations=t}}class p{constructor(e,t){this.path=e,this.hostname=t}}t.HostTreeDataProvider=class{dispose(){this.disposables.forEach((e=>e.dispose()))}constructor(e,t){this.locationHistory=e,this.logger=t,this.disposables=[],this._onDidChangeTreeData=new h.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event,this.disposables.push(h.commands.registerCommand("opensshremotes.addNewSshHost",(()=>(0,u.addNewHost)()))),this.disposables.push(h.commands.registerCommand("opensshremotes.explorer.refresh",(()=>this.refresh()))),this.disposables.push(h.commands.registerCommand("opensshremotes.explorer.emptyWindowInNewWindow",(e=>this.openRemoteSSHWindow(e,!1)))),this.disposables.push(h.commands.registerCommand("opensshremotes.explorer.emptyWindowInCurrentWindow",(e=>this.openRemoteSSHWindow(e,!0)))),this.disposables.push(h.commands.registerCommand("opensshremotes.explorer.reopenFolderInNewWindow",(e=>this.openRemoteSSHLocationWindow(e,!1)))),this.disposables.push(h.commands.registerCommand("opensshremotes.explorer.reopenFolderInCurrentWindow",(e=>this.openRemoteSSHLocationWindow(e,!0)))),this.disposables.push(h.commands.registerCommand("opensshremotes.explorer.deleteFolderHistoryItem",(e=>this.deleteHostLocation(e)))),this.disposables.push(h.workspace.onDidChangeConfiguration((e=>{e.affectsConfiguration("remote.SSH.configFile")&&this.refresh()}))),this.disposables.push(h.workspace.onDidSaveTextDocument((e=>{e.uri.fsPath===(0,c.getSSHConfigPath)()&&this.refresh()})))}getTreeItem(e){if(e instanceof p){const t=l.posix.basename(e.path).replace(/\.code-workspace$/," (Workspace)"),s=new h.TreeItem(t);return s.description=l.posix.dirname(e.path),s.iconPath=new h.ThemeIcon("folder"),s.contextValue="opensshremotes.explorer.folder",s}const t=new h.TreeItem(e.hostname);return t.collapsibleState=e.locations.length?h.TreeItemCollapsibleState.Collapsed:h.TreeItemCollapsibleState.None,t.iconPath=new h.ThemeIcon("vm"),t.contextValue="opensshremotes.explorer.host",t}async getChildren(e){return e?e instanceof f?e.locations.map((t=>new p(t,e.hostname))):[]:(await c.default.loadFromFS(this.logger,(0,c.getSSHConfigPath)())).getAllConfiguredHosts().map((e=>new f(e,this.locationHistory.getHistory(e))))}refresh(){this._onDidChangeTreeData.fire()}async deleteHostLocation(e){await this.locationHistory.removeLocation(e.hostname,e.path),this.refresh()}async openRemoteSSHWindow(e,t){const s=new d.default(e.hostname);(0,u.openRemoteSSHWindow)(s.toEncodedString(),t)}async openRemoteSSHLocationWindow(e,t){const s=new d.default(e.hostname);(0,u.openRemoteSSHLocationWindow)(s.toEncodedString(),e.path,t)}}},6928:e=>{"use strict";e.exports=require("path")},6953:(e,t,s)=>{"use strict";const r=s(144);e.exports=(e,t)=>{const s=r(e,t);return s?s.version:null}},6982:e=>{"use strict";e.exports=require("crypto")},7016:e=>{"use strict";e.exports=require("url")},7059:(e,t,s)=>{"use strict";const r=s(560);e.exports=(e,t,s)=>r(e,t,s)<0},7075:e=>{"use strict";e.exports=require("node:stream")},7130:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ipToBuffer=t.int32ToIpv4=t.ipv4ToInt32=t.validateSocksClientChainOptions=t.validateSocksClientOptions=void 0;const r=s(3763),i=s(5438),n=s(2203),o=s(9424),a=s(9278);function h(e,t){if(void 0!==e.custom_auth_method){if(e.custom_auth_method<i.SOCKS5_CUSTOM_AUTH_START||e.custom_auth_method>i.SOCKS5_CUSTOM_AUTH_END)throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsCustomAuthRange,t);if(void 0===e.custom_auth_request_handler||"function"!=typeof e.custom_auth_request_handler)throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,t);if(void 0===e.custom_auth_response_size)throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,t);if(void 0===e.custom_auth_response_handler||"function"!=typeof e.custom_auth_response_handler)throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,t)}}function l(e){return e&&"string"==typeof e.host&&"number"==typeof e.port&&e.port>=0&&e.port<=65535}function c(e){return e&&("string"==typeof e.host||"string"==typeof e.ipaddress)&&"number"==typeof e.port&&e.port>=0&&e.port<=65535&&(4===e.type||5===e.type)}function u(e){return"number"==typeof e&&e>0}t.validateSocksClientOptions=function(e,t=["connect","bind","associate"]){if(!i.SocksCommand[e.command])throw new r.SocksClientError(i.ERRORS.InvalidSocksCommand,e);if(-1===t.indexOf(e.command))throw new r.SocksClientError(i.ERRORS.InvalidSocksCommandForOperation,e);if(!l(e.destination))throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsDestination,e);if(!c(e.proxy))throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsProxy,e);if(h(e.proxy,e),e.timeout&&!u(e.timeout))throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsTimeout,e);if(e.existing_socket&&!(e.existing_socket instanceof n.Duplex))throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsExistingSocket,e)},t.validateSocksClientChainOptions=function(e){if("connect"!==e.command)throw new r.SocksClientError(i.ERRORS.InvalidSocksCommandChain,e);if(!l(e.destination))throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsDestination,e);if(!(e.proxies&&Array.isArray(e.proxies)&&e.proxies.length>=2))throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsProxiesLength,e);if(e.proxies.forEach((t=>{if(!c(t))throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsProxy,e);h(t,e)})),e.timeout&&!u(e.timeout))throw new r.SocksClientError(i.ERRORS.InvalidSocksClientOptionsTimeout,e)},t.ipv4ToInt32=function(e){return new o.Address4(e).toArray().reduce(((e,t)=>(e<<8)+t),0)},t.int32ToIpv4=function(e){return[e>>>24&255,e>>>16&255,e>>>8&255,255&e].join(".")},t.ipToBuffer=function(e){if(a.isIPv4(e)){const t=new o.Address4(e);return Buffer.from(t.toArray())}if(a.isIPv6(e)){const t=new o.Address6(e);return Buffer.from(t.canonicalForm().split(":").map((e=>e.padStart(4,"0"))).join(""),"hex")}throw new Error("Invalid IP address format")}},7175:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.findRandomPort=function(){return new Promise(((e,t)=>{const s=a.createServer({pauseOnConnect:!0});s.on("error",t),s.on("listening",(()=>{const t=s.address().port;s.close((()=>e(t)))})),s.listen(0,"127.0.0.1")}))};const a=o(s(9278))},7184:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertValidPattern=void 0,t.assertValidPattern=e=>{if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")}},7272:e=>{"use strict";const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},7414:(e,t,s)=>{"use strict";const r=s(144);e.exports=(e,t)=>{const s=r(e.trim().replace(/^[=v]+/,""),t);return s?s.version:null}},7480:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExecServer=void 0;const r=s(5303),i=s(9449),n=s(2407);t.ExecServer=class{constructor(e,t,s,n){if(this.commandServer=e,this.platform=t,this.logger=s,this.socksAddressGetter=n,t===i.Platform.Windows)throw new Error("Hopping through windows remote servers is not supported");this.fs=new r.RemoteFileSystem(e,s,t)}async spawn(e,t,s){return this.logger.info(`[execServer][spawn] command: ${e}, args: ${t}, options: ${JSON.stringify(s)}`),await this.commandServer.spawn(e,t,s)}async env(){this.logger.info("[execServer][env]");const e=await this.commandServer.checkOutput("printenv");let t;switch(this.platform){case i.Platform.Linux:t="linux";break;case i.Platform.MacOS:t="darwin";break;case i.Platform.Windows:t="win32";break;default:throw new Error(`Unsupported platform: ${this.platform}`)}return{env:Object.fromEntries(e.trim().split("\n").map((e=>e.split("=",2)))),osPlatform:t,osRelease:void 0}}async kill(e){this.logger.info(`[execServer][kill] processId: ${e}`),await this.commandServer.checkOutput("kill",["-9",e.toString()])}async tcpForward(e){return await(0,n.createTunnel)(this.logger,e,this.socksAddressGetter)}async tcpConnect(e,t){this.logger.info(`[execServer][tcpConnect] host: ${e}, port: ${t}`);const s=`const net = require('net');\nconst fs = require('fs');\nprocess.stdin.pause();\n\nprocess.on('uncaughtException', function (err) {\n\tconsole.error('error: ' + (err.stack || err.message) + '\\n');\n\tprocess.exit(1);\n});\n\nprocess.stdin.on('close', function (hadError) {\n\t\tconsole.error(hadError ? 'Remote stdin close with error' : 'Remote stdin close');\n\t\tprocess.exit(hadError ? 1 : 0);\n\t});\n\nlet didBind = false;\nlet didTryLocalhostIpv4 = false;\nlet didTryLocalhostIpv6 = false;\n\nfunction setupClient(host) {\n\tlet noExit = false;\n\tconst client = net.createConnection({ host, port: ${t}}, () => {\n\t\tconsole.error('Connection established on ' + host + ':${t}');\n\t\tif (didBind) {\n\t\t\treturn;\n\t\t}\n\t\tdidBind = true;\n\t\tnoExit = false;\n\t\tclient.pipe(process.stdout);\n\t\tprocess.stdin.pipe(client);\n\t});\n\tclient.on('close', function (hadError) {\n\t\tif (!noExit) {\n\t\t\tconsole.error(hadError ? 'Remote close with error' : 'Remote close');\n\t\t\tprocess.exit(hadError ? 1 : 0);\n\t\t}\n\t});\n\tclient.on('error', function (err) {\n\t\tconsole.error('client error', err && (err.stack || err.message) || String(err));\n\t\tif ('${e}' === 'localhost' && !didBind) {\n\t\t\t// try again with an explicit ipv4 host\n\t\t\tif (!didTryLocalhostIpv4) {\n\t\t\t\tconsole.error('Retrying on 127.0.0.1');\n\t\t\t\tdidTryLocalhostIpv4 = true;\n\t\t\t\tsetupClient('127.0.0.1');\n\t\t\t\tnoExit = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!didTryLocalhostIpv6) {\n\t\t\t\tconsole.error('Retrying on ::1');\n\t\t\t\tdidTryLocalhostIpv6 = true;\n\t\t\t\tsetupClient('::1');\n\t\t\t\tnoExit = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconsole.error('Failed to bind to localhost; exhausted retries');\n\t\t}\n\t\tif (!noExit) {\n\t\t\tprocess.exit(1);\n\t\t}\n\t});\n}\nsetupClient('${e}');`,{stdin:r,stdout:i,stderr:n,onExit:o}=await this.commandServer.spawn("node",["-e",s]);return n.onDidReceiveMessage((e=>{this.logger.error(`[tcpConnect] stderr: ${e}`)})),{stream:{write:e=>r.write(e),end:()=>r.end(),onDidReceiveMessage:i.onDidReceiveMessage,onEnd:i.onEnd},done:new Promise(((e,t)=>{o.then((()=>{e()}),(e=>{t(e)}))}))}}}},7575:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1725);class i{constructor(e){if(this.length=0,this._encoding="utf8",this._writeOffset=0,this._readOffset=0,i.isSmartBufferOptions(e))if(e.encoding&&(r.checkEncoding(e.encoding),this._encoding=e.encoding),e.size){if(!(r.isFiniteInteger(e.size)&&e.size>0))throw new Error(r.ERRORS.INVALID_SMARTBUFFER_SIZE);this._buff=Buffer.allocUnsafe(e.size)}else if(e.buff){if(!Buffer.isBuffer(e.buff))throw new Error(r.ERRORS.INVALID_SMARTBUFFER_BUFFER);this._buff=e.buff,this.length=e.buff.length}else this._buff=Buffer.allocUnsafe(4096);else{if(void 0!==e)throw new Error(r.ERRORS.INVALID_SMARTBUFFER_OBJECT);this._buff=Buffer.allocUnsafe(4096)}}static fromSize(e,t){return new this({size:e,encoding:t})}static fromBuffer(e,t){return new this({buff:e,encoding:t})}static fromOptions(e){return new this(e)}static isSmartBufferOptions(e){const t=e;return t&&(void 0!==t.encoding||void 0!==t.size||void 0!==t.buff)}readInt8(e){return this._readNumberValue(Buffer.prototype.readInt8,1,e)}readInt16BE(e){return this._readNumberValue(Buffer.prototype.readInt16BE,2,e)}readInt16LE(e){return this._readNumberValue(Buffer.prototype.readInt16LE,2,e)}readInt32BE(e){return this._readNumberValue(Buffer.prototype.readInt32BE,4,e)}readInt32LE(e){return this._readNumberValue(Buffer.prototype.readInt32LE,4,e)}readBigInt64BE(e){return r.bigIntAndBufferInt64Check("readBigInt64BE"),this._readNumberValue(Buffer.prototype.readBigInt64BE,8,e)}readBigInt64LE(e){return r.bigIntAndBufferInt64Check("readBigInt64LE"),this._readNumberValue(Buffer.prototype.readBigInt64LE,8,e)}writeInt8(e,t){return this._writeNumberValue(Buffer.prototype.writeInt8,1,e,t),this}insertInt8(e,t){return this._insertNumberValue(Buffer.prototype.writeInt8,1,e,t)}writeInt16BE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt16BE,2,e,t)}insertInt16BE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt16BE,2,e,t)}writeInt16LE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt16LE,2,e,t)}insertInt16LE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt16LE,2,e,t)}writeInt32BE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt32BE,4,e,t)}insertInt32BE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt32BE,4,e,t)}writeInt32LE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt32LE,4,e,t)}insertInt32LE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt32LE,4,e,t)}writeBigInt64BE(e,t){return r.bigIntAndBufferInt64Check("writeBigInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigInt64BE,8,e,t)}insertBigInt64BE(e,t){return r.bigIntAndBufferInt64Check("writeBigInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigInt64BE,8,e,t)}writeBigInt64LE(e,t){return r.bigIntAndBufferInt64Check("writeBigInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigInt64LE,8,e,t)}insertBigInt64LE(e,t){return r.bigIntAndBufferInt64Check("writeBigInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigInt64LE,8,e,t)}readUInt8(e){return this._readNumberValue(Buffer.prototype.readUInt8,1,e)}readUInt16BE(e){return this._readNumberValue(Buffer.prototype.readUInt16BE,2,e)}readUInt16LE(e){return this._readNumberValue(Buffer.prototype.readUInt16LE,2,e)}readUInt32BE(e){return this._readNumberValue(Buffer.prototype.readUInt32BE,4,e)}readUInt32LE(e){return this._readNumberValue(Buffer.prototype.readUInt32LE,4,e)}readBigUInt64BE(e){return r.bigIntAndBufferInt64Check("readBigUInt64BE"),this._readNumberValue(Buffer.prototype.readBigUInt64BE,8,e)}readBigUInt64LE(e){return r.bigIntAndBufferInt64Check("readBigUInt64LE"),this._readNumberValue(Buffer.prototype.readBigUInt64LE,8,e)}writeUInt8(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt8,1,e,t)}insertUInt8(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt8,1,e,t)}writeUInt16BE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt16BE,2,e,t)}insertUInt16BE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt16BE,2,e,t)}writeUInt16LE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt16LE,2,e,t)}insertUInt16LE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt16LE,2,e,t)}writeUInt32BE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt32BE,4,e,t)}insertUInt32BE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt32BE,4,e,t)}writeUInt32LE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt32LE,4,e,t)}insertUInt32LE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt32LE,4,e,t)}writeBigUInt64BE(e,t){return r.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64BE,8,e,t)}insertBigUInt64BE(e,t){return r.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64BE,8,e,t)}writeBigUInt64LE(e,t){return r.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64LE,8,e,t)}insertBigUInt64LE(e,t){return r.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64LE,8,e,t)}readFloatBE(e){return this._readNumberValue(Buffer.prototype.readFloatBE,4,e)}readFloatLE(e){return this._readNumberValue(Buffer.prototype.readFloatLE,4,e)}writeFloatBE(e,t){return this._writeNumberValue(Buffer.prototype.writeFloatBE,4,e,t)}insertFloatBE(e,t){return this._insertNumberValue(Buffer.prototype.writeFloatBE,4,e,t)}writeFloatLE(e,t){return this._writeNumberValue(Buffer.prototype.writeFloatLE,4,e,t)}insertFloatLE(e,t){return this._insertNumberValue(Buffer.prototype.writeFloatLE,4,e,t)}readDoubleBE(e){return this._readNumberValue(Buffer.prototype.readDoubleBE,8,e)}readDoubleLE(e){return this._readNumberValue(Buffer.prototype.readDoubleLE,8,e)}writeDoubleBE(e,t){return this._writeNumberValue(Buffer.prototype.writeDoubleBE,8,e,t)}insertDoubleBE(e,t){return this._insertNumberValue(Buffer.prototype.writeDoubleBE,8,e,t)}writeDoubleLE(e,t){return this._writeNumberValue(Buffer.prototype.writeDoubleLE,8,e,t)}insertDoubleLE(e,t){return this._insertNumberValue(Buffer.prototype.writeDoubleLE,8,e,t)}readString(e,t){let s;"number"==typeof e?(r.checkLengthValue(e),s=Math.min(e,this.length-this._readOffset)):(t=e,s=this.length-this._readOffset),void 0!==t&&r.checkEncoding(t);const i=this._buff.slice(this._readOffset,this._readOffset+s).toString(t||this._encoding);return this._readOffset+=s,i}insertString(e,t,s){return r.checkOffsetValue(t),this._handleString(e,!0,t,s)}writeString(e,t,s){return this._handleString(e,!1,t,s)}readStringNT(e){void 0!==e&&r.checkEncoding(e);let t=this.length;for(let e=this._readOffset;e<this.length;e++)if(0===this._buff[e]){t=e;break}const s=this._buff.slice(this._readOffset,t);return this._readOffset=t+1,s.toString(e||this._encoding)}insertStringNT(e,t,s){return r.checkOffsetValue(t),this.insertString(e,t,s),this.insertUInt8(0,t+e.length),this}writeStringNT(e,t,s){return this.writeString(e,t,s),this.writeUInt8(0,"number"==typeof t?t+e.length:this.writeOffset),this}readBuffer(e){void 0!==e&&r.checkLengthValue(e);const t="number"==typeof e?e:this.length,s=Math.min(this.length,this._readOffset+t),i=this._buff.slice(this._readOffset,s);return this._readOffset=s,i}insertBuffer(e,t){return r.checkOffsetValue(t),this._handleBuffer(e,!0,t)}writeBuffer(e,t){return this._handleBuffer(e,!1,t)}readBufferNT(){let e=this.length;for(let t=this._readOffset;t<this.length;t++)if(0===this._buff[t]){e=t;break}const t=this._buff.slice(this._readOffset,e);return this._readOffset=e+1,t}insertBufferNT(e,t){return r.checkOffsetValue(t),this.insertBuffer(e,t),this.insertUInt8(0,t+e.length),this}writeBufferNT(e,t){return void 0!==t&&r.checkOffsetValue(t),this.writeBuffer(e,t),this.writeUInt8(0,"number"==typeof t?t+e.length:this._writeOffset),this}clear(){return this._writeOffset=0,this._readOffset=0,this.length=0,this}remaining(){return this.length-this._readOffset}get readOffset(){return this._readOffset}set readOffset(e){r.checkOffsetValue(e),r.checkTargetOffset(e,this),this._readOffset=e}get writeOffset(){return this._writeOffset}set writeOffset(e){r.checkOffsetValue(e),r.checkTargetOffset(e,this),this._writeOffset=e}get encoding(){return this._encoding}set encoding(e){r.checkEncoding(e),this._encoding=e}get internalBuffer(){return this._buff}toBuffer(){return this._buff.slice(0,this.length)}toString(e){const t="string"==typeof e?e:this._encoding;return r.checkEncoding(t),this._buff.toString(t,0,this.length)}destroy(){return this.clear(),this}_handleString(e,t,s,i){let n=this._writeOffset,o=this._encoding;"number"==typeof s?n=s:"string"==typeof s&&(r.checkEncoding(s),o=s),"string"==typeof i&&(r.checkEncoding(i),o=i);const a=Buffer.byteLength(e,o);return t?this.ensureInsertable(a,n):this._ensureWriteable(a,n),this._buff.write(e,n,a,o),t?this._writeOffset+=a:"number"==typeof s?this._writeOffset=Math.max(this._writeOffset,n+a):this._writeOffset+=a,this}_handleBuffer(e,t,s){const r="number"==typeof s?s:this._writeOffset;return t?this.ensureInsertable(e.length,r):this._ensureWriteable(e.length,r),e.copy(this._buff,r),t?this._writeOffset+=e.length:"number"==typeof s?this._writeOffset=Math.max(this._writeOffset,r+e.length):this._writeOffset+=e.length,this}ensureReadable(e,t){let s=this._readOffset;if(void 0!==t&&(r.checkOffsetValue(t),s=t),s<0||s+e>this.length)throw new Error(r.ERRORS.INVALID_READ_BEYOND_BOUNDS)}ensureInsertable(e,t){r.checkOffsetValue(t),this._ensureCapacity(this.length+e),t<this.length&&this._buff.copy(this._buff,t+e,t,this._buff.length),t+e>this.length?this.length=t+e:this.length+=e}_ensureWriteable(e,t){const s="number"==typeof t?t:this._writeOffset;this._ensureCapacity(s+e),s+e>this.length&&(this.length=s+e)}_ensureCapacity(e){const t=this._buff.length;if(e>t){let s=this._buff,r=3*t/2+1;r<e&&(r=e),this._buff=Buffer.allocUnsafe(r),s.copy(this._buff,0,0,t)}}_readNumberValue(e,t,s){this.ensureReadable(t,s);const r=e.call(this._buff,"number"==typeof s?s:this._readOffset);return void 0===s&&(this._readOffset+=t),r}_insertNumberValue(e,t,s,i){return r.checkOffsetValue(i),this.ensureInsertable(t,i),e.call(this._buff,s,i),this._writeOffset+=t,this}_writeNumberValue(e,t,s,i){if("number"==typeof i){if(i<0)throw new Error(r.ERRORS.INVALID_WRITE_BEYOND_BOUNDS);r.checkOffsetValue(i)}const n="number"==typeof i?i:this._writeOffset;return this._ensureWriteable(t,n),e.call(this._buff,s,n),"number"==typeof i?this._writeOffset=Math.max(this._writeOffset,n+t):this._writeOffset+=t,this}}t.SmartBuffer=i},7604:(e,t,s)=>{var r;!function(){"use strict";var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function n(e){return function(e,t){var s,r,o,a,h,l,c,u,d,f=1,p=e.length,m="";for(r=0;r<p;r++)if("string"==typeof e[r])m+=e[r];else if("object"==typeof e[r]){if((a=e[r]).keys)for(s=t[f],o=0;o<a.keys.length;o++){if(null==s)throw new Error(n('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[o],a.keys[o-1]));s=s[a.keys[o]]}else s=a.param_no?t[a.param_no]:t[f++];if(i.not_type.test(a.type)&&i.not_primitive.test(a.type)&&s instanceof Function&&(s=s()),i.numeric_arg.test(a.type)&&"number"!=typeof s&&isNaN(s))throw new TypeError(n("[sprintf] expecting number but found %T",s));switch(i.number.test(a.type)&&(u=s>=0),a.type){case"b":s=parseInt(s,10).toString(2);break;case"c":s=String.fromCharCode(parseInt(s,10));break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,a.width?parseInt(a.width):0);break;case"e":s=a.precision?parseFloat(s).toExponential(a.precision):parseFloat(s).toExponential();break;case"f":s=a.precision?parseFloat(s).toFixed(a.precision):parseFloat(s);break;case"g":s=a.precision?String(Number(s.toPrecision(a.precision))):parseFloat(s);break;case"o":s=(parseInt(s,10)>>>0).toString(8);break;case"s":s=String(s),s=a.precision?s.substring(0,a.precision):s;break;case"t":s=String(!!s),s=a.precision?s.substring(0,a.precision):s;break;case"T":s=Object.prototype.toString.call(s).slice(8,-1).toLowerCase(),s=a.precision?s.substring(0,a.precision):s;break;case"u":s=parseInt(s,10)>>>0;break;case"v":s=s.valueOf(),s=a.precision?s.substring(0,a.precision):s;break;case"x":s=(parseInt(s,10)>>>0).toString(16);break;case"X":s=(parseInt(s,10)>>>0).toString(16).toUpperCase()}i.json.test(a.type)?m+=s:(!i.number.test(a.type)||u&&!a.sign?d="":(d=u?"+":"-",s=s.toString().replace(i.sign,"")),l=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",c=a.width-(d+s).length,h=a.width&&c>0?l.repeat(c):"",m+=a.align?d+s+h:"0"===l?d+h+s:h+d+s)}return m}(function(e){if(a[e])return a[e];for(var t,s=e,r=[],n=0;s;){if(null!==(t=i.text.exec(s)))r.push(t[0]);else if(null!==(t=i.modulo.exec(s)))r.push("%");else{if(null===(t=i.placeholder.exec(s)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){n|=1;var o=[],h=t[2],l=[];if(null===(l=i.key.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(o.push(l[1]);""!==(h=h.substring(l[0].length));)if(null!==(l=i.key_access.exec(h)))o.push(l[1]);else{if(null===(l=i.index_access.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");o.push(l[1])}t[2]=o}else n|=2;if(3===n)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}s=s.substring(t[0].length)}return a[e]=r}(e),arguments)}function o(e,t){return n.apply(null,[e].concat(t||[]))}var a=Object.create(null);t.sprintf=n,t.vsprintf=o,"undefined"!=typeof window&&(window.sprintf=n,window.vsprintf=o,void 0===(r=function(){return{sprintf:n,vsprintf:o}}.call(t,s,t,e))||(e.exports=r))}()},7631:function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{h(r.next(e))}catch(e){n(e)}}function a(e){try{h(r.throw(e))}catch(e){n(e)}}function h(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}h((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SocksClientError=t.SocksClient=void 0;const i=s(4434),n=s(9278),o=s(7575),a=s(5438),h=s(7130),l=s(7736),c=s(3763);Object.defineProperty(t,"SocksClientError",{enumerable:!0,get:function(){return c.SocksClientError}});const u=s(9424);class d extends i.EventEmitter{constructor(e){super(),this.options=Object.assign({},e),(0,h.validateSocksClientOptions)(e),this.setState(a.SocksClientState.Created)}static createConnection(e,t){return new Promise(((s,r)=>{try{(0,h.validateSocksClientOptions)(e,["connect"])}catch(e){return"function"==typeof t?(t(e),s(e)):r(e)}const i=new d(e);i.connect(e.existing_socket),i.once("established",(e=>{i.removeAllListeners(),"function"==typeof t?(t(null,e),s(e)):s(e)})),i.once("error",(e=>{i.removeAllListeners(),"function"==typeof t?(t(e),s(e)):r(e)}))}))}static createConnectionChain(e,t){return new Promise(((s,i)=>r(this,void 0,void 0,(function*(){try{(0,h.validateSocksClientChainOptions)(e)}catch(e){return"function"==typeof t?(t(e),s(e)):i(e)}e.randomizeChain&&(0,c.shuffleArray)(e.proxies);try{let r;for(let t=0;t<e.proxies.length;t++){const s=e.proxies[t],i=t===e.proxies.length-1?e.destination:{host:e.proxies[t+1].host||e.proxies[t+1].ipaddress,port:e.proxies[t+1].port},n=yield d.createConnection({command:"connect",proxy:s,destination:i,existing_socket:r});r=r||n.socket}"function"==typeof t?(t(null,{socket:r}),s({socket:r})):s({socket:r})}catch(e){"function"==typeof t?(t(e),s(e)):i(e)}}))))}static createUDPFrame(e){const t=new o.SmartBuffer;return t.writeUInt16BE(0),t.writeUInt8(e.frameNumber||0),n.isIPv4(e.remoteHost.host)?(t.writeUInt8(a.Socks5HostType.IPv4),t.writeUInt32BE((0,h.ipv4ToInt32)(e.remoteHost.host))):n.isIPv6(e.remoteHost.host)?(t.writeUInt8(a.Socks5HostType.IPv6),t.writeBuffer((0,h.ipToBuffer)(e.remoteHost.host))):(t.writeUInt8(a.Socks5HostType.Hostname),t.writeUInt8(Buffer.byteLength(e.remoteHost.host)),t.writeString(e.remoteHost.host)),t.writeUInt16BE(e.remoteHost.port),t.writeBuffer(e.data),t.toBuffer()}static parseUDPFrame(e){const t=o.SmartBuffer.fromBuffer(e);t.readOffset=2;const s=t.readUInt8(),r=t.readUInt8();let i;return i=r===a.Socks5HostType.IPv4?(0,h.int32ToIpv4)(t.readUInt32BE()):r===a.Socks5HostType.IPv6?u.Address6.fromByteArray(Array.from(t.readBuffer(16))).canonicalForm():t.readString(t.readUInt8()),{frameNumber:s,remoteHost:{host:i,port:t.readUInt16BE()},data:t.readBuffer()}}setState(e){this.state!==a.SocksClientState.Error&&(this.state=e)}connect(e){this.onDataReceived=e=>this.onDataReceivedHandler(e),this.onClose=()=>this.onCloseHandler(),this.onError=e=>this.onErrorHandler(e),this.onConnect=()=>this.onConnectHandler();const t=setTimeout((()=>this.onEstablishedTimeout()),this.options.timeout||a.DEFAULT_TIMEOUT);t.unref&&"function"==typeof t.unref&&t.unref(),this.socket=e||new n.Socket,this.socket.once("close",this.onClose),this.socket.once("error",this.onError),this.socket.once("connect",this.onConnect),this.socket.on("data",this.onDataReceived),this.setState(a.SocksClientState.Connecting),this.receiveBuffer=new l.ReceiveBuffer,e?this.socket.emit("connect"):(this.socket.connect(this.getSocketOptions()),void 0!==this.options.set_tcp_nodelay&&null!==this.options.set_tcp_nodelay&&this.socket.setNoDelay(!!this.options.set_tcp_nodelay)),this.prependOnceListener("established",(e=>{setImmediate((()=>{if(this.receiveBuffer.length>0){const t=this.receiveBuffer.get(this.receiveBuffer.length);e.socket.emit("data",t)}e.socket.resume()}))}))}getSocketOptions(){return Object.assign(Object.assign({},this.options.socket_options),{host:this.options.proxy.host||this.options.proxy.ipaddress,port:this.options.proxy.port})}onEstablishedTimeout(){this.state!==a.SocksClientState.Established&&this.state!==a.SocksClientState.BoundWaitingForConnection&&this.closeSocket(a.ERRORS.ProxyConnectionTimedOut)}onConnectHandler(){this.setState(a.SocksClientState.Connected),4===this.options.proxy.type?this.sendSocks4InitialHandshake():this.sendSocks5InitialHandshake(),this.setState(a.SocksClientState.SentInitialHandshake)}onDataReceivedHandler(e){this.receiveBuffer.append(e),this.processData()}processData(){for(;this.state!==a.SocksClientState.Established&&this.state!==a.SocksClientState.Error&&this.receiveBuffer.length>=this.nextRequiredPacketBufferSize;)if(this.state===a.SocksClientState.SentInitialHandshake)4===this.options.proxy.type?this.handleSocks4FinalHandshakeResponse():this.handleInitialSocks5HandshakeResponse();else if(this.state===a.SocksClientState.SentAuthentication)this.handleInitialSocks5AuthenticationHandshakeResponse();else if(this.state===a.SocksClientState.SentFinalHandshake)this.handleSocks5FinalHandshakeResponse();else{if(this.state!==a.SocksClientState.BoundWaitingForConnection){this.closeSocket(a.ERRORS.InternalError);break}4===this.options.proxy.type?this.handleSocks4IncomingConnectionResponse():this.handleSocks5IncomingConnectionResponse()}}onCloseHandler(){this.closeSocket(a.ERRORS.SocketClosed)}onErrorHandler(e){this.closeSocket(e.message)}removeInternalSocketHandlers(){this.socket.pause(),this.socket.removeListener("data",this.onDataReceived),this.socket.removeListener("close",this.onClose),this.socket.removeListener("error",this.onError),this.socket.removeListener("connect",this.onConnect)}closeSocket(e){this.state!==a.SocksClientState.Error&&(this.setState(a.SocksClientState.Error),this.socket.destroy(),this.removeInternalSocketHandlers(),this.emit("error",new c.SocksClientError(e,this.options)))}sendSocks4InitialHandshake(){const e=this.options.proxy.userId||"",t=new o.SmartBuffer;t.writeUInt8(4),t.writeUInt8(a.SocksCommand[this.options.command]),t.writeUInt16BE(this.options.destination.port),n.isIPv4(this.options.destination.host)?(t.writeBuffer((0,h.ipToBuffer)(this.options.destination.host)),t.writeStringNT(e)):(t.writeUInt8(0),t.writeUInt8(0),t.writeUInt8(0),t.writeUInt8(1),t.writeStringNT(e),t.writeStringNT(this.options.destination.host)),this.nextRequiredPacketBufferSize=a.SOCKS_INCOMING_PACKET_SIZES.Socks4Response,this.socket.write(t.toBuffer())}handleSocks4FinalHandshakeResponse(){const e=this.receiveBuffer.get(8);if(e[1]!==a.Socks4Response.Granted)this.closeSocket(`${a.ERRORS.Socks4ProxyRejectedConnection} - (${a.Socks4Response[e[1]]})`);else if(a.SocksCommand[this.options.command]===a.SocksCommand.bind){const t=o.SmartBuffer.fromBuffer(e);t.readOffset=2;const s={port:t.readUInt16BE(),host:(0,h.int32ToIpv4)(t.readUInt32BE())};"0.0.0.0"===s.host&&(s.host=this.options.proxy.ipaddress),this.setState(a.SocksClientState.BoundWaitingForConnection),this.emit("bound",{remoteHost:s,socket:this.socket})}else this.setState(a.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{socket:this.socket})}handleSocks4IncomingConnectionResponse(){const e=this.receiveBuffer.get(8);if(e[1]!==a.Socks4Response.Granted)this.closeSocket(`${a.ERRORS.Socks4ProxyRejectedIncomingBoundConnection} - (${a.Socks4Response[e[1]]})`);else{const t=o.SmartBuffer.fromBuffer(e);t.readOffset=2;const s={port:t.readUInt16BE(),host:(0,h.int32ToIpv4)(t.readUInt32BE())};this.setState(a.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:s,socket:this.socket})}}sendSocks5InitialHandshake(){const e=new o.SmartBuffer,t=[a.Socks5Auth.NoAuth];(this.options.proxy.userId||this.options.proxy.password)&&t.push(a.Socks5Auth.UserPass),void 0!==this.options.proxy.custom_auth_method&&t.push(this.options.proxy.custom_auth_method),e.writeUInt8(5),e.writeUInt8(t.length);for(const s of t)e.writeUInt8(s);this.nextRequiredPacketBufferSize=a.SOCKS_INCOMING_PACKET_SIZES.Socks5InitialHandshakeResponse,this.socket.write(e.toBuffer()),this.setState(a.SocksClientState.SentInitialHandshake)}handleInitialSocks5HandshakeResponse(){const e=this.receiveBuffer.get(2);5!==e[0]?this.closeSocket(a.ERRORS.InvalidSocks5IntiailHandshakeSocksVersion):e[1]===a.SOCKS5_NO_ACCEPTABLE_AUTH?this.closeSocket(a.ERRORS.InvalidSocks5InitialHandshakeNoAcceptedAuthType):e[1]===a.Socks5Auth.NoAuth?(this.socks5ChosenAuthType=a.Socks5Auth.NoAuth,this.sendSocks5CommandRequest()):e[1]===a.Socks5Auth.UserPass?(this.socks5ChosenAuthType=a.Socks5Auth.UserPass,this.sendSocks5UserPassAuthentication()):e[1]===this.options.proxy.custom_auth_method?(this.socks5ChosenAuthType=this.options.proxy.custom_auth_method,this.sendSocks5CustomAuthentication()):this.closeSocket(a.ERRORS.InvalidSocks5InitialHandshakeUnknownAuthType)}sendSocks5UserPassAuthentication(){const e=this.options.proxy.userId||"",t=this.options.proxy.password||"",s=new o.SmartBuffer;s.writeUInt8(1),s.writeUInt8(Buffer.byteLength(e)),s.writeString(e),s.writeUInt8(Buffer.byteLength(t)),s.writeString(t),this.nextRequiredPacketBufferSize=a.SOCKS_INCOMING_PACKET_SIZES.Socks5UserPassAuthenticationResponse,this.socket.write(s.toBuffer()),this.setState(a.SocksClientState.SentAuthentication)}sendSocks5CustomAuthentication(){return r(this,void 0,void 0,(function*(){this.nextRequiredPacketBufferSize=this.options.proxy.custom_auth_response_size,this.socket.write(yield this.options.proxy.custom_auth_request_handler()),this.setState(a.SocksClientState.SentAuthentication)}))}handleSocks5CustomAuthHandshakeResponse(e){return r(this,void 0,void 0,(function*(){return yield this.options.proxy.custom_auth_response_handler(e)}))}handleSocks5AuthenticationNoAuthHandshakeResponse(e){return r(this,void 0,void 0,(function*(){return 0===e[1]}))}handleSocks5AuthenticationUserPassHandshakeResponse(e){return r(this,void 0,void 0,(function*(){return 0===e[1]}))}handleInitialSocks5AuthenticationHandshakeResponse(){return r(this,void 0,void 0,(function*(){this.setState(a.SocksClientState.ReceivedAuthenticationResponse);let e=!1;this.socks5ChosenAuthType===a.Socks5Auth.NoAuth?e=yield this.handleSocks5AuthenticationNoAuthHandshakeResponse(this.receiveBuffer.get(2)):this.socks5ChosenAuthType===a.Socks5Auth.UserPass?e=yield this.handleSocks5AuthenticationUserPassHandshakeResponse(this.receiveBuffer.get(2)):this.socks5ChosenAuthType===this.options.proxy.custom_auth_method&&(e=yield this.handleSocks5CustomAuthHandshakeResponse(this.receiveBuffer.get(this.options.proxy.custom_auth_response_size))),e?this.sendSocks5CommandRequest():this.closeSocket(a.ERRORS.Socks5AuthenticationFailed)}))}sendSocks5CommandRequest(){const e=new o.SmartBuffer;e.writeUInt8(5),e.writeUInt8(a.SocksCommand[this.options.command]),e.writeUInt8(0),n.isIPv4(this.options.destination.host)?(e.writeUInt8(a.Socks5HostType.IPv4),e.writeBuffer((0,h.ipToBuffer)(this.options.destination.host))):n.isIPv6(this.options.destination.host)?(e.writeUInt8(a.Socks5HostType.IPv6),e.writeBuffer((0,h.ipToBuffer)(this.options.destination.host))):(e.writeUInt8(a.Socks5HostType.Hostname),e.writeUInt8(this.options.destination.host.length),e.writeString(this.options.destination.host)),e.writeUInt16BE(this.options.destination.port),this.nextRequiredPacketBufferSize=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.socket.write(e.toBuffer()),this.setState(a.SocksClientState.SentFinalHandshake)}handleSocks5FinalHandshakeResponse(){const e=this.receiveBuffer.peek(5);if(5!==e[0]||e[1]!==a.Socks5Response.Granted)this.closeSocket(`${a.ERRORS.InvalidSocks5FinalHandshakeRejected} - ${a.Socks5Response[e[1]]}`);else{const t=e[3];let s,r;if(t===a.Socks5HostType.IPv4){const e=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),s={host:(0,h.int32ToIpv4)(r.readUInt32BE()),port:r.readUInt16BE()},"0.0.0.0"===s.host&&(s.host=this.options.proxy.ipaddress)}else if(t===a.Socks5HostType.Hostname){const t=e[4],i=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(t);if(this.receiveBuffer.length<i)return void(this.nextRequiredPacketBufferSize=i);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(i).slice(5)),s={host:r.readString(t),port:r.readUInt16BE()}}else if(t===a.Socks5HostType.IPv6){const e=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),s={host:u.Address6.fromByteArray(Array.from(r.readBuffer(16))).canonicalForm(),port:r.readUInt16BE()}}this.setState(a.SocksClientState.ReceivedFinalResponse),a.SocksCommand[this.options.command]===a.SocksCommand.connect?(this.setState(a.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:s,socket:this.socket})):a.SocksCommand[this.options.command]===a.SocksCommand.bind?(this.setState(a.SocksClientState.BoundWaitingForConnection),this.nextRequiredPacketBufferSize=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.emit("bound",{remoteHost:s,socket:this.socket})):a.SocksCommand[this.options.command]===a.SocksCommand.associate&&(this.setState(a.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:s,socket:this.socket}))}}handleSocks5IncomingConnectionResponse(){const e=this.receiveBuffer.peek(5);if(5!==e[0]||e[1]!==a.Socks5Response.Granted)this.closeSocket(`${a.ERRORS.Socks5ProxyRejectedIncomingBoundConnection} - ${a.Socks5Response[e[1]]}`);else{const t=e[3];let s,r;if(t===a.Socks5HostType.IPv4){const e=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),s={host:(0,h.int32ToIpv4)(r.readUInt32BE()),port:r.readUInt16BE()},"0.0.0.0"===s.host&&(s.host=this.options.proxy.ipaddress)}else if(t===a.Socks5HostType.Hostname){const t=e[4],i=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(t);if(this.receiveBuffer.length<i)return void(this.nextRequiredPacketBufferSize=i);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(i).slice(5)),s={host:r.readString(t),port:r.readUInt16BE()}}else if(t===a.Socks5HostType.IPv6){const e=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),s={host:u.Address6.fromByteArray(Array.from(r.readBuffer(16))).canonicalForm(),port:r.readUInt16BE()}}this.setState(a.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:s,socket:this.socket})}}get socksClientOptions(){return Object.assign({},this.options)}}t.SocksClient=d},7638:(e,t,s)=>{"use strict";const r=s(8311);e.exports=(e,t,s)=>{try{t=new r(t,s)}catch(e){return!1}return t.test(e)}},7694:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Minipass=t.isWritable=t.isReadable=t.isStream=void 0;const i="object"==typeof process&&process?process:{stdout:null,stderr:null},n=s(8474),o=r(s(7075)),a=s(6193);t.isStream=e=>!!e&&"object"==typeof e&&(e instanceof H||e instanceof o.default||(0,t.isReadable)(e)||(0,t.isWritable)(e)),t.isReadable=e=>!!e&&"object"==typeof e&&e instanceof n.EventEmitter&&"function"==typeof e.pipe&&e.pipe!==o.default.Writable.prototype.pipe,t.isWritable=e=>!!e&&"object"==typeof e&&e instanceof n.EventEmitter&&"function"==typeof e.write&&"function"==typeof e.end;const h=Symbol("EOF"),l=Symbol("maybeEmitEnd"),c=Symbol("emittedEnd"),u=Symbol("emittingEnd"),d=Symbol("emittedError"),f=Symbol("closed"),p=Symbol("read"),m=Symbol("flush"),g=Symbol("flushChunk"),S=Symbol("encoding"),E=Symbol("decoder"),w=Symbol("flowing"),v=Symbol("paused"),_=Symbol("resume"),y=Symbol("buffer"),R=Symbol("pipes"),b=Symbol("bufferLength"),O=Symbol("bufferPush"),I=Symbol("bufferShift"),$=Symbol("objectMode"),T=Symbol("destroyed"),C=Symbol("error"),k=Symbol("emitData"),P=Symbol("emitEnd"),A=Symbol("emitEnd2"),L=Symbol("async"),x=Symbol("abort"),N=Symbol("aborted"),D=Symbol("signal"),M=Symbol("dataListeners"),B=Symbol("discarded"),F=e=>Promise.resolve().then(e),U=e=>e();class j{src;dest;opts;ondrain;constructor(e,t,s){this.src=e,this.dest=t,this.opts=s,this.ondrain=()=>e[_](),this.dest.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(e){}end(){this.unpipe(),this.opts.end&&this.dest.end()}}class V extends j{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,t,s){super(e,t,s),this.proxyErrors=e=>t.emit("error",e),e.on("error",this.proxyErrors)}}class H extends n.EventEmitter{[w]=!1;[v]=!1;[R]=[];[y]=[];[$];[S];[L];[E];[h]=!1;[c]=!1;[u]=!1;[f]=!1;[d]=null;[b]=0;[T]=!1;[D];[N]=!1;[M]=0;[B]=!1;writable=!0;readable=!0;constructor(...e){const t=e[0]||{};if(super(),t.objectMode&&"string"==typeof t.encoding)throw new TypeError("Encoding and objectMode may not be used together");var s;t.objectMode?(this[$]=!0,this[S]=null):!(s=t).objectMode&&s.encoding&&"buffer"!==s.encoding?(this[S]=t.encoding,this[$]=!1):(this[$]=!1,this[S]=null),this[L]=!!t.async,this[E]=this[S]?new a.StringDecoder(this[S]):null,t&&!0===t.debugExposeBuffer&&Object.defineProperty(this,"buffer",{get:()=>this[y]}),t&&!0===t.debugExposePipes&&Object.defineProperty(this,"pipes",{get:()=>this[R]});const{signal:r}=t;r&&(this[D]=r,r.aborted?this[x]():r.addEventListener("abort",(()=>this[x]())))}get bufferLength(){return this[b]}get encoding(){return this[S]}set encoding(e){throw new Error("Encoding must be set at instantiation time")}setEncoding(e){throw new Error("Encoding must be set at instantiation time")}get objectMode(){return this[$]}set objectMode(e){throw new Error("objectMode must be set at instantiation time")}get async(){return this[L]}set async(e){this[L]=this[L]||!!e}[x](){this[N]=!0,this.emit("abort",this[D]?.reason),this.destroy(this[D]?.reason)}get aborted(){return this[N]}set aborted(e){}write(e,t,s){if(this[N])return!1;if(this[h])throw new Error("write after end");if(this[T])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;"function"==typeof t&&(s=t,t="utf8"),t||(t="utf8");const r=this[L]?F:U;if(!this[$]&&!Buffer.isBuffer(e))if(i=e,!Buffer.isBuffer(i)&&ArrayBuffer.isView(i))e=Buffer.from(e.buffer,e.byteOffset,e.byteLength);else if((e=>e instanceof ArrayBuffer||!!e&&"object"==typeof e&&e.constructor&&"ArrayBuffer"===e.constructor.name&&e.byteLength>=0)(e))e=Buffer.from(e);else if("string"!=typeof e)throw new Error("Non-contiguous data written to non-objectMode stream");var i;return this[$]?(this[w]&&0!==this[b]&&this[m](!0),this[w]?this.emit("data",e):this[O](e),0!==this[b]&&this.emit("readable"),s&&r(s),this[w]):e.length?("string"!=typeof e||t===this[S]&&!this[E]?.lastNeed||(e=Buffer.from(e,t)),Buffer.isBuffer(e)&&this[S]&&(e=this[E].write(e)),this[w]&&0!==this[b]&&this[m](!0),this[w]?this.emit("data",e):this[O](e),0!==this[b]&&this.emit("readable"),s&&r(s),this[w]):(0!==this[b]&&this.emit("readable"),s&&r(s),this[w])}read(e){if(this[T])return null;if(this[B]=!1,0===this[b]||0===e||e&&e>this[b])return this[l](),null;this[$]&&(e=null),this[y].length>1&&!this[$]&&(this[y]=[this[S]?this[y].join(""):Buffer.concat(this[y],this[b])]);const t=this[p](e||null,this[y][0]);return this[l](),t}[p](e,t){if(this[$])this[I]();else{const s=t;e===s.length||null===e?this[I]():"string"==typeof s?(this[y][0]=s.slice(e),t=s.slice(0,e),this[b]-=e):(this[y][0]=s.subarray(e),t=s.subarray(0,e),this[b]-=e)}return this.emit("data",t),this[y].length||this[h]||this.emit("drain"),t}end(e,t,s){return"function"==typeof e&&(s=e,e=void 0),"function"==typeof t&&(s=t,t="utf8"),void 0!==e&&this.write(e,t),s&&this.once("end",s),this[h]=!0,this.writable=!1,!this[w]&&this[v]||this[l](),this}[_](){this[T]||(this[M]||this[R].length||(this[B]=!0),this[v]=!1,this[w]=!0,this.emit("resume"),this[y].length?this[m]():this[h]?this[l]():this.emit("drain"))}resume(){return this[_]()}pause(){this[w]=!1,this[v]=!0,this[B]=!1}get destroyed(){return this[T]}get flowing(){return this[w]}get paused(){return this[v]}[O](e){this[$]?this[b]+=1:this[b]+=e.length,this[y].push(e)}[I](){return this[$]?this[b]-=1:this[b]-=this[y][0].length,this[y].shift()}[m](e=!1){do{}while(this[g](this[I]())&&this[y].length);e||this[y].length||this[h]||this.emit("drain")}[g](e){return this.emit("data",e),this[w]}pipe(e,t){if(this[T])return e;this[B]=!1;const s=this[c];return t=t||{},e===i.stdout||e===i.stderr?t.end=!1:t.end=!1!==t.end,t.proxyErrors=!!t.proxyErrors,s?t.end&&e.end():(this[R].push(t.proxyErrors?new V(this,e,t):new j(this,e,t)),this[L]?F((()=>this[_]())):this[_]()),e}unpipe(e){const t=this[R].find((t=>t.dest===e));t&&(1===this[R].length?(this[w]&&0===this[M]&&(this[w]=!1),this[R]=[]):this[R].splice(this[R].indexOf(t),1),t.unpipe())}addListener(e,t){return this.on(e,t)}on(e,t){const s=super.on(e,t);if("data"===e)this[B]=!1,this[M]++,this[R].length||this[w]||this[_]();else if("readable"===e&&0!==this[b])super.emit("readable");else if((e=>"end"===e||"finish"===e||"prefinish"===e)(e)&&this[c])super.emit(e),this.removeAllListeners(e);else if("error"===e&&this[d]){const e=t;this[L]?F((()=>e.call(this,this[d]))):e.call(this,this[d])}return s}removeListener(e,t){return this.off(e,t)}off(e,t){const s=super.off(e,t);return"data"===e&&(this[M]=this.listeners("data").length,0!==this[M]||this[B]||this[R].length||(this[w]=!1)),s}removeAllListeners(e){const t=super.removeAllListeners(e);return"data"!==e&&void 0!==e||(this[M]=0,this[B]||this[R].length||(this[w]=!1)),t}get emittedEnd(){return this[c]}[l](){this[u]||this[c]||this[T]||0!==this[y].length||!this[h]||(this[u]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[f]&&this.emit("close"),this[u]=!1)}emit(e,...t){const s=t[0];if("error"!==e&&"close"!==e&&e!==T&&this[T])return!1;if("data"===e)return!(!this[$]&&!s)&&(this[L]?(F((()=>this[k](s))),!0):this[k](s));if("end"===e)return this[P]();if("close"===e){if(this[f]=!0,!this[c]&&!this[T])return!1;const e=super.emit("close");return this.removeAllListeners("close"),e}if("error"===e){this[d]=s,super.emit(C,s);const e=!(this[D]&&!this.listeners("error").length)&&super.emit("error",s);return this[l](),e}if("resume"===e){const e=super.emit("resume");return this[l](),e}if("finish"===e||"prefinish"===e){const t=super.emit(e);return this.removeAllListeners(e),t}const r=super.emit(e,...t);return this[l](),r}[k](e){for(const t of this[R])!1===t.dest.write(e)&&this.pause();const t=!this[B]&&super.emit("data",e);return this[l](),t}[P](){return!this[c]&&(this[c]=!0,this.readable=!1,this[L]?(F((()=>this[A]())),!0):this[A]())}[A](){if(this[E]){const e=this[E].end();if(e){for(const t of this[R])t.dest.write(e);this[B]||super.emit("data",e)}}for(const e of this[R])e.end();const e=super.emit("end");return this.removeAllListeners("end"),e}async collect(){const e=Object.assign([],{dataLength:0});this[$]||(e.dataLength=0);const t=this.promise();return this.on("data",(t=>{e.push(t),this[$]||(e.dataLength+=t.length)})),await t,e}async concat(){if(this[$])throw new Error("cannot concat in objectMode");const e=await this.collect();return this[S]?e.join(""):Buffer.concat(e,e.dataLength)}async promise(){return new Promise(((e,t)=>{this.on(T,(()=>t(new Error("stream destroyed")))),this.on("error",(e=>t(e))),this.on("end",(()=>e()))}))}[Symbol.asyncIterator](){this[B]=!1;let e=!1;const t=async()=>(this.pause(),e=!0,{value:void 0,done:!0});return{next:()=>{if(e)return t();const s=this.read();if(null!==s)return Promise.resolve({done:!1,value:s});if(this[h])return t();let r,i;const n=e=>{this.off("data",o),this.off("end",a),this.off(T,l),t(),i(e)},o=e=>{this.off("error",n),this.off("end",a),this.off(T,l),this.pause(),r({value:e,done:!!this[h]})},a=()=>{this.off("error",n),this.off("data",o),this.off(T,l),t(),r({done:!0,value:void 0})},l=()=>n(new Error("stream destroyed"));return new Promise(((e,t)=>{i=t,r=e,this.once(T,l),this.once("error",n),this.once("end",a),this.once("data",o)}))},throw:t,return:t,[Symbol.asyncIterator](){return this}}}[Symbol.iterator](){this[B]=!1;let e=!1;const t=()=>(this.pause(),this.off(C,t),this.off(T,t),this.off("end",t),e=!0,{done:!0,value:void 0});return this.once("end",t),this.once(C,t),this.once(T,t),{next:()=>{if(e)return t();const s=this.read();return null===s?t():{done:!1,value:s}},throw:t,return:t,[Symbol.iterator](){return this}}}destroy(e){return this[T]?(e?this.emit("error",e):this.emit(T),this):(this[T]=!0,this[B]=!0,this[y].length=0,this[b]=0,"function"!=typeof this.close||this[f]||this.close(),e?this.emit("error",e):this.emit(T),this)}static get isStream(){return t.isStream}}t.Minipass=H},7736:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReceiveBuffer=void 0,t.ReceiveBuffer=class{constructor(e=4096){this.buffer=Buffer.allocUnsafe(e),this.offset=0,this.originalSize=e}get length(){return this.offset}append(e){if(!Buffer.isBuffer(e))throw new Error("Attempted to append a non-buffer instance to ReceiveBuffer.");if(this.offset+e.length>=this.buffer.length){const t=this.buffer;this.buffer=Buffer.allocUnsafe(Math.max(this.buffer.length+this.originalSize,this.buffer.length+e.length)),t.copy(this.buffer)}return e.copy(this.buffer,this.offset),this.offset+=e.length}peek(e){if(e>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");return this.buffer.slice(0,e)}get(e){if(e>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");const t=Buffer.allocUnsafe(e);return this.buffer.slice(0,e).copy(t),this.buffer.copyWithin(0,e,e+this.offset-e),this.offset-=e,t}}},8311:(e,t,s)=>{"use strict";const r=/\s+/g;class i{constructor(e,t){if(t=o(t),e instanceof i)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new i(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(r," "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!S(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&E(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&m)|(this.options.loose&&g))+":"+e,s=n.get(t);if(s)return s;const r=this.options.loose,i=r?c[u.HYPHENRANGELOOSE]:c[u.HYPHENRANGE];e=e.replace(i,k(this.options.includePrerelease)),h("hyphen replace",e),e=e.replace(c[u.COMPARATORTRIM],d),h("comparator trim",e),e=e.replace(c[u.TILDETRIM],f),h("tilde trim",e),e=e.replace(c[u.CARETTRIM],p),h("caret trim",e);let o=e.split(" ").map((e=>v(e,this.options))).join(" ").split(/\s+/).map((e=>C(e,this.options)));r&&(o=o.filter((e=>(h("loose invalid filter",e,this.options),!!e.match(c[u.COMPARATORLOOSE]))))),h("range list",o);const l=new Map,E=o.map((e=>new a(e,this.options)));for(const e of E){if(S(e))return[e];l.set(e.value,e)}l.size>1&&l.has("")&&l.delete("");const w=[...l.values()];return n.set(t,w),w}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Range is required");return this.set.some((s=>w(s,t)&&e.set.some((e=>w(e,t)&&s.every((s=>e.every((e=>s.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(P(this.set[t],e,this.options))return!0;return!1}}e.exports=i;const n=new(s(8794)),o=s(8587),a=s(3904),h=s(7272),l=s(3908),{safeRe:c,t:u,comparatorTrimReplace:d,tildeTrimReplace:f,caretTrimReplace:p}=s(9718),{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:g}=s(6874),S=e=>"<0.0.0-0"===e.value,E=e=>""===e.value,w=(e,t)=>{let s=!0;const r=e.slice();let i=r.pop();for(;s&&r.length;)s=r.every((e=>i.intersects(e,t))),i=r.pop();return s},v=(e,t)=>(h("comp",e,t),e=b(e,t),h("caret",e),e=y(e,t),h("tildes",e),e=I(e,t),h("xrange",e),e=T(e,t),h("stars",e),e),_=e=>!e||"x"===e.toLowerCase()||"*"===e,y=(e,t)=>e.trim().split(/\s+/).map((e=>R(e,t))).join(" "),R=(e,t)=>{const s=t.loose?c[u.TILDELOOSE]:c[u.TILDE];return e.replace(s,((t,s,r,i,n)=>{let o;return h("tilde",e,t,s,r,i,n),_(s)?o="":_(r)?o=`>=${s}.0.0 <${+s+1}.0.0-0`:_(i)?o=`>=${s}.${r}.0 <${s}.${+r+1}.0-0`:n?(h("replaceTilde pr",n),o=`>=${s}.${r}.${i}-${n} <${s}.${+r+1}.0-0`):o=`>=${s}.${r}.${i} <${s}.${+r+1}.0-0`,h("tilde return",o),o}))},b=(e,t)=>e.trim().split(/\s+/).map((e=>O(e,t))).join(" "),O=(e,t)=>{h("caret",e,t);const s=t.loose?c[u.CARETLOOSE]:c[u.CARET],r=t.includePrerelease?"-0":"";return e.replace(s,((t,s,i,n,o)=>{let a;return h("caret",e,t,s,i,n,o),_(s)?a="":_(i)?a=`>=${s}.0.0${r} <${+s+1}.0.0-0`:_(n)?a="0"===s?`>=${s}.${i}.0${r} <${s}.${+i+1}.0-0`:`>=${s}.${i}.0${r} <${+s+1}.0.0-0`:o?(h("replaceCaret pr",o),a="0"===s?"0"===i?`>=${s}.${i}.${n}-${o} <${s}.${i}.${+n+1}-0`:`>=${s}.${i}.${n}-${o} <${s}.${+i+1}.0-0`:`>=${s}.${i}.${n}-${o} <${+s+1}.0.0-0`):(h("no pr"),a="0"===s?"0"===i?`>=${s}.${i}.${n}${r} <${s}.${i}.${+n+1}-0`:`>=${s}.${i}.${n}${r} <${s}.${+i+1}.0-0`:`>=${s}.${i}.${n} <${+s+1}.0.0-0`),h("caret return",a),a}))},I=(e,t)=>(h("replaceXRanges",e,t),e.split(/\s+/).map((e=>$(e,t))).join(" ")),$=(e,t)=>{e=e.trim();const s=t.loose?c[u.XRANGELOOSE]:c[u.XRANGE];return e.replace(s,((s,r,i,n,o,a)=>{h("xRange",e,s,r,i,n,o,a);const l=_(i),c=l||_(n),u=c||_(o),d=u;return"="===r&&d&&(r=""),a=t.includePrerelease?"-0":"",l?s=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(c&&(n=0),o=0,">"===r?(r=">=",c?(i=+i+1,n=0,o=0):(n=+n+1,o=0)):"<="===r&&(r="<",c?i=+i+1:n=+n+1),"<"===r&&(a="-0"),s=`${r+i}.${n}.${o}${a}`):c?s=`>=${i}.0.0${a} <${+i+1}.0.0-0`:u&&(s=`>=${i}.${n}.0${a} <${i}.${+n+1}.0-0`),h("xRange return",s),s}))},T=(e,t)=>(h("replaceStars",e,t),e.trim().replace(c[u.STAR],"")),C=(e,t)=>(h("replaceGTE0",e,t),e.trim().replace(c[t.includePrerelease?u.GTE0PRE:u.GTE0],"")),k=e=>(t,s,r,i,n,o,a,h,l,c,u,d)=>`${s=_(r)?"":_(i)?`>=${r}.0.0${e?"-0":""}`:_(n)?`>=${r}.${i}.0${e?"-0":""}`:o?`>=${s}`:`>=${s}${e?"-0":""}`} ${h=_(l)?"":_(c)?`<${+l+1}.0.0-0`:_(u)?`<${l}.${+c+1}.0-0`:d?`<=${l}.${c}.${u}-${d}`:e?`<${l}.${c}.${+u+1}-0`:`<=${h}`}`.trim(),P=(e,t,s)=>{for(let s=0;s<e.length;s++)if(!e[s].test(t))return!1;if(t.prerelease.length&&!s.includePrerelease){for(let s=0;s<e.length;s++)if(h(e[s].semver),e[s].semver!==a.ANY&&e[s].semver.prerelease.length>0){const r=e[s].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}},8422:(e,t,s)=>{var r=s(8505);e.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),g(function(e){return e.split("\\\\").join(i).split("\\{").join(n).split("\\}").join(o).split("\\,").join(a).split("\\.").join(h)}(e),!0).map(c)):[]};var i="\0SLASH"+Math.random()+"\0",n="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",a="\0COMMA"+Math.random()+"\0",h="\0PERIOD"+Math.random()+"\0";function l(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function c(e){return e.split(i).join("\\").split(n).join("{").split(o).join("}").split(a).join(",").split(h).join(".")}function u(e){if(!e)return[""];var t=[],s=r("{","}",e);if(!s)return e.split(",");var i=s.pre,n=s.body,o=s.post,a=i.split(",");a[a.length-1]+="{"+n+"}";var h=u(o);return o.length&&(a[a.length-1]+=h.shift(),a.push.apply(a,h)),t.push.apply(t,a),t}function d(e){return"{"+e+"}"}function f(e){return/^-?0\d/.test(e)}function p(e,t){return e<=t}function m(e,t){return e>=t}function g(e,t){var s=[],i=r("{","}",e);if(!i)return[e];var n=i.pre,a=i.post.length?g(i.post,!1):[""];if(/\$$/.test(i.pre))for(var h=0;h<a.length;h++){var c=n+"{"+i.body+"}"+a[h];s.push(c)}else{var S,E,w=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),v=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),_=w||v,y=i.body.indexOf(",")>=0;if(!_&&!y)return i.post.match(/,.*\}/)?g(e=i.pre+"{"+i.body+o+i.post):[e];if(_)S=i.body.split(/\.\./);else if(1===(S=u(i.body)).length&&1===(S=g(S[0],!1).map(d)).length)return a.map((function(e){return i.pre+S[0]+e}));if(_){var R=l(S[0]),b=l(S[1]),O=Math.max(S[0].length,S[1].length),I=3==S.length?Math.abs(l(S[2])):1,$=p;b<R&&(I*=-1,$=m);var T=S.some(f);E=[];for(var C=R;$(C,b);C+=I){var k;if(v)"\\"===(k=String.fromCharCode(C))&&(k="");else if(k=String(C),T){var P=O-k.length;if(P>0){var A=new Array(P+1).join("0");k=C<0?"-"+A+k.slice(1):A+k}}E.push(k)}}else{E=[];for(var L=0;L<S.length;L++)E.push.apply(E,g(S[L],!1))}for(L=0;L<E.length;L++)for(h=0;h<a.length;h++)c=n+E[L]+a[h],(!t||_||c)&&s.push(c)}return s}},8431:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.generateConnectionReport=async function(e,t){const s=(0,d.getSSHConfigPath)(),r=await(0,u.showHostPicker)(t,s);if(!r)return;t.show();const{server:i,address:n}=await async function(e){const t=f.createServer((async(t,s)=>{if(e.info(`Askpass server received request: ${t.method} ${t.url}`),"POST"===t.method){let r="";for await(const e of t)r+=e.toString();e.info(`Askpass server received request body: ${r}`);try{const t=JSON.parse(r);if(e.info(`Received SSH askpass request: ${t.request}`),t.request.includes("The authenticity of host")&&t.request.includes("can't be established"))"Yes"===await a.window.showQuickPick(["Yes","No"],{title:t.request+" Do you want to trust this host?",placeHolder:"Yes"})?(s.writeHead(200,{"Content-Type":"text/plain"}),s.end("yes")):(s.writeHead(200,{"Content-Type":"text/plain"}),s.end("no"));else{const r=await a.window.showInputBox({title:t.request,password:!0,ignoreFocusOut:!0});void 0===r?(e.error("Password authentication cancelled"),s.writeHead(500,{"Content-Type":"text/plain"}),s.end("Password authentication cancelled")):(s.writeHead(200,{"Content-Type":"text/plain"}),s.end(r||""))}}catch(t){e.error(`Error parsing request: ${t}`),s.writeHead(400,{"Content-Type":"text/plain"}),s.end("Invalid request format")}}else s.writeHead(405,{"Content-Type":"text/plain"}),s.end("Method Not Allowed")})),s=new Promise(((s,r)=>{t.on("error",(t=>{e.error("SSH askpass server threw an error",t),r(t)})),t.on("listening",(()=>{const i=t.address();if(null!==i){if("string"==typeof i)return e.info(`SSH askpass server listening on ${i}`),void s(i);e.info(`SSH askpass server listening on port ${i.port}`),s(i.port.toString())}else r(new Error(`Invalid address: ${i}`))}))}));if(p.isWindows)t.listen(0,"127.0.0.1");else{const e=await c.promises.mkdtemp(l.join(m.tmpdir(),"cursor-ssh-")),s=l.join(e,"socket.sock");t.listen(s)}return{server:t,address:await s}}(t),o=[];try{await a.window.withProgress({location:a.ProgressLocation.Notification,title:"Generating connection report...",cancellable:!1},(async()=>{const i=a.workspace.getConfiguration("remote.SSH"),c=i.get("path","ssh"),u=i.get("showLoginTerminal",!1),f=new h.SSHConnectionFactory(t,{sshPath:c,sshConfigPath:s,destination:r.toConnectionString(),showLoginTerminal:u,host:r.hostname,extensionPath:e.extensionPath});if(await(0,g.getRemotePlatform)({extensionConfig:i,host:f.config.host,logger:t,shouldPrompt:!0})===g.Platform.Windows)return void a.window.showErrorMessage("Connection reports are not supported on Windows remote hosts");t.info(`Generating connection report for ${r}...`);const m=(0,g.findAskpassScriptPath)(e.extensionPath),S=(0,g.findAskpassJSPath)(e.extensionPath),E=(w=e.extensionPath,l.join(w,"dist","scripts","connectionReport.sh"));var w;const v=(await d.default.loadFromFS(t,s)).getHostConfiguration(r.hostname),_=i.get("enableRemoteCommand",!1),y=(0,g.resolveProxySetting)(i.get("httpProxy"),f.config.host),R=(0,g.resolveProxySetting)(i.get("httpsProxy"),f.config.host),b=(0,g.resolveProxySetting)(i.get("noProxy"),f.config.host),O={SSH_ASKPASS:m,CURSOR_SSH_ASKPASS_JS:S,CURSOR_SSH_ASKPASS_HANDLE:n,SSH_ASKPASS_REQUIRE:"force",CURSOR_SSH_ELECTRON_PATH:process.execPath,DISPLAY:"1"};let I;y&&(O.HTTP_PROXY=y,O.http_proxy=y),R&&(O.HTTPS_PROXY=R,O.https_proxy=R),b&&(O.NO_PROXY=b,O.no_proxy=b),I=p.isWindows?`type "${E}" | `:`cat "${E}" | `;const{stdout:$,stderr:T,done:C}=await f.execHandler({remoteCommand:v.RemoteCommand,enableRemoteCommand:_,command:"bash --login -c bash",shellCmdPrefix:I,env:O,verbose:"trace"===i.get("logLevel")}),k=$((e=>{t.info(`[connectionReport][ssh] ${e}`),o.push(e)})),P=T((e=>{t.info(`[connectionReport][ssh] ${e}`),o.push(e)}));try{await C}finally{k.dispose(),P.dispose()}}))}catch(e){t.error("Failed to generate connection report",e),await a.window.showErrorMessage("Failed to generate connection report -- please check the logs")}finally{i.close()}const S=`Cursor Remote SSH Connection Diagnostic Report - ${r.hostname}\nGenerated on: ${(new Date).toISOString()}\n\n****************************************************************************\n* WARNING: This report may contain sensitive information.                  *\n* Please review and redact any sensitive information before sharing.       *\n****************************************************************************\n`+o.join(""),E=await a.workspace.openTextDocument({content:S,language:"plaintext"});await a.window.showTextDocument(E)};const a=o(s(1398)),h=s(3670),l=o(s(6928)),c=o(s(9896)),u=s(5187),d=o(s(3256)),f=o(s(8611)),p=s(3540),m=o(s(857)),g=s(9449)},8474:e=>{"use strict";e.exports=require("node:events")},8505:e=>{"use strict";function t(e,t,i){e instanceof RegExp&&(e=s(e,i)),t instanceof RegExp&&(t=s(t,i));var n=r(e,t,i);return n&&{start:n[0],end:n[1],pre:i.slice(0,n[0]),body:i.slice(n[0]+e.length,n[1]),post:i.slice(n[1]+t.length)}}function s(e,t){var s=t.match(e);return s?s[0]:null}function r(e,t,s){var r,i,n,o,a,h=s.indexOf(e),l=s.indexOf(t,h+1),c=h;if(h>=0&&l>0){if(e===t)return[h,l];for(r=[],n=s.length;c>=0&&!a;)c==h?(r.push(c),h=s.indexOf(e,c+1)):1==r.length?a=[r.pop(),l]:((i=r.pop())<n&&(n=i,o=l),l=s.indexOf(t,c+1)),c=h<l&&h>=0?h:l;r.length&&(a=[n,o])}return a}e.exports=t,t.range=r},8576:function(e,t,s){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&r(t,e,s);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PathScurry=t.Path=t.PathScurryDarwin=t.PathScurryPosix=t.PathScurryWin32=t.PathScurryBase=t.PathPosix=t.PathWin32=t.PathBase=t.ChildrenCache=t.ResolveCache=void 0;const o=s(9096),a=s(6760),h=s(3136),l=s(9896),c=n(s(3024)),u=l.realpathSync.native,d=s(1455),f=s(7694),p={lstatSync:l.lstatSync,readdir:l.readdir,readdirSync:l.readdirSync,readlinkSync:l.readlinkSync,realpathSync:u,promises:{lstat:d.lstat,readdir:d.readdir,readlink:d.readlink,realpath:d.realpath}},m=e=>e&&e!==p&&e!==c?{...p,...e,promises:{...p.promises,...e.promises||{}}}:p,g=/^\\\\\?\\([a-z]:)\\?$/i,S=/[\\\/]/,E=10,w=15,v=-16,_=128,y=e=>e.isFile()?8:e.isDirectory()?4:e.isSymbolicLink()?E:e.isCharacterDevice()?2:e.isBlockDevice()?6:e.isSocket()?12:e.isFIFO()?1:0,R=new Map,b=e=>{const t=R.get(e);if(t)return t;const s=e.normalize("NFKD");return R.set(e,s),s},O=new Map,I=e=>{const t=O.get(e);if(t)return t;const s=b(e.toLowerCase());return O.set(e,s),s};class $ extends o.LRUCache{constructor(){super({max:256})}}t.ResolveCache=$;class T extends o.LRUCache{constructor(e=16384){super({maxSize:e,sizeCalculation:e=>e.length+1})}}t.ChildrenCache=T;const C=Symbol("PathScurry setAsCwd");class k{name;root;roots;parent;nocase;isCWD=!1;#b;#O;get dev(){return this.#O}#I;get mode(){return this.#I}#$;get nlink(){return this.#$}#T;get uid(){return this.#T}#C;get gid(){return this.#C}#k;get rdev(){return this.#k}#P;get blksize(){return this.#P}#A;get ino(){return this.#A}#L;get size(){return this.#L}#x;get blocks(){return this.#x}#N;get atimeMs(){return this.#N}#D;get mtimeMs(){return this.#D}#M;get ctimeMs(){return this.#M}#B;get birthtimeMs(){return this.#B}#F;get atime(){return this.#F}#U;get mtime(){return this.#U}#j;get ctime(){return this.#j}#V;get birthtime(){return this.#V}#H;#G;#W;#z;#K;#X;#q;#Y;#Z;#J;get parentPath(){return(this.parent||this).fullpath()}get path(){return this.parentPath}constructor(e,t=0,s,r,i,n,o){this.name=e,this.#H=i?I(e):b(e),this.#q=1023&t,this.nocase=i,this.roots=r,this.root=s||this,this.#Y=n,this.#W=o.fullpath,this.#K=o.relative,this.#X=o.relativePosix,this.parent=o.parent,this.parent?this.#b=this.parent.#b:this.#b=m(o.fs)}depth(){return void 0!==this.#G?this.#G:this.parent?this.#G=this.parent.depth()+1:this.#G=0}childrenCache(){return this.#Y}resolve(e){if(!e)return this;const t=this.getRootString(e),s=e.substring(t.length).split(this.splitSep);return t?this.getRoot(t).#Q(s):this.#Q(s)}#Q(e){let t=this;for(const s of e)t=t.child(s);return t}children(){const e=this.#Y.get(this);if(e)return e;const t=Object.assign([],{provisional:0});return this.#Y.set(this,t),this.#q&=-17,t}child(e,t){if(""===e||"."===e)return this;if(".."===e)return this.parent||this;const s=this.children(),r=this.nocase?I(e):b(e);for(const e of s)if(e.#H===r)return e;const i=this.parent?this.sep:"",n=this.#W?this.#W+i+e:void 0,o=this.newChild(e,0,{...t,parent:this,fullpath:n});return this.canReaddir()||(o.#q|=_),s.push(o),o}relative(){if(this.isCWD)return"";if(void 0!==this.#K)return this.#K;const e=this.name,t=this.parent;if(!t)return this.#K=this.name;const s=t.relative();return s+(s&&t.parent?this.sep:"")+e}relativePosix(){if("/"===this.sep)return this.relative();if(this.isCWD)return"";if(void 0!==this.#X)return this.#X;const e=this.name,t=this.parent;if(!t)return this.#X=this.fullpathPosix();const s=t.relativePosix();return s+(s&&t.parent?"/":"")+e}fullpath(){if(void 0!==this.#W)return this.#W;const e=this.name,t=this.parent;if(!t)return this.#W=this.name;const s=t.fullpath()+(t.parent?this.sep:"")+e;return this.#W=s}fullpathPosix(){if(void 0!==this.#z)return this.#z;if("/"===this.sep)return this.#z=this.fullpath();if(!this.parent){const e=this.fullpath().replace(/\\/g,"/");return/^[a-z]:\//i.test(e)?this.#z=`//?/${e}`:this.#z=e}const e=this.parent,t=e.fullpathPosix(),s=t+(t&&e.parent?"/":"")+this.name;return this.#z=s}isUnknown(){return!(this.#q&w)}isType(e){return this[`is${e}`]()}getType(){return this.isUnknown()?"Unknown":this.isDirectory()?"Directory":this.isFile()?"File":this.isSymbolicLink()?"SymbolicLink":this.isFIFO()?"FIFO":this.isCharacterDevice()?"CharacterDevice":this.isBlockDevice()?"BlockDevice":this.isSocket()?"Socket":"Unknown"}isFile(){return 8==(this.#q&w)}isDirectory(){return 4==(this.#q&w)}isCharacterDevice(){return 2==(this.#q&w)}isBlockDevice(){return 6==(this.#q&w)}isFIFO(){return 1==(this.#q&w)}isSocket(){return 12==(this.#q&w)}isSymbolicLink(){return(this.#q&E)===E}lstatCached(){return 32&this.#q?this:void 0}readlinkCached(){return this.#Z}realpathCached(){return this.#J}readdirCached(){const e=this.children();return e.slice(0,e.provisional)}canReadlink(){if(this.#Z)return!0;if(!this.parent)return!1;const e=this.#q&w;return!(0!==e&&e!==E||256&this.#q||this.#q&_)}calledReaddir(){return!!(16&this.#q)}isENOENT(){return!!(this.#q&_)}isNamed(e){return this.nocase?this.#H===I(e):this.#H===b(e)}async readlink(){const e=this.#Z;if(e)return e;if(this.canReadlink()&&this.parent)try{const e=await this.#b.promises.readlink(this.fullpath()),t=(await this.parent.realpath())?.resolve(e);if(t)return this.#Z=t}catch(e){return void this.#ee(e.code)}}readlinkSync(){const e=this.#Z;if(e)return e;if(this.canReadlink()&&this.parent)try{const e=this.#b.readlinkSync(this.fullpath()),t=this.parent.realpathSync()?.resolve(e);if(t)return this.#Z=t}catch(e){return void this.#ee(e.code)}}#te(e){this.#q|=16;for(let t=e.provisional;t<e.length;t++){const s=e[t];s&&s.#se()}}#se(){this.#q&_||(this.#q=(this.#q|_)&v,this.#re())}#re(){const e=this.children();e.provisional=0;for(const t of e)t.#se()}#ie(){this.#q|=512,this.#ne()}#ne(){if(64&this.#q)return;let e=this.#q;4==(e&w)&&(e&=v),this.#q=64|e,this.#re()}#oe(e=""){"ENOTDIR"===e||"EPERM"===e?this.#ne():"ENOENT"===e?this.#se():this.children().provisional=0}#ae(e=""){"ENOTDIR"===e?this.parent.#ne():"ENOENT"===e&&this.#se()}#ee(e=""){let t=this.#q;t|=256,"ENOENT"===e&&(t|=_),"EINVAL"!==e&&"UNKNOWN"!==e||(t&=v),this.#q=t,"ENOTDIR"===e&&this.parent&&this.parent.#ne()}#he(e,t){return this.#le(e,t)||this.#ce(e,t)}#ce(e,t){const s=y(e),r=this.newChild(e.name,s,{parent:this}),i=r.#q&w;return 4!==i&&i!==E&&0!==i&&(r.#q|=64),t.unshift(r),t.provisional++,r}#le(e,t){for(let s=t.provisional;s<t.length;s++){const r=t[s];if((this.nocase?I(e.name):b(e.name))===r.#H)return this.#ue(e,r,s,t)}}#ue(e,t,s,r){const i=t.name;return t.#q=t.#q&v|y(e),i!==e.name&&(t.name=e.name),s!==r.provisional&&(s===r.length-1?r.pop():r.splice(s,1),r.unshift(t)),r.provisional++,t}async lstat(){if(!(this.#q&_))try{return this.#de(await this.#b.promises.lstat(this.fullpath())),this}catch(e){this.#ae(e.code)}}lstatSync(){if(!(this.#q&_))try{return this.#de(this.#b.lstatSync(this.fullpath())),this}catch(e){this.#ae(e.code)}}#de(e){const{atime:t,atimeMs:s,birthtime:r,birthtimeMs:i,blksize:n,blocks:o,ctime:a,ctimeMs:h,dev:l,gid:c,ino:u,mode:d,mtime:f,mtimeMs:p,nlink:m,rdev:g,size:S,uid:w}=e;this.#F=t,this.#N=s,this.#V=r,this.#B=i,this.#P=n,this.#x=o,this.#j=a,this.#M=h,this.#O=l,this.#C=c,this.#A=u,this.#I=d,this.#U=f,this.#D=p,this.#$=m,this.#k=g,this.#L=S,this.#T=w;const _=y(e);this.#q=this.#q&v|_|32,0!==_&&4!==_&&_!==E&&(this.#q|=64)}#fe=[];#pe=!1;#me(e){this.#pe=!1;const t=this.#fe.slice();this.#fe.length=0,t.forEach((t=>t(null,e)))}readdirCB(e,t=!1){if(!this.canReaddir())return void(t?e(null,[]):queueMicrotask((()=>e(null,[]))));const s=this.children();if(this.calledReaddir()){const r=s.slice(0,s.provisional);return void(t?e(null,r):queueMicrotask((()=>e(null,r))))}if(this.#fe.push(e),this.#pe)return;this.#pe=!0;const r=this.fullpath();this.#b.readdir(r,{withFileTypes:!0},((e,t)=>{if(e)this.#oe(e.code),s.provisional=0;else{for(const e of t)this.#he(e,s);this.#te(s)}this.#me(s.slice(0,s.provisional))}))}#ge;async readdir(){if(!this.canReaddir())return[];const e=this.children();if(this.calledReaddir())return e.slice(0,e.provisional);const t=this.fullpath();if(this.#ge)await this.#ge;else{let s=()=>{};this.#ge=new Promise((e=>s=e));try{for(const s of await this.#b.promises.readdir(t,{withFileTypes:!0}))this.#he(s,e);this.#te(e)}catch(t){this.#oe(t.code),e.provisional=0}this.#ge=void 0,s()}return e.slice(0,e.provisional)}readdirSync(){if(!this.canReaddir())return[];const e=this.children();if(this.calledReaddir())return e.slice(0,e.provisional);const t=this.fullpath();try{for(const s of this.#b.readdirSync(t,{withFileTypes:!0}))this.#he(s,e);this.#te(e)}catch(t){this.#oe(t.code),e.provisional=0}return e.slice(0,e.provisional)}canReaddir(){if(704&this.#q)return!1;const e=w&this.#q;return 0===e||4===e||e===E}shouldWalk(e,t){return!(4&~this.#q)&&!(704&this.#q)&&!e.has(this)&&(!t||t(this))}async realpath(){if(this.#J)return this.#J;if(!(896&this.#q))try{const e=await this.#b.promises.realpath(this.fullpath());return this.#J=this.resolve(e)}catch(e){this.#ie()}}realpathSync(){if(this.#J)return this.#J;if(!(896&this.#q))try{const e=this.#b.realpathSync(this.fullpath());return this.#J=this.resolve(e)}catch(e){this.#ie()}}[C](e){if(e===this)return;e.isCWD=!1,this.isCWD=!0;const t=new Set([]);let s=[],r=this;for(;r&&r.parent;)t.add(r),r.#K=s.join(this.sep),r.#X=s.join("/"),r=r.parent,s.push("..");for(r=e;r&&r.parent&&!t.has(r);)r.#K=void 0,r.#X=void 0,r=r.parent}}t.PathBase=k;class P extends k{sep="\\";splitSep=S;constructor(e,t=0,s,r,i,n,o){super(e,t,s,r,i,n,o)}newChild(e,t=0,s={}){return new P(e,t,this.root,this.roots,this.nocase,this.childrenCache(),s)}getRootString(e){return a.win32.parse(e).root}getRoot(e){if((e=(e=>e.replace(/\//g,"\\").replace(g,"$1\\"))(e.toUpperCase()))===this.root.name)return this.root;for(const[t,s]of Object.entries(this.roots))if(this.sameRoot(e,t))return this.roots[e]=s;return this.roots[e]=new x(e,this).root}sameRoot(e,t=this.root.name){return(e=e.toUpperCase().replace(/\//g,"\\").replace(g,"$1\\"))===t}}t.PathWin32=P;class A extends k{splitSep="/";sep="/";constructor(e,t=0,s,r,i,n,o){super(e,t,s,r,i,n,o)}getRootString(e){return e.startsWith("/")?"/":""}getRoot(e){return this.root}newChild(e,t=0,s={}){return new A(e,t,this.root,this.roots,this.nocase,this.childrenCache(),s)}}t.PathPosix=A;class L{root;rootPath;roots;cwd;#Se;#Ee;#Y;nocase;#b;constructor(e=process.cwd(),t,s,{nocase:r,childrenCacheSize:i=16384,fs:n=p}={}){this.#b=m(n),(e instanceof URL||e.startsWith("file://"))&&(e=(0,h.fileURLToPath)(e));const o=t.resolve(e);this.roots=Object.create(null),this.rootPath=this.parseRootPath(o),this.#Se=new $,this.#Ee=new $,this.#Y=new T(i);const a=o.substring(this.rootPath.length).split(s);if(1!==a.length||a[0]||a.pop(),void 0===r)throw new TypeError("must provide nocase setting to PathScurryBase ctor");this.nocase=r,this.root=this.newRoot(this.#b),this.roots[this.rootPath]=this.root;let l=this.root,c=a.length-1;const u=t.sep;let d=this.rootPath,f=!1;for(const e of a){const t=c--;l=l.child(e,{relative:new Array(t).fill("..").join(u),relativePosix:new Array(t).fill("..").join("/"),fullpath:d+=(f?"":u)+e}),f=!0}this.cwd=l}depth(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.depth()}childrenCache(){return this.#Y}resolve(...e){let t="";for(let s=e.length-1;s>=0;s--){const r=e[s];if(r&&"."!==r&&(t=t?`${r}/${t}`:r,this.isAbsolute(r)))break}const s=this.#Se.get(t);if(void 0!==s)return s;const r=this.cwd.resolve(t).fullpath();return this.#Se.set(t,r),r}resolvePosix(...e){let t="";for(let s=e.length-1;s>=0;s--){const r=e[s];if(r&&"."!==r&&(t=t?`${r}/${t}`:r,this.isAbsolute(r)))break}const s=this.#Ee.get(t);if(void 0!==s)return s;const r=this.cwd.resolve(t).fullpathPosix();return this.#Ee.set(t,r),r}relative(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.relative()}relativePosix(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.relativePosix()}basename(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.name}dirname(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),(e.parent||e).fullpath()}async readdir(e=this.cwd,t={withFileTypes:!0}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e,e=this.cwd);const{withFileTypes:s}=t;if(e.canReaddir()){const t=await e.readdir();return s?t:t.map((e=>e.name))}return[]}readdirSync(e=this.cwd,t={withFileTypes:!0}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e,e=this.cwd);const{withFileTypes:s=!0}=t;return e.canReaddir()?s?e.readdirSync():e.readdirSync().map((e=>e.name)):[]}async lstat(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.lstat()}lstatSync(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.lstatSync()}async readlink(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e.withFileTypes,e=this.cwd);const s=await e.readlink();return t?s:s?.fullpath()}readlinkSync(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e.withFileTypes,e=this.cwd);const s=e.readlinkSync();return t?s:s?.fullpath()}async realpath(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e.withFileTypes,e=this.cwd);const s=await e.realpath();return t?s:s?.fullpath()}realpathSync(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e.withFileTypes,e=this.cwd);const s=e.realpathSync();return t?s:s?.fullpath()}async walk(e=this.cwd,t={}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e,e=this.cwd);const{withFileTypes:s=!0,follow:r=!1,filter:i,walkFilter:n}=t,o=[];i&&!i(e)||o.push(s?e:e.fullpath());const a=new Set,h=(e,t)=>{a.add(e),e.readdirCB(((e,l)=>{if(e)return t(e);let c=l.length;if(!c)return t();const u=()=>{0==--c&&t()};for(const e of l)i&&!i(e)||o.push(s?e:e.fullpath()),r&&e.isSymbolicLink()?e.realpath().then((e=>e?.isUnknown()?e.lstat():e)).then((e=>e?.shouldWalk(a,n)?h(e,u):u())):e.shouldWalk(a,n)?h(e,u):u()}),!0)},l=e;return new Promise(((e,t)=>{h(l,(s=>{if(s)return t(s);e(o)}))}))}walkSync(e=this.cwd,t={}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e,e=this.cwd);const{withFileTypes:s=!0,follow:r=!1,filter:i,walkFilter:n}=t,o=[];i&&!i(e)||o.push(s?e:e.fullpath());const a=new Set([e]);for(const e of a){const t=e.readdirSync();for(const e of t){i&&!i(e)||o.push(s?e:e.fullpath());let t=e;if(e.isSymbolicLink()){if(!r||!(t=e.realpathSync()))continue;t.isUnknown()&&t.lstatSync()}t.shouldWalk(a,n)&&a.add(t)}}return o}[Symbol.asyncIterator](){return this.iterate()}iterate(e=this.cwd,t={}){return"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e,e=this.cwd),this.stream(e,t)[Symbol.asyncIterator]()}[Symbol.iterator](){return this.iterateSync()}*iterateSync(e=this.cwd,t={}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e,e=this.cwd);const{withFileTypes:s=!0,follow:r=!1,filter:i,walkFilter:n}=t;i&&!i(e)||(yield s?e:e.fullpath());const o=new Set([e]);for(const e of o){const t=e.readdirSync();for(const e of t){i&&!i(e)||(yield s?e:e.fullpath());let t=e;if(e.isSymbolicLink()){if(!r||!(t=e.realpathSync()))continue;t.isUnknown()&&t.lstatSync()}t.shouldWalk(o,n)&&o.add(t)}}}stream(e=this.cwd,t={}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e,e=this.cwd);const{withFileTypes:s=!0,follow:r=!1,filter:i,walkFilter:n}=t,o=new f.Minipass({objectMode:!0});i&&!i(e)||o.write(s?e:e.fullpath());const a=new Set,h=[e];let l=0;const c=()=>{let e=!1;for(;!e;){const t=h.shift();if(!t)return void(0===l&&o.end());l++,a.add(t);const u=(t,f,p=!1)=>{if(t)return o.emit("error",t);if(r&&!p){const e=[];for(const t of f)t.isSymbolicLink()&&e.push(t.realpath().then((e=>e?.isUnknown()?e.lstat():e)));if(e.length)return void Promise.all(e).then((()=>u(null,f,!0)))}for(const t of f)!t||i&&!i(t)||o.write(s?t:t.fullpath())||(e=!0);l--;for(const e of f){const t=e.realpathCached()||e;t.shouldWalk(a,n)&&h.push(t)}e&&!o.flowing?o.once("drain",c):d||c()};let d=!0;t.readdirCB(u,!0),d=!1}};return c(),o}streamSync(e=this.cwd,t={}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof k||(t=e,e=this.cwd);const{withFileTypes:s=!0,follow:r=!1,filter:i,walkFilter:n}=t,o=new f.Minipass({objectMode:!0}),a=new Set;i&&!i(e)||o.write(s?e:e.fullpath());const h=[e];let l=0;const c=()=>{let e=!1;for(;!e;){const t=h.shift();if(!t)return void(0===l&&o.end());l++,a.add(t);const c=t.readdirSync();for(const t of c)i&&!i(t)||o.write(s?t:t.fullpath())||(e=!0);l--;for(const e of c){let t=e;if(e.isSymbolicLink()){if(!r||!(t=e.realpathSync()))continue;t.isUnknown()&&t.lstatSync()}t.shouldWalk(a,n)&&h.push(t)}}e&&!o.flowing&&o.once("drain",c)};return c(),o}chdir(e=this.cwd){const t=this.cwd;this.cwd="string"==typeof e?this.cwd.resolve(e):e,this.cwd[C](t)}}t.PathScurryBase=L;class x extends L{sep="\\";constructor(e=process.cwd(),t={}){const{nocase:s=!0}=t;super(e,a.win32,"\\",{...t,nocase:s}),this.nocase=s;for(let e=this.cwd;e;e=e.parent)e.nocase=this.nocase}parseRootPath(e){return a.win32.parse(e).root.toUpperCase()}newRoot(e){return new P(this.rootPath,4,void 0,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")||e.startsWith("\\")||/^[a-z]:(\/|\\)/i.test(e)}}t.PathScurryWin32=x;class N extends L{sep="/";constructor(e=process.cwd(),t={}){const{nocase:s=!1}=t;super(e,a.posix,"/",{...t,nocase:s}),this.nocase=s}parseRootPath(e){return"/"}newRoot(e){return new A(this.rootPath,4,void 0,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")}}t.PathScurryPosix=N;class D extends N{constructor(e=process.cwd(),t={}){const{nocase:s=!0}=t;super(e,{...t,nocase:s})}}t.PathScurryDarwin=D,t.Path="win32"===process.platform?P:A,t.PathScurry="win32"===process.platform?x:"darwin"===process.platform?D:N},8587:e=>{"use strict";const t=Object.freeze({loose:!0}),s=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:s},8601:(e,t)=>{"use strict";function s(e,t){return e=function(e){for(let t of"\\()[]{}.+^$|")e=e.replace(new RegExp("\\"+t,"g"),"\\"+t);return e}(e),e=e.replace(/\*/g,".*").replace(/\?/g,".?"),new RegExp("^(?:"+e+")$").test(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const r=Array.isArray(e)?e:e.split(/,/);let i=!1;for(const e of r){if("!"==e[0]&&s(e.slice(1),t))return!1;s(e,t)&&(i=!0)}return i}},8611:e=>{"use strict";e.exports=require("http")},8641:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escape=void 0,t.escape=(e,{windowsPathsNoEscape:t=!1}={})=>t?e.replace(/[?*()[\]]/g,"[$&]"):e.replace(/[?*()[\]\\]/g,"\\$&")},8794:e=>{"use strict";e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},8878:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasMagic=void 0;const r=s(5551);t.hasMagic=(e,t={})=>{Array.isArray(e)||(e=[e]);for(const s of e)if(new r.Minimatch(s,t).hasMagic())return!0;return!1}},8914:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RE_URL_WITH_PORT=t.RE_URL=t.RE_ZONE_STRING=t.RE_SUBNET_STRING=t.RE_BAD_ADDRESS=t.RE_BAD_CHARACTERS=t.TYPES=t.SCOPES=t.GROUPS=t.BITS=void 0,t.BITS=128,t.GROUPS=8,t.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"},t.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"},t.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi,t.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi,t.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/,t.RE_ZONE_STRING=/%.*$/,t.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/),t.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)},9023:e=>{"use strict";e.exports=require("util")},9080:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GlobStream=t.GlobWalker=t.GlobUtil=void 0;const i=r(s(1055)),n=s(4892),o=s(6584);class a{path;patterns;opts;seen=new Set;paused=!1;aborted=!1;#we=[];#ve;#_e;signal;maxDepth;constructor(e,t,s){this.patterns=e,this.path=t,this.opts=s,this.#_e="win32"===s.platform?"\\":"/",s.ignore&&(this.#ve=((e,t)=>"string"==typeof e?new n.Ignore([e],t):Array.isArray(e)?new n.Ignore(e,t):e)(s.ignore,s)),this.maxDepth=s.maxDepth||1/0,s.signal&&(this.signal=s.signal,this.signal.addEventListener("abort",(()=>{this.#we.length=0})))}#ye(e){return this.seen.has(e)||!!this.#ve?.ignored?.(e)}#Re(e){return!!this.#ve?.childrenIgnored?.(e)}pause(){this.paused=!0}resume(){if(this.signal?.aborted)return;let e;for(this.paused=!1;!this.paused&&(e=this.#we.shift());)e()}onResume(e){this.signal?.aborted||(this.paused?this.#we.push(e):e())}async matchCheck(e,t){if(t&&this.opts.nodir)return;let s;if(this.opts.realpath){if(s=e.realpathCached()||await e.realpath(),!s)return;e=s}const r=e.isUnknown()||this.opts.stat;return this.matchCheckTest(r?await e.lstat():e,t)}matchCheckTest(e,t){return!e||!(this.maxDepth===1/0||e.depth()<=this.maxDepth)||t&&!e.canReaddir()||this.opts.nodir&&e.isDirectory()||this.#ye(e)?void 0:e}matchCheckSync(e,t){if(t&&this.opts.nodir)return;let s;if(this.opts.realpath){if(s=e.realpathCached()||e.realpathSync(),!s)return;e=s}const r=e.isUnknown()||this.opts.stat;return this.matchCheckTest(r?e.lstatSync():e,t)}matchFinish(e,t){if(this.#ye(e))return;const s=void 0===this.opts.absolute?t:this.opts.absolute;this.seen.add(e);const r=this.opts.mark&&e.isDirectory()?this.#_e:"";if(this.opts.withFileTypes)this.matchEmit(e);else if(s)this.matchEmit(e.fullpath()+r);else{const t=e.relative(),s=this.opts.dotRelative&&!t.startsWith(".."+this.#_e)?"."+this.#_e:"";this.matchEmit(!t&&r?"."+r:s+t+r)}}async match(e,t,s){const r=await this.matchCheck(e,s);r&&this.matchFinish(r,t)}matchSync(e,t,s){const r=this.matchCheckSync(e,s);r&&this.matchFinish(r,t)}walkCB(e,t,s){this.signal?.aborted&&s(),this.walkCB2(e,t,new o.Processor(this.opts),s)}walkCB2(e,t,s,r){if(this.#Re(e))return r();if(this.signal?.aborted&&r(),this.paused)return void this.onResume((()=>this.walkCB2(e,t,s,r)));s.processPatterns(e,t);let i=1;const n=()=>{0==--i&&r()};for(const[e,t,r]of s.matches.entries())this.#ye(e)||(i++,this.match(e,t,r).then((()=>n())));for(const e of s.subwalkTargets()){if(this.maxDepth!==1/0&&e.depth()>=this.maxDepth)continue;i++;const t=e.readdirCached();e.calledReaddir()?this.walkCB3(e,t,s,n):e.readdirCB(((t,r)=>this.walkCB3(e,r,s,n)),!0)}n()}walkCB3(e,t,s,r){s=s.filterEntries(e,t);let i=1;const n=()=>{0==--i&&r()};for(const[e,t,r]of s.matches.entries())this.#ye(e)||(i++,this.match(e,t,r).then((()=>n())));for(const[e,t]of s.subwalks.entries())i++,this.walkCB2(e,t,s.child(),n);n()}walkCBSync(e,t,s){this.signal?.aborted&&s(),this.walkCB2Sync(e,t,new o.Processor(this.opts),s)}walkCB2Sync(e,t,s,r){if(this.#Re(e))return r();if(this.signal?.aborted&&r(),this.paused)return void this.onResume((()=>this.walkCB2Sync(e,t,s,r)));s.processPatterns(e,t);let i=1;const n=()=>{0==--i&&r()};for(const[e,t,r]of s.matches.entries())this.#ye(e)||this.matchSync(e,t,r);for(const e of s.subwalkTargets()){if(this.maxDepth!==1/0&&e.depth()>=this.maxDepth)continue;i++;const t=e.readdirSync();this.walkCB3Sync(e,t,s,n)}n()}walkCB3Sync(e,t,s,r){s=s.filterEntries(e,t);let i=1;const n=()=>{0==--i&&r()};for(const[e,t,r]of s.matches.entries())this.#ye(e)||this.matchSync(e,t,r);for(const[e,t]of s.subwalks.entries())i++,this.walkCB2Sync(e,t,s.child(),n);n()}}t.GlobUtil=a,t.GlobWalker=class extends a{matches;constructor(e,t,s){super(e,t,s),this.matches=new Set}matchEmit(e){this.matches.add(e)}async walk(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&await this.path.lstat(),await new Promise(((e,t)=>{this.walkCB(this.path,this.patterns,(()=>{this.signal?.aborted?t(this.signal.reason):e(this.matches)}))})),this.matches}walkSync(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,(()=>{if(this.signal?.aborted)throw this.signal.reason})),this.matches}},t.GlobStream=class extends a{results;constructor(e,t,s){super(e,t,s),this.results=new i.default({signal:this.signal,objectMode:!0}),this.results.on("drain",(()=>this.resume())),this.results.on("resume",(()=>this.resume()))}matchEmit(e){this.results.write(e),this.results.flowing||this.pause()}stream(){const e=this.path;return e.isUnknown()?e.lstat().then((()=>{this.walkCB(e,this.patterns,(()=>this.results.end()))})):this.walkCB(e,this.patterns,(()=>this.results.end())),this.results}streamSync(){return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,(()=>this.results.end())),this.results}}},9096:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=void 0;const s="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,r=new Set,i="object"==typeof process&&process?process:{},n=(e,t,s,r)=>{"function"==typeof i.emitWarning?i.emitWarning(e,t,s,r):console.error(`[${s}] ${t}: ${e}`)};let o=globalThis.AbortController,a=globalThis.AbortSignal;if(void 0===o){a=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(e,t){this._onabort.push(t)}},o=class{constructor(){t()}signal=new a;abort(e){if(!this.signal.aborted){this.signal.reason=e,this.signal.aborted=!0;for(const t of this.signal._onabort)t(e);this.signal.onabort?.(e)}}};let e="1"!==i.env?.LRU_CACHE_IGNORE_AC_WARNING;const t=()=>{e&&(e=!1,n("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}Symbol("type");const h=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),l=e=>h(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?c:null:null;class c extends Array{constructor(e){super(e),this.fill(0)}}class u{heap;length;static#be=!1;static create(e){const t=l(e);if(!t)return[];u.#be=!0;const s=new u(e,t);return u.#be=!1,s}constructor(e,t){if(!u.#be)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class d{#Oe;#Ie;#$e;#Te;#Ce;#ke;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#L;#Pe;#Ae;#Le;#xe;#Ne;#De;#Me;#Be;#Fe;#Ue;#je;#Ve;#He;#Ge;#We;#ze;static unsafeExposeInternals(e){return{starts:e.#Ve,ttls:e.#He,sizes:e.#je,keyMap:e.#Ae,keyList:e.#Le,valList:e.#xe,next:e.#Ne,prev:e.#De,get head(){return e.#Me},get tail(){return e.#Be},free:e.#Fe,isBackgroundFetch:t=>e.#Ke(t),backgroundFetch:(t,s,r,i)=>e.#Xe(t,s,r,i),moveToTail:t=>e.#qe(t),indexes:t=>e.#Ye(t),rindexes:t=>e.#Ze(t),isStale:t=>e.#Je(t)}}get max(){return this.#Oe}get maxSize(){return this.#Ie}get calculatedSize(){return this.#Pe}get size(){return this.#L}get fetchMethod(){return this.#Ce}get memoMethod(){return this.#ke}get dispose(){return this.#$e}get disposeAfter(){return this.#Te}constructor(e){const{max:t=0,ttl:s,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:f,dispose:p,disposeAfter:m,noDisposeOnSet:g,noUpdateTTL:S,maxSize:E=0,maxEntrySize:w=0,sizeCalculation:v,fetchMethod:_,memoMethod:y,noDeleteOnFetchRejection:R,noDeleteOnStaleGet:b,allowStaleOnFetchRejection:O,allowStaleOnFetchAbort:I,ignoreFetchAbort:$}=e;if(0!==t&&!h(t))throw new TypeError("max option must be a nonnegative integer");const T=t?l(t):Array;if(!T)throw new Error("invalid max value: "+t);if(this.#Oe=t,this.#Ie=E,this.maxEntrySize=w||this.#Ie,this.sizeCalculation=v,this.sizeCalculation){if(!this.#Ie&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(void 0!==y&&"function"!=typeof y)throw new TypeError("memoMethod must be a function if defined");if(this.#ke=y,void 0!==_&&"function"!=typeof _)throw new TypeError("fetchMethod must be a function if specified");if(this.#Ce=_,this.#We=!!_,this.#Ae=new Map,this.#Le=new Array(t).fill(void 0),this.#xe=new Array(t).fill(void 0),this.#Ne=new T(t),this.#De=new T(t),this.#Me=0,this.#Be=0,this.#Fe=u.create(t),this.#L=0,this.#Pe=0,"function"==typeof p&&(this.#$e=p),"function"==typeof m?(this.#Te=m,this.#Ue=[]):(this.#Te=void 0,this.#Ue=void 0),this.#Ge=!!this.#$e,this.#ze=!!this.#Te,this.noDisposeOnSet=!!g,this.noUpdateTTL=!!S,this.noDeleteOnFetchRejection=!!R,this.allowStaleOnFetchRejection=!!O,this.allowStaleOnFetchAbort=!!I,this.ignoreFetchAbort=!!$,0!==this.maxEntrySize){if(0!==this.#Ie&&!h(this.#Ie))throw new TypeError("maxSize must be a positive integer if specified");if(!h(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#Qe()}if(this.allowStale=!!f,this.noDeleteOnStaleGet=!!b,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=h(i)||0===i?i:1,this.ttlAutopurge=!!o,this.ttl=s||0,this.ttl){if(!h(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#et()}if(0===this.#Oe&&0===this.ttl&&0===this.#Ie)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#Oe&&!this.#Ie){const e="LRU_CACHE_UNBOUNDED";(e=>!r.has(e))(e)&&(r.add(e),n("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,d))}}getRemainingTTL(e){return this.#Ae.has(e)?1/0:0}#et(){const e=new c(this.#Oe),t=new c(this.#Oe);this.#He=e,this.#Ve=t,this.#tt=(r,i,n=s.now())=>{if(t[r]=0!==i?n:0,e[r]=i,0!==i&&this.ttlAutopurge){const e=setTimeout((()=>{this.#Je(r)&&this.#st(this.#Le[r],"expire")}),i+1);e.unref&&e.unref()}},this.#rt=r=>{t[r]=0!==e[r]?s.now():0},this.#it=(s,n)=>{if(e[n]){const o=e[n],a=t[n];if(!o||!a)return;s.ttl=o,s.start=a,s.now=r||i();const h=s.now-a;s.remainingTTL=o-h}};let r=0;const i=()=>{const e=s.now();if(this.ttlResolution>0){r=e;const t=setTimeout((()=>r=0),this.ttlResolution);t.unref&&t.unref()}return e};this.getRemainingTTL=s=>{const n=this.#Ae.get(s);if(void 0===n)return 0;const o=e[n],a=t[n];return o&&a?o-((r||i())-a):1/0},this.#Je=s=>{const n=t[s],o=e[s];return!!o&&!!n&&(r||i())-n>o}}#rt=()=>{};#it=()=>{};#tt=()=>{};#Je=()=>!1;#Qe(){const e=new c(this.#Oe);this.#Pe=0,this.#je=e,this.#nt=t=>{this.#Pe-=e[t],e[t]=0},this.#ot=(e,t,s,r)=>{if(this.#Ke(t))return 0;if(!h(s)){if(!r)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof r)throw new TypeError("sizeCalculation must be a function");if(s=r(t,e),!h(s))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return s},this.#at=(t,s,r)=>{if(e[t]=s,this.#Ie){const s=this.#Ie-e[t];for(;this.#Pe>s;)this.#ht(!0)}this.#Pe+=e[t],r&&(r.entrySize=s,r.totalCalculatedSize=this.#Pe)}}#nt=e=>{};#at=(e,t,s)=>{};#ot=(e,t,s,r)=>{if(s||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#Ye({allowStale:e=this.allowStale}={}){if(this.#L)for(let t=this.#Be;this.#lt(t)&&(!e&&this.#Je(t)||(yield t),t!==this.#Me);)t=this.#De[t]}*#Ze({allowStale:e=this.allowStale}={}){if(this.#L)for(let t=this.#Me;this.#lt(t)&&(!e&&this.#Je(t)||(yield t),t!==this.#Be);)t=this.#Ne[t]}#lt(e){return void 0!==e&&this.#Ae.get(this.#Le[e])===e}*entries(){for(const e of this.#Ye())void 0===this.#xe[e]||void 0===this.#Le[e]||this.#Ke(this.#xe[e])||(yield[this.#Le[e],this.#xe[e]])}*rentries(){for(const e of this.#Ze())void 0===this.#xe[e]||void 0===this.#Le[e]||this.#Ke(this.#xe[e])||(yield[this.#Le[e],this.#xe[e]])}*keys(){for(const e of this.#Ye()){const t=this.#Le[e];void 0===t||this.#Ke(this.#xe[e])||(yield t)}}*rkeys(){for(const e of this.#Ze()){const t=this.#Le[e];void 0===t||this.#Ke(this.#xe[e])||(yield t)}}*values(){for(const e of this.#Ye())void 0===this.#xe[e]||this.#Ke(this.#xe[e])||(yield this.#xe[e])}*rvalues(){for(const e of this.#Ze())void 0===this.#xe[e]||this.#Ke(this.#xe[e])||(yield this.#xe[e])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(e,t={}){for(const s of this.#Ye()){const r=this.#xe[s],i=this.#Ke(r)?r.__staleWhileFetching:r;if(void 0!==i&&e(i,this.#Le[s],this))return this.get(this.#Le[s],t)}}forEach(e,t=this){for(const s of this.#Ye()){const r=this.#xe[s],i=this.#Ke(r)?r.__staleWhileFetching:r;void 0!==i&&e.call(t,i,this.#Le[s],this)}}rforEach(e,t=this){for(const s of this.#Ze()){const r=this.#xe[s],i=this.#Ke(r)?r.__staleWhileFetching:r;void 0!==i&&e.call(t,i,this.#Le[s],this)}}purgeStale(){let e=!1;for(const t of this.#Ze({allowStale:!0}))this.#Je(t)&&(this.#st(this.#Le[t],"expire"),e=!0);return e}info(e){const t=this.#Ae.get(e);if(void 0===t)return;const r=this.#xe[t],i=this.#Ke(r)?r.__staleWhileFetching:r;if(void 0===i)return;const n={value:i};if(this.#He&&this.#Ve){const e=this.#He[t],r=this.#Ve[t];if(e&&r){const t=e-(s.now()-r);n.ttl=t,n.start=Date.now()}}return this.#je&&(n.size=this.#je[t]),n}dump(){const e=[];for(const t of this.#Ye({allowStale:!0})){const r=this.#Le[t],i=this.#xe[t],n=this.#Ke(i)?i.__staleWhileFetching:i;if(void 0===n||void 0===r)continue;const o={value:n};if(this.#He&&this.#Ve){o.ttl=this.#He[t];const e=s.now()-this.#Ve[t];o.start=Math.floor(Date.now()-e)}this.#je&&(o.size=this.#je[t]),e.unshift([r,o])}return e}load(e){this.clear();for(const[t,r]of e){if(r.start){const e=Date.now()-r.start;r.start=s.now()-e}this.set(t,r.value,r)}}set(e,t,s={}){if(void 0===t)return this.delete(e),this;const{ttl:r=this.ttl,start:i,noDisposeOnSet:n=this.noDisposeOnSet,sizeCalculation:o=this.sizeCalculation,status:a}=s;let{noUpdateTTL:h=this.noUpdateTTL}=s;const l=this.#ot(e,t,s.size||0,o);if(this.maxEntrySize&&l>this.maxEntrySize)return a&&(a.set="miss",a.maxEntrySizeExceeded=!0),this.#st(e,"set"),this;let c=0===this.#L?void 0:this.#Ae.get(e);if(void 0===c)c=0===this.#L?this.#Be:0!==this.#Fe.length?this.#Fe.pop():this.#L===this.#Oe?this.#ht(!1):this.#L,this.#Le[c]=e,this.#xe[c]=t,this.#Ae.set(e,c),this.#Ne[this.#Be]=c,this.#De[c]=this.#Be,this.#Be=c,this.#L++,this.#at(c,l,a),a&&(a.set="add"),h=!1;else{this.#qe(c);const s=this.#xe[c];if(t!==s){if(this.#We&&this.#Ke(s)){s.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:t}=s;void 0===t||n||(this.#Ge&&this.#$e?.(t,e,"set"),this.#ze&&this.#Ue?.push([t,e,"set"]))}else n||(this.#Ge&&this.#$e?.(s,e,"set"),this.#ze&&this.#Ue?.push([s,e,"set"]));if(this.#nt(c),this.#at(c,l,a),this.#xe[c]=t,a){a.set="replace";const e=s&&this.#Ke(s)?s.__staleWhileFetching:s;void 0!==e&&(a.oldValue=e)}}else a&&(a.set="update")}if(0===r||this.#He||this.#et(),this.#He&&(h||this.#tt(c,r,i),a&&this.#it(a,c)),!n&&this.#ze&&this.#Ue){const e=this.#Ue;let t;for(;t=e?.shift();)this.#Te?.(...t)}return this}pop(){try{for(;this.#L;){const e=this.#xe[this.#Me];if(this.#ht(!0),this.#Ke(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(void 0!==e)return e}}finally{if(this.#ze&&this.#Ue){const e=this.#Ue;let t;for(;t=e?.shift();)this.#Te?.(...t)}}}#ht(e){const t=this.#Me,s=this.#Le[t],r=this.#xe[t];return this.#We&&this.#Ke(r)?r.__abortController.abort(new Error("evicted")):(this.#Ge||this.#ze)&&(this.#Ge&&this.#$e?.(r,s,"evict"),this.#ze&&this.#Ue?.push([r,s,"evict"])),this.#nt(t),e&&(this.#Le[t]=void 0,this.#xe[t]=void 0,this.#Fe.push(t)),1===this.#L?(this.#Me=this.#Be=0,this.#Fe.length=0):this.#Me=this.#Ne[t],this.#Ae.delete(s),this.#L--,t}has(e,t={}){const{updateAgeOnHas:s=this.updateAgeOnHas,status:r}=t,i=this.#Ae.get(e);if(void 0!==i){const e=this.#xe[i];if(this.#Ke(e)&&void 0===e.__staleWhileFetching)return!1;if(!this.#Je(i))return s&&this.#rt(i),r&&(r.has="hit",this.#it(r,i)),!0;r&&(r.has="stale",this.#it(r,i))}else r&&(r.has="miss");return!1}peek(e,t={}){const{allowStale:s=this.allowStale}=t,r=this.#Ae.get(e);if(void 0===r||!s&&this.#Je(r))return;const i=this.#xe[r];return this.#Ke(i)?i.__staleWhileFetching:i}#Xe(e,t,s,r){const i=void 0===t?void 0:this.#xe[t];if(this.#Ke(i))return i;const n=new o,{signal:a}=s;a?.addEventListener("abort",(()=>n.abort(a.reason)),{signal:n.signal});const h={signal:n.signal,options:s,context:r},l=(r,i=!1)=>{const{aborted:o}=n.signal,a=s.ignoreFetchAbort&&void 0!==r;if(s.status&&(o&&!i?(s.status.fetchAborted=!0,s.status.fetchError=n.signal.reason,a&&(s.status.fetchAbortIgnored=!0)):s.status.fetchResolved=!0),o&&!a&&!i)return c(n.signal.reason);const l=u;return this.#xe[t]===u&&(void 0===r?l.__staleWhileFetching?this.#xe[t]=l.__staleWhileFetching:this.#st(e,"fetch"):(s.status&&(s.status.fetchUpdated=!0),this.set(e,r,h.options))),r},c=r=>{const{aborted:i}=n.signal,o=i&&s.allowStaleOnFetchAbort,a=o||s.allowStaleOnFetchRejection,h=a||s.noDeleteOnFetchRejection,l=u;if(this.#xe[t]===u&&(h&&void 0!==l.__staleWhileFetching?o||(this.#xe[t]=l.__staleWhileFetching):this.#st(e,"fetch")),a)return s.status&&void 0!==l.__staleWhileFetching&&(s.status.returnedStale=!0),l.__staleWhileFetching;if(l.__returned===l)throw r};s.status&&(s.status.fetchDispatched=!0);const u=new Promise(((t,r)=>{const o=this.#Ce?.(e,i,h);o&&o instanceof Promise&&o.then((e=>t(void 0===e?void 0:e)),r),n.signal.addEventListener("abort",(()=>{s.ignoreFetchAbort&&!s.allowStaleOnFetchAbort||(t(void 0),s.allowStaleOnFetchAbort&&(t=e=>l(e,!0)))}))})).then(l,(e=>(s.status&&(s.status.fetchRejected=!0,s.status.fetchError=e),c(e)))),d=Object.assign(u,{__abortController:n,__staleWhileFetching:i,__returned:void 0});return void 0===t?(this.set(e,d,{...h.options,status:void 0}),t=this.#Ae.get(e)):this.#xe[t]=d,d}#Ke(e){if(!this.#We)return!1;const t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof o}async fetch(e,t={}){const{allowStale:s=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,ttl:n=this.ttl,noDisposeOnSet:o=this.noDisposeOnSet,size:a=0,sizeCalculation:h=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:c=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:u=this.allowStaleOnFetchRejection,ignoreFetchAbort:d=this.ignoreFetchAbort,allowStaleOnFetchAbort:f=this.allowStaleOnFetchAbort,context:p,forceRefresh:m=!1,status:g,signal:S}=t;if(!this.#We)return g&&(g.fetch="get"),this.get(e,{allowStale:s,updateAgeOnGet:r,noDeleteOnStaleGet:i,status:g});const E={allowStale:s,updateAgeOnGet:r,noDeleteOnStaleGet:i,ttl:n,noDisposeOnSet:o,size:a,sizeCalculation:h,noUpdateTTL:l,noDeleteOnFetchRejection:c,allowStaleOnFetchRejection:u,allowStaleOnFetchAbort:f,ignoreFetchAbort:d,status:g,signal:S};let w=this.#Ae.get(e);if(void 0===w){g&&(g.fetch="miss");const t=this.#Xe(e,w,E,p);return t.__returned=t}{const t=this.#xe[w];if(this.#Ke(t)){const e=s&&void 0!==t.__staleWhileFetching;return g&&(g.fetch="inflight",e&&(g.returnedStale=!0)),e?t.__staleWhileFetching:t.__returned=t}const i=this.#Je(w);if(!m&&!i)return g&&(g.fetch="hit"),this.#qe(w),r&&this.#rt(w),g&&this.#it(g,w),t;const n=this.#Xe(e,w,E,p),o=void 0!==n.__staleWhileFetching&&s;return g&&(g.fetch=i?"stale":"refresh",o&&i&&(g.returnedStale=!0)),o?n.__staleWhileFetching:n.__returned=n}}async forceFetch(e,t={}){const s=await this.fetch(e,t);if(void 0===s)throw new Error("fetch() returned undefined");return s}memo(e,t={}){const s=this.#ke;if(!s)throw new Error("no memoMethod provided to constructor");const{context:r,forceRefresh:i,...n}=t,o=this.get(e,n);if(!i&&void 0!==o)return o;const a=s(e,o,{options:n,context:r});return this.set(e,a,n),a}get(e,t={}){const{allowStale:s=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,status:n}=t,o=this.#Ae.get(e);if(void 0!==o){const t=this.#xe[o],a=this.#Ke(t);return n&&this.#it(n,o),this.#Je(o)?(n&&(n.get="stale"),a?(n&&s&&void 0!==t.__staleWhileFetching&&(n.returnedStale=!0),s?t.__staleWhileFetching:void 0):(i||this.#st(e,"expire"),n&&s&&(n.returnedStale=!0),s?t:void 0)):(n&&(n.get="hit"),a?t.__staleWhileFetching:(this.#qe(o),r&&this.#rt(o),t))}n&&(n.get="miss")}#ct(e,t){this.#De[t]=e,this.#Ne[e]=t}#qe(e){e!==this.#Be&&(e===this.#Me?this.#Me=this.#Ne[e]:this.#ct(this.#De[e],this.#Ne[e]),this.#ct(this.#Be,e),this.#Be=e)}delete(e){return this.#st(e,"delete")}#st(e,t){let s=!1;if(0!==this.#L){const r=this.#Ae.get(e);if(void 0!==r)if(s=!0,1===this.#L)this.#ut(t);else{this.#nt(r);const s=this.#xe[r];if(this.#Ke(s)?s.__abortController.abort(new Error("deleted")):(this.#Ge||this.#ze)&&(this.#Ge&&this.#$e?.(s,e,t),this.#ze&&this.#Ue?.push([s,e,t])),this.#Ae.delete(e),this.#Le[r]=void 0,this.#xe[r]=void 0,r===this.#Be)this.#Be=this.#De[r];else if(r===this.#Me)this.#Me=this.#Ne[r];else{const e=this.#De[r];this.#Ne[e]=this.#Ne[r];const t=this.#Ne[r];this.#De[t]=this.#De[r]}this.#L--,this.#Fe.push(r)}}if(this.#ze&&this.#Ue?.length){const e=this.#Ue;let t;for(;t=e?.shift();)this.#Te?.(...t)}return s}clear(){return this.#ut("delete")}#ut(e){for(const t of this.#Ze({allowStale:!0})){const s=this.#xe[t];if(this.#Ke(s))s.__abortController.abort(new Error("deleted"));else{const r=this.#Le[t];this.#Ge&&this.#$e?.(s,r,e),this.#ze&&this.#Ue?.push([s,r,e])}}if(this.#Ae.clear(),this.#xe.fill(void 0),this.#Le.fill(void 0),this.#He&&this.#Ve&&(this.#He.fill(0),this.#Ve.fill(0)),this.#je&&this.#je.fill(0),this.#Me=0,this.#Be=0,this.#Fe.length=0,this.#Pe=0,this.#L=0,this.#ze&&this.#Ue){const e=this.#Ue;let t;for(;t=e?.shift();)this.#Te?.(...t)}}}t.LRUCache=d},9278:e=>{"use strict";e.exports=require("net")},9424:function(e,t,s){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.prototype.hasOwnProperty.call(e,s)&&r(t,e,s);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.v6=t.AddressError=t.Address6=t.Address4=void 0;const o=s(2839);Object.defineProperty(t,"Address4",{enumerable:!0,get:function(){return o.Address4}});const a=s(6329);Object.defineProperty(t,"Address6",{enumerable:!0,get:function(){return a.Address6}});const h=s(2437);Object.defineProperty(t,"AddressError",{enumerable:!0,get:function(){return h.AddressError}});const l=n(s(2846));t.v6={helpers:l}},9449:function(e,t,s){"use strict";var r,i=this&&this.__createBinding||(Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s=r(e),o=0;o<s.length;o++)"default"!==s[o]&&i(t,e,s[o]);return n(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Platform=t.FAILED_TO_CONNECT_TO_REMOTE_HOST_ERROR_MESSAGE=void 0,t.findAskpassScriptPath=b,t.findAskpassJSPath=O,t.getRemotePlatform=k,t.resolveProxySetting=A,t.installCodeServer=async function({conn:e,logger:s,defaultExtensions:r,askpassHandle:i,progress:n,cancellationToken:o,extensionFolder:a,localServerDownload:p,timeoutMs:_,resolveAttempt:y,context:T,remoteCommand:x,forceReinstall:M,killRunningServers:B,verbose:F,askpassStartedEvent:U,askpassFinishedEvent:j}){const V=l.workspace.getConfiguration("remote.SSH");let H=await k({extensionConfig:V,host:e.config.host,logger:s,shouldPrompt:!1}),G=await async function({extensionConfig:e,host:t,logger:s}){const r=e.get("serverInstallPath");if(s.debug(`hostname: ${t}, remote server install map: ${JSON.stringify(r)}`),null==r)return;if("object"!=typeof r)throw new Error(`Invalid setting 'remote.SSH.serverInstallPath'. It must be a object, but got: ${r}`);const i=r[t];if(null!=i){if("string"==typeof i)return i;throw new Error(`Invalid type server install path for host ${t}. It must be a string, but got: ${i}`)}}({extensionConfig:V,host:e.config.host,logger:s})??"~";G=G.replace(/[/\\]+$/,"");const W=Date.now();let z,K=1,X=!1,q="auto"===p||"always"===p,Y="always"===p;const Z=await(0,c.getVSCodeServerConfig)(),J=`${G}/${Z.serverDataFolderName}/cursor-server-${h.randomUUID()}.tar.gz`,Q=V.get("enableAgentForwarding",!0),ee=A(V.get("httpProxy"),e.config.host),te=A(V.get("httpsProxy"),e.config.host),se=A(V.get("noProxy"),e.config.host),re=V.get("enableRemoteCommand",!1),ie=V.get("serverShutdownTimeout",v);for(;;){if(o.isCancellationRequested)throw new Error("Cancelled");let l=[];try{const o=b(a);if("win32"!==process.platform)try{await d.promises.chmod(o,493)}catch(e){s.error(`Error setting permissions on askpass script: ${e}`)}const c=O(a),p={SSH_ASKPASS:o,CURSOR_SSH_ASKPASS_JS:c,CURSOR_SSH_ASKPASS_HANDLE:i,SSH_ASKPASS_REQUIRE:"force"};s.info(`Using askpass script: ${o} with javascript file ${c}. Askpass handle: ${i}`);const w=[];Q&&w.push("SSH_AUTH_SOCK"),ee&&w.push("HTTP_PROXY","http_proxy"),te&&w.push("HTTPS_PROXY","https_proxy"),se&&w.push("NO_PROXY","no_proxy");const v=I(a);let k;try{k=await d.promises.readFile(v,"base64")}catch(e){throw s.error(`Error reading multiplex server script from ${v}: ${e}`),new Error(`Failed to read multiplex server script from ${v}: ${e}`)}const A=h.randomBytes(12).toString("hex");let W;Q&&(W=T.workspaceState.get(E),void 0===W&&(W=h.randomUUID(),T.workspaceState.update(E,W)));const ne={id:A,commit:Z.commit,line:Z.line,envVariables:w,extensionIds:r,realCommit:Z.realCommit,serverApplicationName:Z.serverApplicationName,serverInstallPath:G,serverDataFolderName:Z.serverDataFolderName,sshAuthSockId:W,forceReinstall:M,verbose:F,killRunningServers:B,httpProxy:ee,httpsProxy:te,noProxy:se,cursorVersion:Z.version,serverShutdownTimeout:ie,multiplexServerScriptBase64:k,skipRemoteDownload:Y,scpServerPath:J};let oe;const ae={...p,CURSOR_SSH_ELECTRON_PATH:process.execPath,DISPLAY:"1"};if(ee&&(ae.HTTP_PROXY=ee,ae.http_proxy=ee),te&&(ae.HTTPS_PROXY=te,ae.https_proxy=te),se&&(ae.NO_PROXY=se,ae.no_proxy=se),H===$.Windows){const t=D(ne).trim().replace(/^#.*$/gm,"").replace(/\n{2,}/gm,"\n").replace(/^\s*/gm,"").replace(/\}\n/g,"}\n\n").replace(/\}$/,"}\n\n").replaceAll("\r","").replaceAll("\n","\r\n");if(s.info("Command length (8191 max):",t.length),t.length>8191)throw new Error("Command line too long");let r;void 0!==z&&await(0,g.exists)(z)||(z=u.default.join(f.tmpdir(),`cursor_remote_install_${h.randomUUID()}.ps1`),await d.promises.writeFile(z,t));const i="powershell -NoProfile";r=m.isWindows?`type "${z}" | `:`cat "${z}" | `;const o=y>1?"Reconnecting":"Connecting";n.report({message:`${o} to the remote host (attempt ${K})...`}),oe=await e.execHandler({command:i,env:ae,enableRemoteCommand:re,remoteCommand:x,shellCmdPrefix:r,verbose:F})}else{const t=N(ne);let r;void 0!==z&&await(0,g.exists)(z)||(z=u.default.join(f.tmpdir(),`cursor_remote_install_${h.randomUUID()}.sh`),await d.promises.writeFile(z,t)),r=m.isWindows?`type "${z}" | `:`cat "${z}" | `;const i="bash --login -c bash",o=y>1?"Reconnecting":"Connecting";n.report({message:`${o} to the remote host (attempt ${K})...`}),oe=await e.execHandler({command:i,enableRemoteCommand:re,remoteCommand:x,shellCmdPrefix:r,env:ae,verbose:F}),s.info("Started installation script. Waiting for it to finish...")}let he;s.info("Waiting for server to install..."),l.push({dispose:()=>{void 0!==he&&(clearTimeout(he),he=void 0)}});let le=!1,ce=()=>{},ue="";l.push(U((()=>{le=!0,ce()}))),l.push(j((()=>{le=!1,ce()}))),l.push(oe.stderr((()=>{ce()})));const de=new RegExp(`${A}: end`,"m");await Promise.race([oe.done,new Promise(((e,t)=>{ce=()=>{void 0!==he&&clearTimeout(he),le||(he=setTimeout((()=>{he=void 0,t(new Error("Failed to install server within the timeout"))}),_))},ce()})),new Promise((e=>{l.push(oe.stdout((t=>{ce(),ue+=t,de.test(t)&&e()})))}))]);const fe=ue.includes("Configuring Cursor Server on Remote"),pe=L(ue,A);if(!pe)throw fe?new Error("Failed to configure the Cursor server on the remote SSH host. Please check the logs for more details."):new Error(t.FAILED_TO_CONNECT_TO_REMOTE_HOST_ERROR_MESSAGE);X="true"===pe.isFatalError;const me=parseInt(pe.exitCode,10);if(s.info("Server install command exit code: ",me),H=C(pe.detectedPlatform)??H??$.Linux,0!==me){if(pe.errorMessage.includes("Download failed: ")&&q){n.report({message:"Downloading Cursor Server locally and copying it over"}),s.info(`Download failed: ${pe.errorMessage}. Downloading server locally and copying it over...`);const t=R({line:ne.line,realCommit:ne.realCommit,commit:ne.commit,platform:pe.detectedPlatform,arch:pe.arch}),r=u.default.join(f.tmpdir(),`cursor-server-${h.randomUUID()}.tar.gz`);s.info(`Downloading server from ${t} to ${r}`);const i=await fetch(t);if(!i.ok)throw new Error(`Could not install Cursor Server. Remote and local download faileds: (Remote error: ${pe.errorMessage}) (Local error: ${i.statusText})`);const o=await i.arrayBuffer();try{await d.promises.writeFile(r,Buffer.from(o)),s.info(`Downloaded server locally to ${r}. Copying to remote host at ${J}`);const t=void 0!==x;await e.copyToRemote({localPath:r,remotePath:J,hasRemoteCommand:t,env:ae,isWindowsRemote:H===$.Windows,verbose:F})}finally{try{await d.promises.unlink(r),s.info(`Deleted local server file ${r}`)}catch(e){s.error(`Error deleting local server file ${r}: ${e}`)}}s.info("Successfully SCP'd server to the remote host. Reattempting to connect"),q=!1,Y=!0;continue}let t="Couldn't install Cursor Server, install script returned non-zero exit status";throw pe.errorMessage&&(t+=`: ${pe.errorMessage}`),new Error(t)}let ge=void 0!==pe.multiplexListeningOn?parseInt(pe.multiplexListeningOn,10):void 0,Se=pe.multiplexConnectionToken;void 0!==ge&&isNaN(ge)&&(s.error(`Invalid multiplexListeningOn: ${pe.multiplexListeningOn}. Continuing without exec server. Docker over SSH will NOT work.`),ge=void 0,Se=void 0);const Ee=parseInt(pe.codeListeningOn,10);if(isNaN(Ee))throw new Error(`Invalid codeListeningOn: ${pe.codeListeningOn}`);const we={};for(const e of S)e in pe&&pe[e].length>0&&(we[e]=pe[e]);return H=C(pe.detectedPlatform)??H??$.Linux,P(V,e.config.host,H,s),{exitCode:me,multiplexListeningOn:ge,kill:oe.kill,codeListeningOn:Ee,socksPort:oe.socksPort,remoteNodeExecutable:pe.nodeExecutable,errorMessage:pe.errorMessage,multiplexConnectionToken:Se,codeConnectionToken:pe.codeConnectionToken,platform:H,envVars:we}}catch(t){const r=t instanceof Error?t.message:String(t);if(s.error("Error installing server:",t),void 0===H){H=await k({extensionConfig:V,host:e.config.host,logger:s,shouldPrompt:!0});continue}if(X||1===y||o.isCancellationRequested)throw t;if(Date.now()-W>=1e3*ie)throw s.error(`Failed to connect after ${K} attempts: ${r}`),t;n.report({message:`Failed to connect to the remote server after ${K} attempts; retrying connection in ${w/1e3} seconds`}),s.info(`Retrying connection in ${w/1e3} seconds...`),await new Promise((e=>setTimeout(e,w))),K++}finally{if(l.forEach((e=>e.dispose())),void 0!==z)try{s.info(`Deleting local script ${z}`),await d.promises.unlink(z)}catch(e){s.error(`Error deleting random file ${z}: ${e}`)}finally{z=void 0}}}};const h=o(s(6982)),l=o(s(1398)),c=s(3724),u=a(s(6928)),d=o(s(9896)),f=o(s(857)),p=a(s(9589)),m=s(3540),g=s(680),S=["SSH_AUTH_SOCK","HTTP_PROXY","http_proxy","HTTPS_PROXY","https_proxy","NO_PROXY","no_proxy"],E="cursor-remote-ssh:sshAuthSockId",w=5e3,v=300;t.FAILED_TO_CONNECT_TO_REMOTE_HOST_ERROR_MESSAGE="Failed to connect to the remote SSH host. Please check the logs for more details.";const _="https://downloads.cursor.com/${line}/${realCommit}/${platform}/${arch}/cursor-reh-${platform}-${arch}.tar.gz",y="https://cursor.blob.core.windows.net/remote-releases/${commit}/vscode-reh-${platform}-${arch}.tar.gz";function R({line:e,realCommit:t,commit:s,platform:r,arch:i}){return t&&"win32"!==r?_.replaceAll("${line}",e).replaceAll("${commit}",s).replaceAll("${realCommit}",t).replaceAll("${platform}",r).replaceAll("${arch}",i):y.replaceAll("${line}",e).replaceAll("${commit}",s).replaceAll("${platform}",r).replaceAll("${arch}",i)}function b(e){return"win32"===process.platform?u.default.join(e,"dist","scripts","launchSSHAskpass.bat"):u.default.join(e,"dist","scripts","launchSSHAskpass.sh")}function O(e){return u.default.join(e,"dist","scripts","sshAskClient.js")}function I(e){return u.default.join(e,"dist","scripts","remoteServer.js")}var $;!function(e){e.Linux="linux",e.MacOS="macOS",e.Windows="windows"}($||(t.Platform=$={}));const T=[$.Linux,$.MacOS,$.Windows];function C(e){if(void 0!==e)switch(e.toLowerCase().trim()){case"darwin":case"macos":return $.MacOS;case"linux":case"alpine":return $.Linux;case"win32":case"windows":return $.Windows;default:return}}async function k({extensionConfig:e,host:t,logger:s,shouldPrompt:r}){const i=e.get("remotePlatform",{});s.debug(`hostname: ${t}, remote platform map: ${JSON.stringify(i)}`);const n=i[t];if(function(e){return Object.values($).includes(e)}(n))return s.info(`Using configured platform ${n} for remote host ${t}`),n;if(!r)return;const o=await l.window.showQuickPick(T,{title:`Select the platform of remote host "${t}"`,ignoreFocusOut:!0});if(void 0===o)throw new Error(`User cancelled platform selection for remote host ${t}`);return s.info(`Selected platform ${o} for remote host ${t}`),P(e,t,o,s),o}function P(e,t,s,r){const i=e.get("remotePlatform",{});e.update("remotePlatform",{...i,[t]:s},l.ConfigurationTarget.Global).then((()=>{r.info(`Saved platform ${s} for remote host ${t}`)}),(e=>{r.error(`Error saving platform ${s} for remote host ${t}: ${e}`)}))}function A(e,t){if(void 0!==e){if("string"==typeof e)return""!==e.trim()?e.trim():void 0;if("object"==typeof e&&null!==e){const s=e[t];return s?s.trim():void 0}}}function L(e,t){const s=`${t}: start`,r=`${t}: end`,i=e.indexOf(s);if(i<0)return;const n=e.indexOf(r,i+s.length);if(n<0)return;const o={},a=e.substring(i+s.length,n).split(/\r?\n/);for(const e of a){const[t,s]=e.split("==");o[t]=s}return o}const x=30;function N({httpProxy:e,httpsProxy:t,noProxy:s,commit:r,line:i,serverApplicationName:n,id:o,serverInstallPath:a,sshAuthSockId:l,serverDataFolderName:c,envVariables:u,forceReinstall:d,verbose:f,cursorVersion:m,skipRemoteDownload:g,scpServerPath:S,realCommit:E,multiplexServerScriptBase64:w,extensionIds:v,killRunningServers:R,serverShutdownTimeout:b}){a=a.replace(/^~(?=$|\/|\\)/,"$HOME"),S=S.replace(/^~(?=$|\/|\\)/,"$HOME");let O=!1;try{m&&(m=m.split("-")[0],p.default.lt(m,"0.50.5")&&(O=!0))}catch(e){}const I=h.createHash("sha256").update(w).digest("hex"),$=v.map((e=>"--install-extension "+e)).join(" ");a.endsWith(`/${c}`)&&(a=a.slice(0,-1*(c.length+1)));const T=l?`/tmp/cursor-remote-ssh-auth-sock-${l}.sock`:"";return`\necho "Configuring Cursor Server on Remote"\n${e?`\nexport HTTP_PROXY="${e}"\nexport http_proxy="${e}"`:""}${t?`\nexport HTTPS_PROXY="${t}"\nexport https_proxy="${t}"`:""}${s?`\nexport NO_PROXY="${s}"\nexport no_proxy="${s}"`:""}\n\nSERVER_COMMIT="${r}"\nSERVER_REAL_COMMIT="${E}"\nSERVER_LINE="${i}"\nSERVER_DATA_DIR="${a}/${c}"\n\n# Probe for writable temporary directory\nprobe_tmp_dir() {\n    if [[ -n "\${XDG_RUNTIME_DIR}" && -d "\${XDG_RUNTIME_DIR}" ]]; then\n        local test_file="\${XDG_RUNTIME_DIR}/cursor-test-$(date +%s)-$RANDOM"\n        if touch "$test_file" 2>/dev/null && [[ -f "$test_file" ]]; then\n            rm -f "$test_file"\n            echo "\${XDG_RUNTIME_DIR}"\n            return 0\n        fi\n    fi\n    if [[ -d "/tmp" ]]; then\n        local test_file="/tmp/cursor-test-$(date +%s)-$RANDOM"\n        if touch "$test_file" 2>/dev/null && [[ -f "$test_file" ]]; then\n            rm -f "$test_file"\n            echo "/tmp"\n            return 0\n        fi\n    fi\n    echo "$SERVER_DATA_DIR"  # fallback\n}\n\nTMP_DIR="$(probe_tmp_dir)"\necho "Using TMP_DIR: $TMP_DIR"\nSERVER_DIR="$SERVER_DATA_DIR/bin/${r}"\nSERVER_NODE_EXECUTABLE="$SERVER_DIR/node"\nCODE_SERVER_SCRIPT="$SERVER_DIR/bin/${n}"\nCODE_SERVER_PROCESS_ALL_VERSIONS_GREP_PATTERN="$SERVER_DATA_DIR/bin/.*/out/server-main.js"\nCODE_LISTENING_ON=\nCODE_SERVER_CONNECTION_TOKEN=\nMULTIPLEX_SERVER_SCRIPT="$SERVER_DATA_DIR/bin/multiplex-server/${I}.js"\nMULTIPLEX_LISTENING_ON=\nSERVER_ARCH=\nSERVER_DOWNLOAD_URL=\nOS_RELEASE_ID=\nARCH=\nPLATFORM=\nexport PATH="$SERVER_DIR/bin/remote-cli:$PATH"\n\nget_tmp_file() {\n    local suffix=$1\n    echo "$TMP_DIR/cursor-remote-\${suffix}.$(echo $SERVER_DATA_DIR | (md5sum 2>/dev/null || md5) | awk '{print $1}')"\n}\n\nget_tmp_file_with_hash() {\n    local suffix=$1\n    local hash=$2\n    echo "$TMP_DIR/cursor-remote-\${suffix}.$(echo $SERVER_DATA_DIR | (md5sum 2>/dev/null || md5) | awk '{print $1}').\${hash}"\n}\n\n\nCODE_SERVER_LOGFILE="$(get_tmp_file 'code.log')"\nCODE_SERVER_TOKENFILE="$(get_tmp_file 'code.token')"\nCODE_SERVER_PIDFILE="$(get_tmp_file 'code.pid')"\nMULTIPLEX_SERVER_LOGFILE="$(get_tmp_file_with_hash 'multiplex.log' '${I}')"\nMULTIPLEX_SERVER_TOKENFILE="$(get_tmp_file_with_hash 'multiplex.token' '${I}')"\nMULTIPLEX_SERVER_PIDFILE="$(get_tmp_file_with_hash 'multiplex.pid' '${I}')"\nMULTIPLEX_SERVER_PROCESS_ALL_VERSIONS_GREP_PATTERN="$SERVER_DATA_DIR/bin/multiplex-server/.*.js"\n\n# These are magic variables that are used by the code server\nexport VSCODE_AGENT_FOLDER="$SERVER_DATA_DIR"\nexport VSCODE_SERVER_SHUTDOWN_TIMEOUT="${b}"\n\n# If the SSH_AUTH_SOCK is set, we symlink it to a well-known location based on the SSH_AUTH_SOCK_ID\n# This is because terminals and other parts of the editor don't update to use the latest SSH_AUTH_SOCK\nif [[ -n "$SSH_AUTH_SOCK" ]]; then\n    if [[ -n "${T}" ]]; then\n        ln -sf "$SSH_AUTH_SOCK" "${T}"\n        export SSH_AUTH_SOCK="${T}"\n    fi\nfi\n\nprint_install_results_and_exit() {\n    echo "${o}: start"\n    echo "exitCode==$1=="\n    echo "nodeExecutable==$SERVER_NODE_EXECUTABLE=="\n    echo "multiplexListeningOn==$MULTIPLEX_LISTENING_ON=="\n    echo "multiplexConnectionToken==$MULTIPLEX_SERVER_CONNECTION_TOKEN=="\n    echo "codeListeningOn==$CODE_LISTENING_ON=="\n    echo "errorMessage==$2=="\n    echo "isFatalError==$3=="\n    echo "codeConnectionToken==$CODE_SERVER_CONNECTION_TOKEN=="\n    echo "detectedPlatform==$PLATFORM=="\n    echo "arch==$SERVER_ARCH=="\n    ${u.map((e=>`echo "${e}==$${e}=="`)).join("\n")}\n    echo "${o}: end"\n    exit $1\n}\n\nprint_install_results_and_wait() {\n    # Try to get PIDs from PID files first, fallback to extracting from running processes\n    if [[ -f $CODE_SERVER_PIDFILE ]]; then\n        CODE_SERVER_PID="$(cat $CODE_SERVER_PIDFILE)"\n    else\n        # PID file doesn't exist, try to extract PID from running process\n        CODE_SERVER_RUNNING_PROCESS="$(ps -o pid,args -A | grep $CODE_SERVER_SCRIPT | grep -v grep | head -1)"\n        if [[ -n "$CODE_SERVER_RUNNING_PROCESS" ]]; then\n            CODE_SERVER_PID="$(echo "$CODE_SERVER_RUNNING_PROCESS" | awk '{print $1}')"\n        else\n            print_install_results_and_exit 1 "Code server PID file not found and no running code server process detected" "false"\n        fi\n    fi\n\n    if [[ -f $MULTIPLEX_SERVER_PIDFILE ]]; then\n        MULTIPLEX_SERVER_PID="$(cat $MULTIPLEX_SERVER_PIDFILE)"\n    else\n        # PID file doesn't exist, try to extract PID from running process\n        MULTIPLEX_SERVER_RUNNING_PROCESS="$(ps -o pid,args -A | grep $MULTIPLEX_SERVER_SCRIPT | grep -v grep | head -1)"\n        if [[ -n "$MULTIPLEX_SERVER_RUNNING_PROCESS" ]]; then\n            MULTIPLEX_SERVER_PID="$(echo "$MULTIPLEX_SERVER_RUNNING_PROCESS" | awk '{print $1}')"\n        else\n            echo "Multiplex server PID file not found and no running multiplex server process detected"\n            # This pid doesn't exist, so the while loop will exit immediately\n            MULTIPLEX_SERVER_PID=invalid_pid\n        fi\n    fi\n\n    echo "${o}: start"\n    echo "exitCode==0=="\n    echo "nodeExecutable==$SERVER_NODE_EXECUTABLE=="\n    echo "errorMessage===="\n    echo "isFatalError==false=="\n    echo "multiplexListeningOn==$MULTIPLEX_LISTENING_ON=="\n    echo "multiplexConnectionToken==$MULTIPLEX_SERVER_CONNECTION_TOKEN=="\n    echo "codeListeningOn==$CODE_LISTENING_ON=="\n    echo "codeConnectionToken==$CODE_SERVER_CONNECTION_TOKEN=="\n    echo "detectedPlatform==$PLATFORM=="\n    echo "arch==$SERVER_ARCH=="\n    ${u.map((e=>`echo "${e}==$${e}=="`)).join("\n")}\n    echo "${o}: end"\n    unlock\n    trap - EXIT\n    echo " "\n    echo "***********************************************************************"\n    echo "* This terminal is used to establish and maintain the SSH connection. *"\n    echo "* Closing this terminal will terminate the connection and disconnect  *"\n    echo "* Cursor from the remote server.                                      *"\n    echo "***********************************************************************"\n    # We need to wait for both servers to exit -- when using docker over ssh, the code server won't have a connection\n    while kill -0 $CODE_SERVER_PID 2>/dev/null\n    do\n        sleep 10\n    done\n    echo "Code server process $CODE_SERVER_PID died"\n    while kill -0 $MULTIPLEX_SERVER_PID 2>/dev/null\n    do\n        sleep 11\n    done\n    echo "Multiplex server process $MULTIPLEX_SERVER_PID died"\n    exit 0\n}\n\nget_lockfile() {\n    echo "$TMP_DIR/cursor-remote-lock.$(echo $SERVER_DATA_DIR | (md5sum 2>/dev/null || md5) | awk '{print $1}')"\n}\n\nif [[ "${R||d}" == "true" ]]; then\n    echo "Killing all running Cursor servers"\n    CODE_SERVER_RUNNING_PROCESS="$(ps -o pid,args -A | grep $CODE_SERVER_PROCESS_ALL_VERSIONS_GREP_PATTERN | grep -v grep || true)"\n    if [[ -z "$CODE_SERVER_RUNNING_PROCESS" ]]; then\n        echo "No running code servers found"\n    fi\n    echo "Killing running code servers: $CODE_SERVER_RUNNING_PROCESS"\n    echo "$CODE_SERVER_RUNNING_PROCESS" | while read -r line; do\n        pid=$(echo "$line" | awk '{print $1}')\n        if [[ -n "$pid" ]]; then\n            echo "Killing server process with PID: $pid"\n            kill -9 "$pid"\n        fi\n    done\n    CODE_SERVER_RUNNING_PROCESS=""\n    echo "Killing all running multiplex servers"\n    MULTIPLEX_SERVER_RUNNING_PROCESS="$(ps -o pid,args -A | grep $MULTIPLEX_SERVER_PROCESS_ALL_VERSIONS_GREP_PATTERN | grep -v grep || true)"\n    if [[ -z "$MULTIPLEX_SERVER_RUNNING_PROCESS" ]]; then\n        echo "No running multiplex servers found"\n    fi\n    echo "Killing running multiplex servers: $MULTIPLEX_SERVER_RUNNING_PROCESS"\n    echo "$MULTIPLEX_SERVER_RUNNING_PROCESS" | while read -r line; do\n        pid=$(echo "$line" | awk '{print $1}')\n        if [[ -n "$pid" ]]; then\n            echo "Killing server process with PID: $pid"\n            kill -9 "$pid"\n        fi\n    done\n    MULTIPLEX_SERVER_RUNNING_PROCESS=""\nfi\n\nif [[ '${d}' == "true" ]]; then\n    echo "Removing all existing Cursor installations"\n    rm -rf "$SERVER_DATA_DIR/bin"         $SERVER_DATA_DIR/.*.code.log         $SERVER_DATA_DIR/.*.code.pid         $SERVER_DATA_DIR/.*.code.token         $SERVER_DATA_DIR/.*.multiplex.pid         $SERVER_DATA_DIR/.*.multiplex.token         $SERVER_DATA_DIR/.*.multiplex.log         $SERVER_DATA_DIR/.*.pid         $SERVER_DATA_DIR/.*.token         $SERVER_DATA_DIR/.*.log         $(get_lockfile)         $(get_lockfile).target         $(get_tmp_file 'code.log')         $(get_tmp_file 'code.pid')         $(get_tmp_file 'code.token')         $(get_tmp_file_with_hash 'multiplex.log' '${I}')         $(get_tmp_file_with_hash 'multiplex.pid' '${I}')         $(get_tmp_file_with_hash 'multiplex.token' '${I}')\n\n    # Don't delete the server we just copied\n    echo "Deleting left behind cursor servers, except for ${S}"\n    find "$SERVER_DATA_DIR" -name "cursor-server-*.tar.gz" ! -name "$(basename ${S})" -delete -print\n    echo "Done deleting left behind cursor servers"\nfi\n\nunlock() {\n    lockfile=$(get_lockfile)\n    if [ -n "$LOCK_PID" ]; then\n        kill $LOCK_PID 2>/dev/null\n    fi\n    echo "Unlocking $lockfile"\n    rm -f "$lockfile"\n    rm -f "$lockfile.target"\n}\n\nlock() {\n    lockfile=$(get_lockfile)\n    echo "Locking $lockfile"\n    lockAcquired=0\n    for i in {1..${x}}; do\n        if [ -f "$lockfile" ]; then\n            # Check if lock is stale (older than 10 seconds)\n            current_time=$(date +%s)\n            lock_time=$(cat "$lockfile" 2>/dev/null || echo 0)\n            if [ $((current_time - lock_time)) -gt 10 ]; then\n                echo "Found stale lock, removing..."\n                rm -f "$lockfile"\n            fi\n        fi\n        touch "$lockfile.target"\n        ln "$lockfile.target" "$lockfile"\n        if [ $? -eq 0 ]; then\n            lockAcquired=1\n            # Start a background process to update timestamp\n            # Locking for at most 15 minutes (900 seconds) -- really bad to having processes dangling forever\n            counter=0\n            while [ $counter -lt 900 ]; do\n                date +%s > "$lockfile"\n                sleep 1\n                counter=$((counter + 1))\n            done &\n            LOCK_PID=$!\n            break\n        fi\n        echo "Install in progress, sleeping for a bit..."\n        sleep 1\n    done\n    if [ $lockAcquired -eq 0 ]; then\n        print_install_results_and_exit 1 "Could not acquire lock after multiple attempts"\n    fi\n    trap unlock EXIT\n}\n\nKERNEL="$(uname -s)"\ncase $KERNEL in\n    Darwin)\n        PLATFORM="darwin"\n        ;;\n    Linux)\n        PLATFORM="linux"\n        ;;\n    FreeBSD)\n        PLATFORM="linux"\n        ;;\n    *)\n        print_install_results_and_exit 1 "Platform not supported: $KERNEL" "true"\n        ;;\nesac\n\nARCH="$(uname -m)"\ncase $ARCH in\n    x86_64 | amd64)\n        SERVER_ARCH="x64"\n        ;;\n    arm64 | aarch64)\n        SERVER_ARCH="arm64"\n        ;;\n    *)\n        print_install_results_and_exit 1 "Architecture not supported: $ARCH" "true"\n        ;;\nesac\n\nOS_RELEASE_ID="$(grep -i '^ID=' /etc/os-release 2>/dev/null | sed 's/^ID=//gi' | sed 's/"//g')"\nif [[ -z $OS_RELEASE_ID ]]; then\n    OS_RELEASE_ID="$(grep -i '^ID=' /usr/lib/os-release 2>/dev/null | sed 's/^ID=//gi' | sed 's/"//g')"\n    if [[ -z $OS_RELEASE_ID ]]; then\n        OS_RELEASE_ID="unknown"\n    fi\nfi\n\n# Create installation folder\nmkdir -p $SERVER_DIR\nif (( $? > 0 )); then\n    print_install_results_and_exit 1 "Error creating server install directory $SERVER_DIR"\nfi\n\n# adjust platform for alpine (musl-libc based binary) download, if needed\nif [[ $OS_RELEASE_ID = alpine ]]; then\n    PLATFORM=$OS_RELEASE_ID\nfi\nSERVER_DOWNLOAD_URL="$(echo "${(void 0===E?y:_).replace(/\$\{/g,"\\${")}" | sed "s/\\\${line}/$SERVER_LINE/g" | sed "s/\\\${realCommit}/$SERVER_REAL_COMMIT/g"  | sed "s/\\\${commit}/$SERVER_COMMIT/g" | sed "s/\\\${platform}/$PLATFORM/g" | sed "s/\\\${arch}/$SERVER_ARCH/g")"\nlock\n# Check if server script is already installed\nif [[ ! -f $CODE_SERVER_SCRIPT ]]; then\n    pushd $SERVER_DIR > /dev/null\n    RANDOM_FILENAME="cursor-server-${h.randomUUID()}.tar.gz"\n    if [[ -f "${S}" ]]; then\n        echo "Found existing server archive at ${S}, using it instead of downloading"\n        mv "${S}" $RANDOM_FILENAME\n    else\n        if [[ '${g}' == 'true' ]]; then\n            echo "Server not found at ${S}, and local download is required"\n            print_install_results_and_exit 1 "Download failed: Failed to copy server from local client" "true"\n        fi\n        if [[ ! -z $(which wget) ]]; then\n            echo "Downloading server via wget from $SERVER_DOWNLOAD_URL to $RANDOM_FILENAME"\n            # Use fancy progress bar when supported (GNU Wget). Fall back if not.\n            if wget --help 2>&1 | grep -q -- '--progress='; then\n                WGET_PROGRESS='--progress=bar:force:noscroll'\n            else\n                WGET_PROGRESS='--progress=dot'\n            fi\n            wget --tries=2 --timeout=5 --continue $WGET_PROGRESS -O $RANDOM_FILENAME $SERVER_DOWNLOAD_URL\n        elif [[ ! -z $(which curl) ]]; then\n            echo "Downloading server via curl from $SERVER_DOWNLOAD_URL to $RANDOM_FILENAME"\n            curl --retry 2 --fail --connect-timeout 5 --location --progress-bar --output $RANDOM_FILENAME $SERVER_DOWNLOAD_URL\n        else\n            print_install_results_and_exit 1 "Download failed: Error no tool to download server binary. Please install wget or curl" "true"\n        fi\n        if (( $? > 0 )); then\n            if [[ "$OS_RELEASE_ID" == 'alpine' && '${O}' = 'true' ]]; then\n                # Only showing this error if the download actually fails, and we know that the version is pre-Alpine\n                # Don't want the download to fail if it actually would have worked!\n                print_install_results_and_exit 1 "Please update Cursor to the latest version to connect to Alpine-based remote servers" "true"\n            fi\n            print_install_results_and_exit 1 "Download failed: Error downloading server from $SERVER_DOWNLOAD_URL" "false"\n        fi\n    fi\n    echo "Extracting server contents from $RANDOM_FILENAME"\n    tar -xf $RANDOM_FILENAME --strip-components 1\n    if (( $? > 0 )); then\n        print_install_results_and_exit 1 "Tar failed to extract server contents from $RANDOM_FILENAME" "false"\n    fi\n    if [[ ! -f $CODE_SERVER_SCRIPT ]]; then\n        print_install_results_and_exit 1 "Failed to extract code server script: $CODE_SERVER_SCRIPT" "false"\n    fi\n    rm -f $RANDOM_FILENAME\n    popd > /dev/null\nelse\n    echo "Server script already installed in $CODE_SERVER_SCRIPT"\nfi\necho "Checking node executable"\nif ! $SERVER_NODE_EXECUTABLE --version; then\n    echo "Node executable at $SERVER_NODE_EXECUTABLE is not working, checking system node"\n    SYSTEM_NODE=$(which node)\n    if [[ -n "$SYSTEM_NODE" ]]; then\n        echo "System node version: $($SYSTEM_NODE --version)"\n        $SYSTEM_NODE -e "process.exit(parseInt(process.version.slice(1)) >= 20 ? 0 : 1)"\n        if [[ $? -eq 0 ]]; then\n            echo "System node version is 20 or higher, creating symlink"\n            ln -sf $SYSTEM_NODE $SERVER_NODE_EXECUTABLE\n            echo "Created symlink from $SERVER_NODE_EXECUTABLE to $SYSTEM_NODE"\n        else\n            print_install_results_and_exit 1 "The bundled NodeJS failed to run, and system node is too old. Please manually install NodeJS 20 or higher on your remote system" "true"\n        fi\n    else\n        print_install_results_and_exit 1 "The bundled NodeJS failed to run, and no system NodeJS executable was found. Please manually install NodeJS 20 or higher on your remote system" "true"\n    fi\nfi\n\n# Clean up stale builds\nOLD_COMMITS=$(ls -1 -t "$SERVER_DATA_DIR/bin" | tail -n +6)\nfor OLD_COMMIT in $OLD_COMMITS; do\n    IS_RUNNING=\`ps ax | grep $OLD_COMMIT | grep -v grep | wc -l | tr -d '[:space:]'\`\n    if [[ $IS_RUNNING -eq 0 ]]; then\n        echo "Cleaning up stale build $OLD_COMMIT"\n        if [[ "$OLD_COMMIT" != "$SERVER_COMMIT" ]]; then\n            rm -rf "$SERVER_DATA_DIR/bin/$OLD_COMMIT" "$SERVER_DATA_DIR/.$OLD_COMMIT.*"\n        fi\n    else\n        echo "Build $OLD_COMMIT is still running, skipping"\n    fi\ndone\n\n# Symlink $SERVER_DIR/bin/remote-cli/code -> $SERVER_DIR/bin/remote-cli/cursor (force)\nREMOTE_CLI_DIR="$SERVER_DIR/bin/remote-cli"\nif [ -d "$REMOTE_CLI_DIR" ]; then\n    ln -sf cursor "$REMOTE_CLI_DIR/code"\nfi\n\n# Try to find if server is already running\necho "Checking for running multiplex server: $MULTIPLEX_SERVER_SCRIPT"\nif [[ -f $MULTIPLEX_SERVER_PIDFILE ]]; then\n    MULTIPLEX_SERVER_PID="$(cat $MULTIPLEX_SERVER_PIDFILE)"\n    MULTIPLEX_SERVER_RUNNING_PROCESS="$(ps -o pid,args -A | grep -w $MULTIPLEX_SERVER_PID | grep $MULTIPLEX_SERVER_SCRIPT)"\nelse\n    MULTIPLEX_SERVER_RUNNING_PROCESS="$(ps -o pid,args -A | grep $MULTIPLEX_SERVER_SCRIPT | grep -v grep)"\nfi\necho "Running multiplex server: $MULTIPLEX_SERVER_RUNNING_PROCESS"\n\nif [[ -z $MULTIPLEX_SERVER_RUNNING_PROCESS || ! -f $MULTIPLEX_SERVER_LOGFILE || ! -f $MULTIPLEX_SERVER_TOKENFILE ]]; then\n    if [[ -f $MULTIPLEX_SERVER_LOGFILE ]]; then\n        rm $MULTIPLEX_SERVER_LOGFILE\n    fi\n    if [[ -f $MULTIPLEX_SERVER_TOKENFILE ]]; then\n        rm $MULTIPLEX_SERVER_TOKENFILE\n    fi\n\n    echo "Creating multiplex server token file $MULTIPLEX_SERVER_TOKENFILE"\n    touch $MULTIPLEX_SERVER_TOKENFILE\n    chmod 600 $MULTIPLEX_SERVER_TOKENFILE\n    MULTIPLEX_SERVER_CONNECTION_TOKEN="${h.randomUUID()}"\n    echo $MULTIPLEX_SERVER_CONNECTION_TOKEN > $MULTIPLEX_SERVER_TOKENFILE\n\n    # This is super counterintuitive, but we UNSET the SSH_AUTH_SOCK before starting the server, because we manually inject it into the extension host later.\n    # This is to prevent us from being used across ALL connections by default\n\n    # Backing it up, NOT exporting it\n    if [[ -n "$SSH_AUTH_SOCK" ]]; then\n        ORIGINAL_SSH_AUTH_SOCK=$SSH_AUTH_SOCK\n        unset SSH_AUTH_SOCK\n    fi\n\n    echo "Creating directory for multiplex server: $(dirname $MULTIPLEX_SERVER_SCRIPT)"\n    mkdir -p $(dirname "$MULTIPLEX_SERVER_SCRIPT")\n    echo "Writing multiplex server script to $MULTIPLEX_SERVER_SCRIPT"\n    echo '${w}' | (base64 -d 2>/dev/null || base64 -D) > "$MULTIPLEX_SERVER_SCRIPT"\n\n    echo "Starting multiplex server: $SERVER_NODE_EXECUTABLE $MULTIPLEX_SERVER_SCRIPT $MULTIPLEX_SERVER_CONNECTION_TOKEN"\n    $SERVER_NODE_EXECUTABLE "$MULTIPLEX_SERVER_SCRIPT" "$MULTIPLEX_SERVER_CONNECTION_TOKEN"  &> $MULTIPLEX_SERVER_LOGFILE &\n    echo $! > $MULTIPLEX_SERVER_PIDFILE\n    echo "Multiplex server started with PID $(cat $MULTIPLEX_SERVER_PIDFILE) and wrote pid to file $MULTIPLEX_SERVER_PIDFILE"\n\n    # Restoring the original SSH_AUTH_SOCK\n    if [[ -n "$ORIGINAL_SSH_AUTH_SOCK" ]]; then\n        export SSH_AUTH_SOCK=$ORIGINAL_SSH_AUTH_SOCK\n        unset ORIGINAL_SSH_AUTH_SOCK\n    fi\nelse\n    echo "Multiplex server script is already running $MULTIPLEX_SERVER_SCRIPT. Running processes are $MULTIPLEX_SERVER_RUNNING_PROCESS"\nfi\n\necho "Reading multiplex server token file $MULTIPLEX_SERVER_TOKENFILE"\n\nif [[ -f $MULTIPLEX_SERVER_TOKENFILE ]]; then\n    echo "Multiplex server token file found"\n    MULTIPLEX_SERVER_CONNECTION_TOKEN="$(cat $MULTIPLEX_SERVER_TOKENFILE)"\nelse\n    print_install_results_and_exit 1 "Multiplex server token file not found: $MULTIPLEX_SERVER_TOKENFILE"\nfi\n\necho "Reading multiplex server log file $MULTIPLEX_SERVER_LOGFILE"\n\nfor i in {1..180}; do\n    if [[ -f $MULTIPLEX_SERVER_LOGFILE ]]; then\n        MULTIPLEX_LISTENING_ON="$(cat $MULTIPLEX_SERVER_LOGFILE | grep -E 'Server listening on .+' | sed 's/Server listening on //')"\n        if [[ -n "$MULTIPLEX_LISTENING_ON" ]]; then\n            break\n        fi\n    fi\n    sleep 0.5\ndone\n\nif [[ -z "$MULTIPLEX_LISTENING_ON" ]]; then\n    echo "Error multiplex server did not start successfully. Below are the logs"\n    # Reading the logfile, to help with debugging\n    ls -al $MULTIPLEX_SERVER_LOGFILE || true\n    cat $MULTIPLEX_SERVER_LOGFILE || true\nfi\n\n\necho "Checking for code servers"\nif [[ -f $CODE_SERVER_PIDFILE ]]; then\n    CODE_SERVER_PID="$(cat $CODE_SERVER_PIDFILE)"\n    CODE_SERVER_RUNNING_PROCESS="$(ps -o pid,args -A | grep -w $CODE_SERVER_PID | grep $CODE_SERVER_SCRIPT)"\nelse\n    CODE_SERVER_RUNNING_PROCESS="$(ps -o pid,args -A | grep $CODE_SERVER_SCRIPT | grep -v grep)"\nfi\n\n# Making sure the token file and log files exists; otherwise we need to start a new server\nif [[ -z $CODE_SERVER_RUNNING_PROCESS || ! -f $CODE_SERVER_TOKENFILE || ! -f $CODE_SERVER_LOGFILE ]]; then\n    echo "Code server script is not running"\n    if [[ -f $CODE_SERVER_LOGFILE ]]; then\n        rm $CODE_SERVER_LOGFILE\n    fi\n    if [[ -f $CODE_SERVER_TOKENFILE ]]; then\n        rm $CODE_SERVER_TOKENFILE\n    fi\n\n    echo "Creating code server token file $CODE_SERVER_TOKENFILE"\n    touch $CODE_SERVER_TOKENFILE\n    chmod 600 $CODE_SERVER_TOKENFILE\n    CODE_SERVER_CONNECTION_TOKEN="${h.randomUUID()}"\n    echo $CODE_SERVER_CONNECTION_TOKEN > $CODE_SERVER_TOKENFILE\n\n    # This is super counterintuitive, but we UNSET the SSH_AUTH_SOCK before starting the server, because we manually inject it into the extension host later.\n    # This is to prevent us from being used across ALL connections by default\n\n    # Backing it up, NOT exporting it\n    if [[ -n "$SSH_AUTH_SOCK" ]]; then\n        ORIGINAL_SSH_AUTH_SOCK=$SSH_AUTH_SOCK\n        unset SSH_AUTH_SOCK\n    fi\n\n    echo "Starting code server script $CODE_SERVER_SCRIPT --start-server --host=127.0.0.1 --port 0 ${$} --connection-token-file $CODE_SERVER_TOKENFILE --telemetry-level off --enable-remote-auto-shutdown --accept-server-license-terms &> $CODE_SERVER_LOGFILE &"\n\n    $CODE_SERVER_SCRIPT --start-server --host=127.0.0.1 --port 0 ${$} --connection-token-file $CODE_SERVER_TOKENFILE --telemetry-level off --enable-remote-auto-shutdown --accept-server-license-terms &> $CODE_SERVER_LOGFILE &\n    echo $! > $CODE_SERVER_PIDFILE\n    echo "Code server started with PID $(cat $CODE_SERVER_PIDFILE) and wrote pid to file $CODE_SERVER_PIDFILE"\n\n    # Restoring the original SSH_AUTH_SOCK\n    if [[ -n "$ORIGINAL_SSH_AUTH_SOCK" ]]; then\n        export SSH_AUTH_SOCK=$ORIGINAL_SSH_AUTH_SOCK\n        unset ORIGINAL_SSH_AUTH_SOCK\n    fi\nelse\n    echo "Code server script is already running $CODE_SERVER_SCRIPT. Running processes are $CODE_SERVER_RUNNING_PROCESS"\nfi\n\nif [[ -f $CODE_SERVER_TOKENFILE ]]; then\n    CODE_SERVER_CONNECTION_TOKEN="$(cat $CODE_SERVER_TOKENFILE)"\nelse\n    print_install_results_and_exit 1 "Code server token file not found: $CODE_SERVER_TOKENFILE"\nfi\n\necho "Code server log file is $CODE_SERVER_LOGFILE"\nfor i in {1..180}; do\n    if [[ -f $CODE_SERVER_LOGFILE ]]; then\n        CODE_LISTENING_ON="$(cat $CODE_SERVER_LOGFILE | grep -E 'Extension host agent listening on .+' | sed 's/Extension host agent listening on //')"\n        if [[ -n "$CODE_LISTENING_ON" ]]; then\n            break\n        fi\n    fi\n    sleep 0.5\ndone\n\nif [[ -z "$CODE_LISTENING_ON" ]]; then\n    echo "Error code server did not start successfully"\n    # Reading the logfile, to help with debugging\n    ls -al $CODE_SERVER_LOGFILE || true\n    cat $CODE_SERVER_LOGFILE || true\n    print_install_results_and_exit 1 "Code server did not start successfully" "false"\nfi\n\nprint_install_results_and_wait\n`}function D({id:e,line:t,commit:s,scpServerPath:r,serverShutdownTimeout:i,skipRemoteDownload:n,extensionIds:o,envVariables:a,serverInstallPath:l,serverApplicationName:c,forceReinstall:u,killRunningServers:d,serverDataFolderName:f,httpProxy:p,httpsProxy:m,noProxy:g,realCommit:S}){l=(l=l.replace(/^~(?=$|\/|\\)/,"$(Resolve-Path ~)")).replaceAll("/","\\"),r=(r=r.replace(/^~(?=$|\/|\\)/,"$(Resolve-Path ~)")).replaceAll("/","\\"),l.endsWith(`\\${f}`)&&(l=l.slice(0,-1*(f.length+1)));const E=o.map((e=>"--install-extension "+e)).join(" "),w=R({line:t,realCommit:S,commit:s,platform:"win32",arch:"x64"}),v=R({line:t,realCommit:S,commit:s,platform:"win32",arch:"arm64"});return`\n"Configuring Cursor Server on Remote"\n${p?`$env:HTTP_PROXY = "${p}"\n$env:http_proxy = "${p}"\n        `:""}${m?`$env:HTTPS_PROXY = "${m}"\n$env:https_proxy = "${m}"\n        `:""}${g?`$env:NO_PROXY = "${g}"\n$env:no_proxy = "${g}"\n        `:""}\n$TMP_DIR="$env:TEMP\\$([System.IO.Path]::GetRandomFileName())"\n$ProgressPreference = "SilentlyContinue"\n\n$DISTRO_COMMIT="${s}"\n\n$SERVER_APP_NAME="${c}"\n$SERVER_INITIAL_EXTENSIONS="${E}"\n$SERVER_LISTEN_FLAG="--port=0"\n$SERVER_DATA_DIR="${l}\\${f}"\n"Server data directory: $SERVER_DATA_DIR"\n# The server reads this variable to know where to put the extensions/ and data/ folders\n$env:VSCODE_AGENT_FOLDER = "$SERVER_DATA_DIR"\n$env:VSCODE_SERVER_SHUTDOWN_TIMEOUT="${i}"\n$SERVER_DIR="$SERVER_DATA_DIR\\bin\\$DISTRO_COMMIT"\n$SERVER_NODE_EXECUTABLE="$SERVER_DIR\\node.exe"\n$SERVER_SCRIPT="$SERVER_DIR\\bin\\$SERVER_APP_NAME.cmd"\n$SERVER_LOGFILE="$SERVER_DATA_DIR\\.$DISTRO_COMMIT.log"\n$SERVER_PIDFILE="$SERVER_DATA_DIR\\.$DISTRO_COMMIT.pid"\n$SERVER_TOKENFILE="$SERVER_DATA_DIR\\.$DISTRO_COMMIT.token"\n$SERVER_ARCH=\n$SERVER_CONNECTION_TOKEN=\n$SERVER_DOWNLOAD_URL=\n$SERVER_PID=\n$env:PATH="$SERVER_DIR\\bin\\remote-cli;$env:PATH"\n\n$LISTENING_ON=\n$OS_RELEASE_ID=\n$ARCH=\n$PLATFORM="win32"\n\n$SCRIPT_ID="${e}"\n\nfunction printInstallResults($code, $errorMessage, $isFatalError) {\n"\${SCRIPT_ID}: start"\n    "exitCode==$code=="\n    "errorMessage==$errorMessage=="\n    "isFatalError==$isFatalError=="\n    "codeListeningOn==$LISTENING_ON=="\n    "codeConnectionToken==$SERVER_CONNECTION_TOKEN=="\n    "nodeExecutable==$SERVER_NODE_EXECUTABLE=="\n    "detectedPlatform==$PLATFORM=="\n    "arch==$SERVER_ARCH=="\n${a.map((e=>`"${e}==$${e}=="`)).join("\n")}\n    "\${SCRIPT_ID}: end"\n    if ($code -eq 0) {\n    " "\n    "***********************************************************************"\n    "* This terminal is used to establish and maintain the SSH connection. *"\n    "* Closing this terminal will terminate the connection and disconnect  *"\n    "* Cursor from the remote server.                                      *"\n    "***********************************************************************"\n    }\n}\n\nfunction exitClean($code, $errorMessage, $isFatalError) {\n    printInstallResults $code $errorMessage $isFatalError\n    exit $code\n}\nif ($${d} -or $${u}) {\nWrite-Host "Killing all running Cursor servers"\nGet-Process node -ErrorAction SilentlyContinue | Where-Object Path -Like "$SERVER_DIR\\*" | Stop-Process -Force\n}\n\nif ($${u}) {\n    Write-Host "Removing all existing Cursor installations"\n    Remove-Item -Path "$SERVER_DATA_DIR/bin","$SERVER_DATA_DIR/*.log","$SERVER_DATA_DIR/*.token","$SERVER_DATA_DIR/.installation_lock" -Recurse -Force -ErrorAction SilentlyContinue\n}\n\nfunction acquireLock() {\n    $lockFilePath = (Join-Path "$SERVER_DIR" "cursor-remote.lock")\n    try {\n        $null = ni $lockFilePath -it f -ea si\n    } catch {\n        exitClean 1 "Error creating lock file: $($_.ToString())" "false"\n    }\n    for($I = 1; $I -le ${x}; $I++) {\n        try {\n            "Acquiring lock $lockFilePath"\n            $global:lockFile = [System.io.File]::Open($lockFilePath, 'Open', 'Read', 'None')\n            break\n        } catch {\n            "Install in progress - $($_.ToString())"\n            sleep -Milliseconds 1000\n        }\n    }\n\n    if($I -le ${x}) {\n    "Lock acquired"\n    } else {\n        exitClean 1 "Error could not acquire lock after $MAX_LOCK_ATTEMPTS attempts" "false"\n    }\n}\n\n# Check machine architecture\n$downloadUrl=\n$ARCH=$env:PROCESSOR_ARCHITECTURE\nif ($ARCH -eq "AMD64") {\n    $SERVER_ARCH="x64"\n    $downloadUrl='${w}'\n} elseif ($ARCH -eq "ARM64") {\n    $SERVER_ARCH="arm64"\n    $downloadUrl='${v}'\n} else {\n    exitClean 1 "Error architecture not supported: $ARCH" "true"\n}\n\nif(!(Test-Path $SERVER_DIR)) {\n    try {\n        ni -it d $SERVER_DIR -f -ea si\n    } catch {\n        exitClean 1 "Error creating server install directory: $($_.ToString())" "false"\n    }\n\n    if(!(Test-Path $SERVER_DIR)) {\n        exitClean 1 "Error creating server install directory $SERVER_DIR" "false"\n    }\n}\n\ncd $SERVER_DIR\nacquireLock\n\ntry {\n# Check if server script is already installed\n    if(!(Test-Path $SERVER_SCRIPT)) {\n        del cursor-server.tar.gz\n        if(Test-Path "${r}") {\n        "Found existing server archive at ${r}, using it instead of downloading"\n        Move-Item "${r}" "cursor-server.tar.gz"\n        } else {\n            if($${n} -eq $true) {\n                exitClean 1 "Download failed: Failed to copy server from local client" "true"\n            }\n            "Downloading server from $downloadUrl"\n            $REQUEST_ARGUMENTS = @{\n                Uri="$downloadUrl"\n                TimeoutSec=20\n                OutFile="cursor-server.tar.gz"\n                UseBasicParsing=$True\n            }\n            [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n            try {\n                Invoke-RestMethod @REQUEST_ARGUMENTS\n            } catch {\n                exitClean 1 "Download failed: Failed to download server: $($_.ToString())" "false"\n            }\n        }\n\n        if(Test-Path "cursor-server.tar.gz") {\n            tar -xf cursor-server.tar.gz --strip-components 1\n\n            del cursor-server.tar.gz\n        }\n\n        if(!(Test-Path $SERVER_SCRIPT)) {\n        "Error while installing the server binary $SERVER_SCRIPT"\n        exit 1\n        }\n    }\n    else {\n        "Server script already installed in $SERVER_SCRIPT"\n    }\n\n    # Try to find if server is already running\n    if(Get-Process node -ErrorAction SilentlyContinue | Where-Object Path -Like "$SERVER_DIR\\*") {\n        "Server script is already running $SERVER_SCRIPT"\n    }\n    else {\n        "Starting server $SERVER_SCRIPT"\n        if(Test-Path $SERVER_LOGFILE) {\n            del $SERVER_LOGFILE\n        }\n        if(Test-Path $SERVER_PIDFILE) {\n            del $SERVER_PIDFILE\n        }\n        if(Test-Path $SERVER_TOKENFILE) {\n            del $SERVER_TOKENFILE\n        }\n\n        $SERVER_CONNECTION_TOKEN="${h.randomUUID()}"\n        [System.IO.File]::WriteAllLines($SERVER_TOKENFILE, $SERVER_CONNECTION_TOKEN)\n\n        $SCRIPT_ARGUMENTS="--start-server --host=127.0.0.1 $SERVER_LISTEN_FLAG $SERVER_INITIAL_EXTENSIONS --connection-token-file $SERVER_TOKENFILE --telemetry-level off --enable-remote-auto-shutdown --accept-server-license-terms *> '$SERVER_LOGFILE'"\n\n        $START_ARGUMENTS = @{\n            FilePath = "powershell.exe"\n            WindowStyle = "hidden"\n            ArgumentList = @(\n                "-ExecutionPolicy", "Unrestricted", "-NoLogo", "-NoProfile", "-NonInteractive", "-c", "$SERVER_SCRIPT $SCRIPT_ARGUMENTS"\n            )\n            PassThru = $True\n        }\n        $SERVER_ID = (start @START_ARGUMENTS).ID\n        if($SERVER_ID) {\n            [System.IO.File]::WriteAllLines($SERVER_PIDFILE, $SERVER_ID)\n        }\n    }\n\n    if(Test-Path $SERVER_TOKENFILE) {\n        $SERVER_CONNECTION_TOKEN="$(cat $SERVER_TOKENFILE)"\n    }\n    else {\n        "Error server token file not found $SERVER_TOKENFILE"\n        exitClean 1 "Error server token file not found $SERVER_TOKENFILE" "false"\n    }\n    sleep -Milliseconds 500\n    $SELECT_ARGUMENTS = @{\n        Path = $SERVER_LOGFILE\n        Pattern = "Extension host agent listening on (\\d+)"\n    }\n    for($I = 1; $I -le 40; $I++) {\n        "Checking for server port from log file $SERVER_LOGFILE"\n        if(Test-Path $SERVER_LOGFILE) {\n            $GROUPS = (Select-String @SELECT_ARGUMENTS).Matches.Groups\n            if($GROUPS) {\n                $LISTENING_ON = $GROUPS[1].Value\n                "Listening on port: $LISTENING_ON"\n                break\n            }\n        }\n\n        sleep -Milliseconds 500\n    }\n\n} finally {\n    $lockFile.Close()\n}\nif (!$LISTENING_ON) {\n    exitClean 1 "Error server did not start successfully. Could not extract server port from log file $SERVER_LOGFILE" "false"\n}\nif(!(Test-Path $SERVER_LOGFILE)) {\n    exitClean 1 "Error server log file not found $SERVER_LOGFILE" "false"\n}\n\nif(Test-Path $SERVER_PIDFILE) {\n    $SERVER_PID="$(cat $SERVER_PIDFILE)"\n}\nif(!$SERVER_PID) {\n    exitClean 1 "Error server pid file not found $SERVER_PIDFILE" "false"\n}\n\n# Finish server setup\nprintInstallResults 0 "" "false"\n\nwhile($True) {\n    if(!(gps -Id $SERVER_PID)) {\n        "server died, exit"\n        exit 0\n    }\n    sleep 30\n}\n`}},9456:(e,t,s)=>{"use strict";const r=s(3908),i=s(3904),{ANY:n}=i,o=s(8311),a=s(7638),h=s(5580),l=s(7059),c=s(5200),u=s(4089);e.exports=(e,t,s,d)=>{let f,p,m,g,S;switch(e=new r(e,d),t=new o(t,d),s){case">":f=h,p=c,m=l,g=">",S=">=";break;case"<":f=l,p=u,m=h,g="<",S="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,d))return!1;for(let s=0;s<t.set.length;++s){const r=t.set[s];let o=null,a=null;if(r.forEach((e=>{e.semver===n&&(e=new i(">=0.0.0")),o=o||e,a=a||e,f(e.semver,o.semver,d)?o=e:m(e.semver,a.semver,d)&&(a=e)})),o.operator===g||o.operator===S)return!1;if((!a.operator||a.operator===g)&&p(e,a.semver))return!1;if(a.operator===S&&m(e,a.semver))return!1}return!0}},9534:function(e,t){(function(){var t;function s(e,t,s){null!=e&&("number"==typeof e?this.fromNumber(e,t,s):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function r(){return new s(null)}var i="undefined"!=typeof navigator;i&&"Microsoft Internet Explorer"==navigator.appName?(s.prototype.am=function(e,t,s,r,i,n){for(var o=32767&t,a=t>>15;--n>=0;){var h=32767&this[e],l=this[e++]>>15,c=a*h+l*o;i=((h=o*h+((32767&c)<<15)+s[r]+(1073741823&i))>>>30)+(c>>>15)+a*l+(i>>>30),s[r++]=1073741823&h}return i},t=30):i&&"Netscape"!=navigator.appName?(s.prototype.am=function(e,t,s,r,i,n){for(;--n>=0;){var o=t*this[e++]+s[r]+i;i=Math.floor(o/67108864),s[r++]=67108863&o}return i},t=26):(s.prototype.am=function(e,t,s,r,i,n){for(var o=16383&t,a=t>>14;--n>=0;){var h=16383&this[e],l=this[e++]>>14,c=a*h+l*o;i=((h=o*h+((16383&c)<<14)+s[r]+i)>>28)+(c>>14)+a*l,s[r++]=268435455&h}return i},t=28),s.prototype.DB=t,s.prototype.DM=(1<<t)-1,s.prototype.DV=1<<t,s.prototype.FV=Math.pow(2,52),s.prototype.F1=52-t,s.prototype.F2=2*t-52;var n,o,a=new Array;for(n="0".charCodeAt(0),o=0;o<=9;++o)a[n++]=o;for(n="a".charCodeAt(0),o=10;o<36;++o)a[n++]=o;for(n="A".charCodeAt(0),o=10;o<36;++o)a[n++]=o;function h(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function l(e,t){var s=a[e.charCodeAt(t)];return null==s?-1:s}function c(e){var t=r();return t.fromInt(e),t}function u(e){var t,s=1;return 0!=(t=e>>>16)&&(e=t,s+=16),0!=(t=e>>8)&&(e=t,s+=8),0!=(t=e>>4)&&(e=t,s+=4),0!=(t=e>>2)&&(e=t,s+=2),0!=(t=e>>1)&&(e=t,s+=1),s}function d(e){this.m=e}function f(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function p(e,t){return e&t}function m(e,t){return e|t}function g(e,t){return e^t}function S(e,t){return e&~t}function E(e){if(0==e)return-1;var t=0;return 65535&e||(e>>=16,t+=16),255&e||(e>>=8,t+=8),15&e||(e>>=4,t+=4),3&e||(e>>=2,t+=2),1&e||++t,t}function w(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function v(){}function _(e){return e}function y(e){this.r2=r(),this.q3=r(),s.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}d.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},d.prototype.revert=function(e){return e},d.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},d.prototype.mulTo=function(e,t,s){e.multiplyTo(t,s),this.reduce(s)},d.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},f.prototype.convert=function(e){var t=r();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(s.ZERO)>0&&this.m.subTo(t,t),t},f.prototype.revert=function(e){var t=r();return e.copyTo(t),this.reduce(t),t},f.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var s=32767&e[t],r=s*this.mpl+((s*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[s=t+this.m.t]+=this.m.am(0,r,e,t,0,this.m.t);e[s]>=e.DV;)e[s]-=e.DV,e[++s]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},f.prototype.mulTo=function(e,t,s){e.multiplyTo(t,s),this.reduce(s)},f.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},s.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},s.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},s.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var i=e.length,n=!1,o=0;--i>=0;){var a=8==r?255&e[i]:l(e,i);a<0?"-"==e.charAt(i)&&(n=!0):(n=!1,0==o?this[this.t++]=a:o+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&128&e[0]&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),n&&s.ZERO.subTo(this,this)},s.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},s.prototype.dlShiftTo=function(e,t){var s;for(s=this.t-1;s>=0;--s)t[s+e]=this[s];for(s=e-1;s>=0;--s)t[s]=0;t.t=this.t+e,t.s=this.s},s.prototype.drShiftTo=function(e,t){for(var s=e;s<this.t;++s)t[s-e]=this[s];t.t=Math.max(this.t-e,0),t.s=this.s},s.prototype.lShiftTo=function(e,t){var s,r=e%this.DB,i=this.DB-r,n=(1<<i)-1,o=Math.floor(e/this.DB),a=this.s<<r&this.DM;for(s=this.t-1;s>=0;--s)t[s+o+1]=this[s]>>i|a,a=(this[s]&n)<<r;for(s=o-1;s>=0;--s)t[s]=0;t[o]=a,t.t=this.t+o+1,t.s=this.s,t.clamp()},s.prototype.rShiftTo=function(e,t){t.s=this.s;var s=Math.floor(e/this.DB);if(s>=this.t)t.t=0;else{var r=e%this.DB,i=this.DB-r,n=(1<<r)-1;t[0]=this[s]>>r;for(var o=s+1;o<this.t;++o)t[o-s-1]|=(this[o]&n)<<i,t[o-s]=this[o]>>r;r>0&&(t[this.t-s-1]|=(this.s&n)<<i),t.t=this.t-s,t.clamp()}},s.prototype.subTo=function(e,t){for(var s=0,r=0,i=Math.min(e.t,this.t);s<i;)r+=this[s]-e[s],t[s++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;s<this.t;)r+=this[s],t[s++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;s<e.t;)r-=e[s],t[s++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[s++]=this.DV+r:r>0&&(t[s++]=r),t.t=s,t.clamp()},s.prototype.multiplyTo=function(e,t){var r=this.abs(),i=e.abs(),n=r.t;for(t.t=n+i.t;--n>=0;)t[n]=0;for(n=0;n<i.t;++n)t[n+r.t]=r.am(0,i[n],t,n,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&s.ZERO.subTo(t,t)},s.prototype.squareTo=function(e){for(var t=this.abs(),s=e.t=2*t.t;--s>=0;)e[s]=0;for(s=0;s<t.t-1;++s){var r=t.am(s,t[s],e,2*s,0,1);(e[s+t.t]+=t.am(s+1,2*t[s],e,2*s+1,r,t.t-s-1))>=t.DV&&(e[s+t.t]-=t.DV,e[s+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(s,t[s],e,2*s,0,1)),e.s=0,e.clamp()},s.prototype.divRemTo=function(e,t,i){var n=e.abs();if(!(n.t<=0)){var o=this.abs();if(o.t<n.t)return null!=t&&t.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=r());var a=r(),h=this.s,l=e.s,c=this.DB-u(n[n.t-1]);c>0?(n.lShiftTo(c,a),o.lShiftTo(c,i)):(n.copyTo(a),o.copyTo(i));var d=a.t,f=a[d-1];if(0!=f){var p=f*(1<<this.F1)+(d>1?a[d-2]>>this.F2:0),m=this.FV/p,g=(1<<this.F1)/p,S=1<<this.F2,E=i.t,w=E-d,v=null==t?r():t;for(a.dlShiftTo(w,v),i.compareTo(v)>=0&&(i[i.t++]=1,i.subTo(v,i)),s.ONE.dlShiftTo(d,v),v.subTo(a,a);a.t<d;)a[a.t++]=0;for(;--w>=0;){var _=i[--E]==f?this.DM:Math.floor(i[E]*m+(i[E-1]+S)*g);if((i[E]+=a.am(0,_,i,w,0,d))<_)for(a.dlShiftTo(w,v),i.subTo(v,i);i[E]<--_;)i.subTo(v,i)}null!=t&&(i.drShiftTo(d,t),h!=l&&s.ZERO.subTo(t,t)),i.t=d,i.clamp(),c>0&&i.rShiftTo(c,i),h<0&&s.ZERO.subTo(i,i)}}},s.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(!(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},s.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},s.prototype.exp=function(e,t){if(e>4294967295||e<1)return s.ONE;var i=r(),n=r(),o=t.convert(this),a=u(e)-1;for(o.copyTo(i);--a>=0;)if(t.sqrTo(i,n),(e&1<<a)>0)t.mulTo(n,o,i);else{var h=i;i=n,n=h}return t.revert(i)},s.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var s,r=(1<<t)-1,i=!1,n="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(s=this[o]>>a)>0&&(i=!0,n=h(s));o>=0;)a<t?(s=(this[o]&(1<<a)-1)<<t-a,s|=this[--o]>>(a+=this.DB-t)):(s=this[o]>>(a-=t)&r,a<=0&&(a+=this.DB,--o)),s>0&&(i=!0),i&&(n+=h(s));return i?n:"0"},s.prototype.negate=function(){var e=r();return s.ZERO.subTo(this,e),e},s.prototype.abs=function(){return this.s<0?this.negate():this},s.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var s=this.t;if(0!=(t=s-e.t))return this.s<0?-t:t;for(;--s>=0;)if(0!=(t=this[s]-e[s]))return t;return 0},s.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+u(this[this.t-1]^this.s&this.DM)},s.prototype.mod=function(e){var t=r();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(s.ZERO)>0&&e.subTo(t,t),t},s.prototype.modPowInt=function(e,t){var s;return s=e<256||t.isEven()?new d(t):new f(t),this.exp(e,s)},s.ZERO=c(0),s.ONE=c(1),v.prototype.convert=_,v.prototype.revert=_,v.prototype.mulTo=function(e,t,s){e.multiplyTo(t,s)},v.prototype.sqrTo=function(e,t){e.squareTo(t)},y.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=r();return e.copyTo(t),this.reduce(t),t},y.prototype.revert=function(e){return e},y.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},y.prototype.mulTo=function(e,t,s){e.multiplyTo(t,s),this.reduce(s)},y.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var R,b,O,I=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],$=(1<<26)/I[I.length-1];function T(){var e;e=(new Date).getTime(),b[O++]^=255&e,b[O++]^=e>>8&255,b[O++]^=e>>16&255,b[O++]^=e>>24&255,O>=N&&(O-=N)}if(s.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},s.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),s=Math.pow(e,t),i=c(s),n=r(),o=r(),a="";for(this.divRemTo(i,n,o);n.signum()>0;)a=(s+o.intValue()).toString(e).substr(1)+a,n.divRemTo(i,n,o);return o.intValue().toString(e)+a},s.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),i=Math.pow(t,r),n=!1,o=0,a=0,h=0;h<e.length;++h){var c=l(e,h);c<0?"-"==e.charAt(h)&&0==this.signum()&&(n=!0):(a=t*a+c,++o>=r&&(this.dMultiply(i),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(a,0)),n&&s.ZERO.subTo(this,this)},s.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(s.ONE.shiftLeft(e-1),m,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(s.ONE.shiftLeft(e-1),this);else{var i=new Array,n=7&e;i.length=1+(e>>3),t.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}},s.prototype.bitwiseTo=function(e,t,s){var r,i,n=Math.min(e.t,this.t);for(r=0;r<n;++r)s[r]=t(this[r],e[r]);if(e.t<this.t){for(i=e.s&this.DM,r=n;r<this.t;++r)s[r]=t(this[r],i);s.t=this.t}else{for(i=this.s&this.DM,r=n;r<e.t;++r)s[r]=t(i,e[r]);s.t=e.t}s.s=t(this.s,e.s),s.clamp()},s.prototype.changeBit=function(e,t){var r=s.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},s.prototype.addTo=function(e,t){for(var s=0,r=0,i=Math.min(e.t,this.t);s<i;)r+=this[s]+e[s],t[s++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;s<this.t;)r+=this[s],t[s++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;s<e.t;)r+=e[s],t[s++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t[s++]=r:r<-1&&(t[s++]=this.DV+r),t.t=s,t.clamp()},s.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},s.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},s.prototype.multiplyLowerTo=function(e,t,s){var r,i=Math.min(this.t+e.t,t);for(s.s=0,s.t=i;i>0;)s[--i]=0;for(r=s.t-this.t;i<r;++i)s[i+this.t]=this.am(0,e[i],s,i,0,this.t);for(r=Math.min(e.t,t);i<r;++i)this.am(0,e[i],s,i,0,t-i);s.clamp()},s.prototype.multiplyUpperTo=function(e,t,s){--t;var r=s.t=this.t+e.t-t;for(s.s=0;--r>=0;)s[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)s[this.t+r-t]=this.am(t-r,e[r],s,0,0,this.t+r-t);s.clamp(),s.drShiftTo(1,s)},s.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,s=this.s<0?e-1:0;if(this.t>0)if(0==t)s=this[0]%e;else for(var r=this.t-1;r>=0;--r)s=(t*s+this[r])%e;return s},s.prototype.millerRabin=function(e){var t=this.subtract(s.ONE),i=t.getLowestSetBit();if(i<=0)return!1;var n=t.shiftRight(i);(e=e+1>>1)>I.length&&(e=I.length);for(var o=r(),a=0;a<e;++a){o.fromInt(I[Math.floor(Math.random()*I.length)]);var h=o.modPow(n,this);if(0!=h.compareTo(s.ONE)&&0!=h.compareTo(t)){for(var l=1;l++<i&&0!=h.compareTo(t);)if(0==(h=h.modPowInt(2,this)).compareTo(s.ONE))return!1;if(0!=h.compareTo(t))return!1}}return!0},s.prototype.clone=function(){var e=r();return this.copyTo(e),e},s.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},s.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},s.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},s.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},s.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var s,r=this.DB-e*this.DB%8,i=0;if(e-- >0)for(r<this.DB&&(s=this[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=s|this.s<<this.DB-r);e>=0;)r<8?(s=(this[e]&(1<<r)-1)<<8-r,s|=this[--e]>>(r+=this.DB-8)):(s=this[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),128&s&&(s|=-256),0==i&&(128&this.s)!=(128&s)&&++i,(i>0||s!=this.s)&&(t[i++]=s);return t},s.prototype.equals=function(e){return 0==this.compareTo(e)},s.prototype.min=function(e){return this.compareTo(e)<0?this:e},s.prototype.max=function(e){return this.compareTo(e)>0?this:e},s.prototype.and=function(e){var t=r();return this.bitwiseTo(e,p,t),t},s.prototype.or=function(e){var t=r();return this.bitwiseTo(e,m,t),t},s.prototype.xor=function(e){var t=r();return this.bitwiseTo(e,g,t),t},s.prototype.andNot=function(e){var t=r();return this.bitwiseTo(e,S,t),t},s.prototype.not=function(){for(var e=r(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},s.prototype.shiftLeft=function(e){var t=r();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},s.prototype.shiftRight=function(e){var t=r();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},s.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+E(this[e]);return this.s<0?this.t*this.DB:-1},s.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,s=0;s<this.t;++s)e+=w(this[s]^t);return e},s.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:!!(this[t]&1<<e%this.DB)},s.prototype.setBit=function(e){return this.changeBit(e,m)},s.prototype.clearBit=function(e){return this.changeBit(e,S)},s.prototype.flipBit=function(e){return this.changeBit(e,g)},s.prototype.add=function(e){var t=r();return this.addTo(e,t),t},s.prototype.subtract=function(e){var t=r();return this.subTo(e,t),t},s.prototype.multiply=function(e){var t=r();return this.multiplyTo(e,t),t},s.prototype.divide=function(e){var t=r();return this.divRemTo(e,t,null),t},s.prototype.remainder=function(e){var t=r();return this.divRemTo(e,null,t),t},s.prototype.divideAndRemainder=function(e){var t=r(),s=r();return this.divRemTo(e,t,s),new Array(t,s)},s.prototype.modPow=function(e,t){var s,i,n=e.bitLength(),o=c(1);if(n<=0)return o;s=n<18?1:n<48?3:n<144?4:n<768?5:6,i=n<8?new d(t):t.isEven()?new y(t):new f(t);var a=new Array,h=3,l=s-1,p=(1<<s)-1;if(a[1]=i.convert(this),s>1){var m=r();for(i.sqrTo(a[1],m);h<=p;)a[h]=r(),i.mulTo(m,a[h-2],a[h]),h+=2}var g,S,E=e.t-1,w=!0,v=r();for(n=u(e[E])-1;E>=0;){for(n>=l?g=e[E]>>n-l&p:(g=(e[E]&(1<<n+1)-1)<<l-n,E>0&&(g|=e[E-1]>>this.DB+n-l)),h=s;!(1&g);)g>>=1,--h;if((n-=h)<0&&(n+=this.DB,--E),w)a[g].copyTo(o),w=!1;else{for(;h>1;)i.sqrTo(o,v),i.sqrTo(v,o),h-=2;h>0?i.sqrTo(o,v):(S=o,o=v,v=S),i.mulTo(v,a[g],o)}for(;E>=0&&!(e[E]&1<<n);)i.sqrTo(o,v),S=o,o=v,v=S,--n<0&&(n=this.DB-1,--E)}return i.revert(o)},s.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return s.ZERO;for(var r=e.clone(),i=this.clone(),n=c(1),o=c(0),a=c(0),h=c(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(n.isEven()&&o.isEven()||(n.addTo(this,n),o.subTo(e,o)),n.rShiftTo(1,n)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;i.isEven();)i.rShiftTo(1,i),t?(a.isEven()&&h.isEven()||(a.addTo(this,a),h.subTo(e,h)),a.rShiftTo(1,a)):h.isEven()||h.subTo(e,h),h.rShiftTo(1,h);r.compareTo(i)>=0?(r.subTo(i,r),t&&n.subTo(a,n),o.subTo(h,o)):(i.subTo(r,i),t&&a.subTo(n,a),h.subTo(o,h))}return 0!=i.compareTo(s.ONE)?s.ZERO:h.compareTo(e)>=0?h.subtract(e):h.signum()<0?(h.addTo(e,h),h.signum()<0?h.add(e):h):h},s.prototype.pow=function(e){return this.exp(e,new v)},s.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),s=e.s<0?e.negate():e.clone();if(t.compareTo(s)<0){var r=t;t=s,s=r}var i=t.getLowestSetBit(),n=s.getLowestSetBit();if(n<0)return t;for(i<n&&(n=i),n>0&&(t.rShiftTo(n,t),s.rShiftTo(n,s));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=s.getLowestSetBit())>0&&s.rShiftTo(i,s),t.compareTo(s)>=0?(t.subTo(s,t),t.rShiftTo(1,t)):(s.subTo(t,s),s.rShiftTo(1,s));return n>0&&s.lShiftTo(n,s),s},s.prototype.isProbablePrime=function(e){var t,s=this.abs();if(1==s.t&&s[0]<=I[I.length-1]){for(t=0;t<I.length;++t)if(s[0]==I[t])return!0;return!1}if(s.isEven())return!1;for(t=1;t<I.length;){for(var r=I[t],i=t+1;i<I.length&&r<$;)r*=I[i++];for(r=s.modInt(r);t<i;)if(r%I[t++]==0)return!1}return s.millerRabin(e)},s.prototype.square=function(){var e=r();return this.squareTo(e),e},s.prototype.Barrett=y,null==b){var C;if(b=new Array,O=0,"undefined"!=typeof window&&window.crypto)if(window.crypto.getRandomValues){var k=new Uint8Array(32);for(window.crypto.getRandomValues(k),C=0;C<32;++C)b[O++]=k[C]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var P=window.crypto.random(32);for(C=0;C<P.length;++C)b[O++]=255&P.charCodeAt(C)}for(;O<N;)C=Math.floor(65536*Math.random()),b[O++]=C>>>8,b[O++]=255&C;O=0,T()}function A(){if(null==R){for(T(),(R=new x).init(b),O=0;O<b.length;++O)b[O]=0;O=0}return R.next()}function L(){}function x(){this.i=0,this.j=0,this.S=new Array}L.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=A()},x.prototype.init=function(e){var t,s,r;for(t=0;t<256;++t)this.S[t]=t;for(s=0,t=0;t<256;++t)s=s+this.S[t]+e[t%e.length]&255,r=this.S[t],this.S[t]=this.S[s],this.S[s]=r;this.i=0,this.j=0},x.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]};var N=256;e.exports={default:s,BigInteger:s,SecureRandom:L}}).call(this)},9576:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RE_SUBNET_STRING=t.RE_ADDRESS=t.GROUPS=t.BITS=void 0,t.BITS=32,t.GROUPS=4,t.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g,t.RE_SUBNET_STRING=/\/\d{1,2}$/},9589:(e,t,s)=>{"use strict";const r=s(9718),i=s(6874),n=s(3908),o=s(1123),a=s(144),h=s(6953),l=s(7414),c=s(3007),u=s(1832),d=s(2938),f=s(6254),p=s(4493),m=s(1729),g=s(560),S=s(9970),E=s(1763),w=s(909),v=s(3927),_=s(4277),y=s(5580),R=s(7059),b=s(4641),O=s(3999),I=s(4089),$=s(5200),T=s(2111),C=s(6170),k=s(3904),P=s(8311),A=s(7638),L=s(12),x=s(9628),N=s(270),D=s(1261),M=s(3874),B=s(9456),F=s(5571),U=s(5342),j=s(6780),V=s(2525),H=s(5032);e.exports={parse:a,valid:h,clean:l,inc:c,diff:u,major:d,minor:f,patch:p,prerelease:m,compare:g,rcompare:S,compareLoose:E,compareBuild:w,sort:v,rsort:_,gt:y,lt:R,eq:b,neq:O,gte:I,lte:$,cmp:T,coerce:C,Comparator:k,Range:P,satisfies:A,toComparators:L,maxSatisfying:x,minSatisfying:N,minVersion:D,validRange:M,outside:B,gtr:F,ltr:U,intersects:j,simplifyRange:V,subset:H,SemVer:n,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers}},9628:(e,t,s)=>{"use strict";const r=s(3908),i=s(8311);e.exports=(e,t,s)=>{let n=null,o=null,a=null;try{a=new i(t,s)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(n&&-1!==o.compare(e)||(n=e,o=new r(n,s)))})),n}},9718:(e,t,s)=>{"use strict";const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:n}=s(6874),o=s(7272),a=(t=e.exports={}).re=[],h=t.safeRe=[],l=t.src=[],c=t.safeSrc=[],u=t.t={};let d=0;const f="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",n],[f,i]],m=(e,t,s)=>{const r=(e=>{for(const[t,s]of p)e=e.split(`${t}*`).join(`${t}{0,${s}}`).split(`${t}+`).join(`${t}{1,${s}}`);return e})(t),i=d++;o(e,i,t),u[e]=i,l[i]=t,c[i]=r,a[i]=new RegExp(t,s?"g":void 0),h[i]=new RegExp(r,s?"g":void 0)};m("NUMERICIDENTIFIER","0|[1-9]\\d*"),m("NUMERICIDENTIFIERLOOSE","\\d+"),m("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),m("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),m("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASEIDENTIFIER",`(?:${l[u.NONNUMERICIDENTIFIER]}|${l[u.NUMERICIDENTIFIER]})`),m("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NONNUMERICIDENTIFIER]}|${l[u.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),m("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),m("BUILDIDENTIFIER",`${f}+`),m("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),m("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),m("FULL",`^${l[u.FULLPLAIN]}$`),m("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),m("LOOSE",`^${l[u.LOOSEPLAIN]}$`),m("GTLT","((?:<|>)?=?)"),m("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),m("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),m("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),m("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),m("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),m("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),m("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),m("COERCE",`${l[u.COERCEPLAIN]}(?:$|[^\\d])`),m("COERCEFULL",l[u.COERCEPLAIN]+`(?:${l[u.PRERELEASE]})?`+`(?:${l[u.BUILD]})?(?:$|[^\\d])`),m("COERCERTL",l[u.COERCE],!0),m("COERCERTLFULL",l[u.COERCEFULL],!0),m("LONETILDE","(?:~>?)"),m("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",m("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),m("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),m("LONECARET","(?:\\^)"),m("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",m("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),m("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),m("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),m("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),m("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",m("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),m("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),m("STAR","(<|>)?=?\\s*\\*"),m("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),m("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},9896:e=>{"use strict";e.exports=require("fs")},9912:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.stringify=t.parse=t.LineType=void 0;const i=r(s(8601)),n=s(5317),o=r(s(857)),a=/\s/,h=/\r|\n/,l=/^(Host|Match)$/i,c=/^(GlobalKnownHostsFile|Host|IPQoS|SendEnv|UserKnownHostsFile|ProxyCommand|Match|CanonicalDomains)$/i,u=/^(?:CertificateFile|IdentityFile|IdentityAgent|User)$/i,d=/^(Include|IdentityFile)$/i;var f;!function(e){e[e.DIRECTIVE=1]="DIRECTIVE",e[e.COMMENT=2]="COMMENT"}(f||(t.LineType=f={}));const p=["IdentityFile","LocalForward","RemoteForward","DynamicForward","CertificateFile"];function m(e,t){return t.hasOwnProperty(e.param)&&t[e.param]===e.value}function g(e){for(const t of e)if(t.type===f.DIRECTIVE&&"config"in t)for(const e of t.config)if(e.before)return e.before;return"  "}function S(e,t){const s=(e,s)=>{switch(e.toLowerCase()){case"all":return!0;case"final":return!!t.inFinalPass||(t.doFinalPass=!0,!1);case"exec":const e=`function main {\n          ${s}\n        }\n        main`;return 0===(0,n.spawnSync)(e,{shell:!0}).status;case"host":return(0,i.default)(s,t.params.HostName);case"originalhost":return(0,i.default)(s,t.params.OriginalHost);case"user":return(0,i.default)(s,t.params.User);case"localuser":return(0,i.default)(s,t.params.LocalUser)}};for(const t in e)if(!s(t,e[t]))return!1;return!0}class E extends Array{static parse(e){return w(e)}static stringify(e){return v(e)}compute(e){let t;"string"==typeof e&&(e={Host:e});try{t=o.default.userInfo()}catch(e){t={username:process.env.USER||process.env.USERNAME||""}}const s={params:{Host:e.Host,HostName:e.Host,OriginalHost:e.Host,User:t.username,LocalUser:t.username},inFinalPass:!1,doFinalPass:!1},r={},a=(e,t)=>{p.includes(e)?(r[e]||(r[e]=[])).push(t):null==r[e]&&("HostName"===e?s.params.HostName=t:"User"===e&&(s.params.User=t),r[e]=t)};void 0!==e.User&&a("User",e.User);const h=()=>{for(const e of this)if(e.type===f.DIRECTIVE)if("Host"===e.param&&(0,i.default)(e.value,s.params.Host)){let t=!1,r=[];a(e.param,e.value);for(const s of e.config)s.type===f.DIRECTIVE&&(a(s.param,s.value),/^CanonicalizeHostName$/i.test(s.param)&&"yes"===s.value&&(t=!0),/^CanonicalDomains$/i.test(s.param)&&Array.isArray(s.value)&&(r=s.value));if(r.length>0&&t&&s.params.Host===s.params.OriginalHost)for(const e of r){const t=`${s.params.OriginalHost}.${e}`,{status:r,stderr:i}=(0,n.spawnSync)("nslookup",[t]);if(0===r&&!/can't find/.test(i.toString())){s.params.Host=t,a("Host",t),h();break}}}else if("Match"===e.param&&"criteria"in e&&S(e.criteria,s))for(const t of e.config)t.type===f.DIRECTIVE&&a(t.param,t.value);else"Host"!==e.param&&"Match"!==e.param&&a(e.param,e.value)};return h(),s.doFinalPass&&(s.inFinalPass=!0,s.params.Host=s.params.HostName,h()),r}find(e){if("function"==typeof e)return super.find(e);if(!e||!("Host"in e)&&!("Match"in e))throw new Error("Can only find by Host or Match");return super.find((t=>m(t,e)))}remove(e){let t;if("function"==typeof e)t=super.findIndex(e);else{if(!e||!("Host"in e)&&!("Match"in e))throw new Error("Can only remove by Host or Match");t=super.findIndex((t=>m(t,e)))}if(t>=0)return this.splice(t,1)}toString(){return v(this)}append(e){const t=g(this),s=this.length>0?this[this.length-1]:null;let r=s&&s.config||this,i=this,n=r.length>0?r[r.length-1]:s;n&&!n.after&&(n.after="\n");let o=r!==i;for(const s in e){const a=e[s],h={type:f.DIRECTIVE,param:s,separator:" ",value:a,before:o?t:t.replace(/  |\t/,""),after:"\n"};l.test(s)?(o=!0,h.before=t.replace(/  |\t/,""),r=i,n&&"\n"===n.after&&(n.after+="\n"),r.push(h),r=h.config=new E):r.push(h),n=h}return i}prepend(e,t=!1){const s=g(this);let r=this,i=0;if(t){for(;i<this.length&&!("config"in this[i]);)i+=1;if(i>=this.length)return this.append(e)}let n=!1,o=0;for(const t in e){o+=1;const a=e[t],h={type:f.DIRECTIVE,param:t,separator:" ",value:a,before:"",after:"\n"};l.test(t)?(h.before=s.replace(/  |\t/,""),r.splice(i,0,h),r=h.config=new E,n=!0):(o===Object.keys(e).length&&(h.after+="\n"),n?(h.before=s,r.push(h)):(r.splice(i,0,h),i+=1,d.test(t)&&(h.after+="\n")))}return r}}function w(e){let t=0,s=n(),r=new E,i=r;function n(){return e[t++]}function o(){let e="";for(;a.test(s);)e+=s,s=n();return e}function u(){let e=o();return"="===s&&(e+=s,s=n()),e+o()}function d(){let e="",t=!1,r=!1;for(;s&&!h.test(s);){if(r)e+='"'===s?s:`\\${s}`,r=!1;else if('"'!==s||e&&!t)if("\\"===s)r=!0;else{if("#"===s&&!t)break;e+=s}else t=!t;s=n()}if(t||r)throw new Error(`Unexpected line break at ${e}`);return e.trim()}function p(){const e=[];let t="",r=!1,i=!1;for(;s&&!h.test(s);){if(i)t+='"'===s?s:`\\${s}`,i=!1;else if('"'===s)r=!r;else if("\\"===s)i=!0;else if(r)t+=s;else if(/[ \t=]/.test(s))t&&(e.push(t),t="");else{if("#"===s&&e.length>0)break;t+=s}s=n()}if(r||i)throw new Error(`Unexpected line break at ${e.concat(t).join(" ")}`);return t&&e.push(t),e.length>1?e:e[0]}function m(){const e=o(),t="#"===s?function(){const e=f.COMMENT;let t="";for(;s&&!h.test(s);)t+=s,s=n();return{type:e,content:t,before:"",after:""}}():function(){const e=f.DIRECTIVE,t=function(){let e="";for(;s&&/[^ \t=]/.test(s);)e+=s,s=n();return e}(),r=c.test(t),i={type:e,param:t,separator:u(),quoted:!r&&'"'===s,value:r?p():d(),before:"",after:""};if(i.quoted||delete i.quoted,/^Match$/i.test(t)){const e={};"string"==typeof i.value&&(i.value=[i.value]);let t=0;for(;t<i.value.length;){const s=i.value[t];switch(s.toLowerCase()){case"all":case"canonical":case"final":e[s]=[],t+=1;break;default:if(t+1>=i.value.length)throw new Error(`Missing value for match criteria ${s}`);e[s]=i.value[t+1],t+=2}}i.criteria=e}return i}(),r=function(){let e="";for(;h.test(s);)e+=s,s=n();return e}();return t.before=e,t.after=r,t}for(;s;){let e=m();e.type===f.DIRECTIVE&&l.test(e.param)?(r=i,r.push(e),r=e.config=new E):e.type!==f.DIRECTIVE||e.param?r.push(e):0===r.length?i[i.length-1].after+=e.before:r[r.length-1].after+=e.before}return i}function v(e){let t="";function s(e,t){return Array.isArray(e)?e.map((e=>s(e,a.test(e)))).join(" "):t?`"${e}"`:e}function r(e){const t=e.quoted||u.test(e.param)&&a.test(e.value),r=s(e.value,t);return`${e.param}${e.separator}${r}`}const i=e=>{t+=e.before,e.type===f.COMMENT?t+=e.content:e.type===f.DIRECTIVE&&p.includes(e.param)?[].concat(e.value).forEach((function(s,i,n){t+=r({...e,value:s}),i<n.length-1&&(t+=`\n${e.before}`)})):e.type===f.DIRECTIVE&&(t+=r(e)),t+=e.after,e.config&&e.config.forEach(i)};return e.forEach(i),t}E.DIRECTIVE=f.DIRECTIVE,E.COMMENT=f.COMMENT,t.default=E,t.parse=w,t.stringify=v},9970:(e,t,s)=>{"use strict";const r=s(560);e.exports=(e,t,s)=>r(t,e,s)}},t={},s=function s(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r].call(n.exports,n,n.exports,s),n.exports}(4600);module.exports=s})();